all_type_pages = {'水泥': ['VMC', 'MLM', 'CRH', 'EXP', 'MDU', 'SUM', 'SSD', 'KNF', 'CX', 'GVA', 'USLM', 'LOMA', 'JHX', 'SMID', 'FSTR', 'CPAC'], '食品飲料': ['KO', 'PEP', 'SBUX', 'STZ', 'MDLZ', 'ABT', 'GIS', 'CL', 'HSY', 'MNST', 'KHC', 'TAP', 'ADM', 'KDP', 'MKC', 'IFF', 'K', 'CPB', 'DD', 'CLX', 'BG', 'CAG', 'LW', 'TSN', 'VINE', 'SJM', 'CELH', 'CE', 'UL', 'BUD', 'HRL', 'DAR', 'DEO', 'CCEP', 'BF.B', 'FMX', 'BYND', 'FRPT', 'ASH', 'SPB', 'SAM', 'FLO', 'POST', 'INGR', 'COKE', 'MED', 'ABEV', 'GPRE', 'BRBR', 'SMPL', 'COCO', 'TWNK', 'LANC', 'SXT', 'THS', 'FIZZ', 'ANDE', 'NAPA', 'MGPI', 'UTZ', 'PRMW', 'PPC', 'HAIN', 'KOF', 'BGS', 'SOVO', 'IMKTA', 'TR', 'SENEA', 'BCPC', 'STKL', 'OTLY', 'BRFS', 'JJSF', 'CENTA', 'CMP', 'TIO', 'TTCF', 'JBSS', 'NOMD', 'AGRO', 'FDP', 'CSAN', 'CVGW', 'SEB', 'BF.A', 'WEST', 'VINO', 'FREE', 'CCU', 'CENT', 'MMMB', 'ALCO', 'FARM', 'EAST', 'BOF', 'ZVIA', 'VWE', 'STKH', 'AFRI', 'AKO.B', 'NATR', 'PRPH', 'SBEV', 'AKO.A', 'WTER', 'NHTC', 'BSFC', 'RGF', 'LFVN', 'FAMI', 'THRN', 'MKC.V', 'SMFL', 'RIBT', 'TAP.A', 'FTFT', 'YGF', 'LWAY', 'BRID', 'PETZ', 'SNAX', 'JVA', 'LSF', 'LVRO', 'BRFH', 'NUZE', 'MTEX', 'RMCF', 'SENEB', 'MGLD', 'BTTR', 'BON', 'PLAG', 'WVVI'], '石化': ['XOM', 'CVX', 'COP', 'SHEL', 'BP', 'MMM', 'LYB', 'VMC', 'MLM', 'DD', 'CRH', 'CE', 'EMN', 'CVE', 'AMCR', 'TTE', 'WMS', 'DINO', 'BERY', 'SEE', 'ASH', 'WLK', 'SON', 'PCT', 'SUM', 'SLGN', 'KNF', 'CX', 'ROG', 'MLI', 'ATR', 'UFPT', 'OTTR', 'GFF', 'BAK', 'ROAD', 'GEF', 'SCL', 'MATV', 'REYN', 'ORGN', 'GVA', 'SSL', 'TSE', 'TG', 'TUP', 'MYE', 'GEF.B', 'GENC', 'KRT', 'YTEN', 'CTIB', 'DSWL'], '紡織': ['PG', 'HON', 'TJX', 'BP', 'KMB', 'ROST', 'RL', 'BURL', 'DD', 'JWN', 'CE', 'EMN', 'PVH', 'GPS', 'AEO', 'VFC', 'FTCH', 'VSCO', 'URBN', 'AMCR', 'ANF', 'LEVI', 'HBI', 'OXM', 'KTB', 'BKE', 'CAL', 'GIL', 'GES', 'GIII', 'AIN', 'CHS', 'ASIX', 'RYAM', 'ATXG', 'DXLG', 'VINO', 'PLBY', 'TLYS', 'GLT', 'EXPR', 'CTRN', 'LE', 'AREB', 'UFI', 'JILL', 'CATO', 'DLTH', 'LOOP', 'CURV', 'DLA', 'SGC', 'LVLU', 'XELB', 'SISI', 'AKA', 'JRSH', 'VNCE', 'DBGI', 'DXYN'], '電機機械': ['AMZN', 'LI', 'GE', 'TMO', 'DHR', 'DE', 'CAT', 'HON', 'LMT', 'PLUG', 'JCI', 'CMI', 'ETN', 'ROP', 'ITW', 'GNRC', 'ROK', 'PH', 'EMR', 'GPC', 'GWW', 'CARR', 'MTD', 'SWK', 'TT', 'PWR', 'RIG', 'CHPT', 'WSO', 'TEL', 'CSL', 'AME', 'FTV', 'EIX', 'NE', 'IR', 'CNHI', 'TXT', 'DOV', 'WCC', 'GPK', 'IEX', 'FTI', 'SNA', 'AOS', 'HII', 'ATKR', 'CR', 'LII', 'TDW', 'GGG', 'PNW', 'ATMU', 'TTC', 'VAL', 'NATI', 'AGCO', 'SEE', 'MIDD', 'FCEL', 'LECO', 'MSM', 'SPR', 'RRX', 'ITT', 'GTLS', 'NWL', 'BC', 'TKR', 'EME', 'NVT', 'TEX', 'BE', 'MDU', 'FREY', 'ATS', 'CW', 'DCI', 'LESL', 'EOSE', 'SYM', 'FLNC', 'GBX', 'FLS', 'DO', 'CIR', 'HMC', 'FIX', 'LBRT', 'CNM', 'NBR', 'MOD', 'RBC', 'EVGO', 'WWD', 'AVAV', 'GLNG', 'ITRI', 'MLI', 'BLNK', 'ERJ', 'WOR', 'WTS', 'OII', 'BMI', 'ERII', 'FELE', 'VMI', 'ENS', 'AAON', 'BORR', 'HAYW', 'OTTR', 'TRN', 'GTES', 'EPAC', 'NPO', 'FSS', 'KMT', 'TNC', 'DAN', 'GFF', 'ENR', 'LFUS', 'SPXC', 'MWA', 'AIT', 'JBT', 'HI', 'HZO', 'LNN', 'CYRX', 'BIP', 'LCII', 'MYRG', 'SXI', 'ALG', 'AIR', 'ESE', 'KAI', 'PRIM', 'HEES', 'ITGR', 'ASLE', 'AROC', 'ESAB', 'HY', 'PPSI', 'CECO', 'NAAS', 'TITN', 'MBUU', 'B', 'LXU', 'MTW', 'HLIO', 'PRLB', 'DXPE', 'KRNT', 'TWI', 'AZZ', 'UCAR', 'CMCO', 'AMPS', 'AMPX', 'DRQ', 'WBX', 'THR', 'MCFT', 'POWL', 'RNW', 'IESC', 'PTRA', 'MLAB', 'NRGV', 'MRC', 'ELP', 'PLPC', 'CRGY', 'ARAY', 'ALTG', 'ASTE', 'LUNA', 'HAYN', 'KSCP', 'GWH', 'RWLK', 'KAMN', 'HOLI', 'CTOS', 'ONEW', 'OFLX', 'TRNS', 'MEC', 'MTLS', 'ENLT', 'BW', 'AMOT', 'ARVL', 'DFLI', 'SMHI', 'GRC', 'AMSC', 'MPX', 'AZ', 'NVGS', 'FRZA', 'BBCP', 'AIRT', 'DCFC', 'BWEN', 'NOA', 'NGS', 'NVVE', 'GENC', 'ACU', 'STRC', 'NEOV', 'BGRY', 'ADSE', 'VMAR', 'SCX', 'SKYX', 'CBAT', 'GHM', 'ALLG', 'CYD', 'CRGE', 'KITT', 'NNBR', 'HURC', 'MKUL', 'GEOS', 'EML', 'DSGR', 'FLUX', 'MPU', 'EVI', 'RAIL', 'WLFC', 'NC', 'CETX', 'LGO', 'MWG', 'IPWR', 'CIX', 'FTEK', 'VHI', 'MNTX', 'FTK', 'EKSO', 'CLIR', 'PDEX', 'GIFI', 'CODA', 'COMS', 'CGRN', 'FCUV', 'NL', 'TATT', 'EZGO', 'SVT', 'CVR', 'GTEC', 'RVSN', 'POLA', 'TWIN', 'AIRI', 'CREG', 'VEEE', 'TOMZ', 'ARTW', 'WSO.B', 'PFIN', 'KIQ', 'WLMS', 'RAYA', 'MDVL', 'SIF', 'SOTK', 'JCSE', 'ELSE'], '電器電纜': ['PG', 'WMT', 'GE', 'HON', 'BBY', 'GPC', 'SONY', 'WSO', 'CSL', 'GLW', 'WHR', 'HUBB', 'WCC', 'LII', 'AYI', 'HELE', 'SPB', 'WIRE', 'SONO', 'PHG', 'IRBT', 'BELFB', 'BDC', 'ENR', 'BGC', 'UPBD', 'CLFD', 'SHYF', 'HEAR', 'CBD', 'LYTS', 'VZIO', 'AMSC', 'NPK', 'ATER', 'VOXX', 'CONN', 'HBB', 'NC', 'OESX', 'VIOT', 'BRSH', 'WSO.B', 'EFOI', 'RFIL', 'MSN', 'FGH', 'APWC'], '化學工業': ['XOM', 'JNJ', 'PG', 'CVX', 'LIN', 'ALB', 'OXY', 'HON', 'COP', 'SHW', 'KVUE', 'MMM', 'CL', 'KMB', 'APD', 'ECL', 'ITW', 'DOW', 'CHD', 'CTVA', 'PPG', 'SQM', 'GPC', 'LYB', 'VMC', 'IFF', 'MLM', 'DD', 'CLX', 'GSK', 'BG', 'MOS', 'STE', 'NTR', 'CF', 'CSL', 'CE', 'LTHM', 'EMN', 'UL', 'FMC', 'AVY', 'GT', 'TTE', 'OLN', 'AVTR', 'HUN', 'RPM', 'HLN', 'CC', 'AXTA', 'ASH', 'SPB', 'WLK', 'SMG', 'FUL', 'LESL', 'UNVR', 'CVI', 'NEU', 'SSD', 'GPRE', 'KWR', 'AVNT', 'ESI', 'PKX', 'BRC', 'SXT', 'GTES', 'NPO', 'ANDE', 'CBT', 'DAN', 'EPC', 'NGVT', 'CENX', 'HAIN', 'BAK', 'BGS', 'OLPX', 'OEC', 'WDFC', 'TROX', 'SCL', 'ALTO', 'BCPC', 'ECVT', 'ICL', 'AESI', 'DSEY', 'GEVO', 'UAN', 'MEOH', 'MTX', 'ASPN', 'CMP', 'PRM', 'AMTX', 'ASIX', 'SXC', 'AMRS', 'LXU', 'CSWI', 'SLCA', 'AGRO', 'IOSP', 'EAF', 'TWI', 'CPS', 'HDSN', 'SSL', 'UGP', 'TSE', 'TILE', 'IPI', 'AVD', 'HWKN', 'LNZA', 'ODC', 'NRP', 'KOP', 'CCF', 'KRO', 'HNST', 'REX', 'MYE', 'PAHC', 'GROV', 'ADN', 'CLMT', 'ASPI', 'NMG', 'NTIC', 'VGAS', 'HTOO', 'NVX', 'NATR', 'ADES', 'LGO', 'VHI', 'ELBM', 'EPOW', 'UFAB', 'NL', 'AE', 'GURE', 'CNEY', 'YCBD', 'GRFX', 'ACNT', 'SVFD', 'LVRO', 'MGLD', 'CTIB', 'FSI', 'REFR', 'QLI', 'CGA'], '建材居家用品': ['TJX', 'W', 'PPG', 'GPC', 'BLDR', 'RL', 'FERG', 'OC', 'CRH', 'CSL', 'OTIS', 'ALLE', 'FND', 'MAS', 'FBIN', 'DOV', 'TPX', 'AOS', 'MHK', 'TREX', 'BLD', 'LPX', 'MIDD', 'NWL', 'HELE', 'LEG', 'SPB', 'MDU', 'AZEK', 'AWI', 'CNM', 'SSD', 'BCC', 'UFPI', 'BECN', 'KNF', 'GMS', 'OI', 'IBP', 'ZWS', 'TGLS', 'SCS', 'SNBR', 'LZB', 'MBC', 'PCH', 'LOVE', 'PGTI', 'AMWD', 'DOOR', 'ROCK', 'BXC', 'HNI', 'MLKN', 'JELD', 'REYN', 'PATK', 'ETD', 'WFG', 'APOG', 'JBI', 'ARHS', 'NX', 'TILE', 'LTCH', 'LCUT', 'PRPL', 'LL', 'KOP', 'TUP', 'HOFT', 'TTSH', 'CSTE', 'BSET', 'VIEW', 'LIVE', 'NC', 'FSTR', 'FLXS', 'APT', 'CULP', 'RETO', 'VIOT', 'VIRC', 'AEHL', 'AUVI', 'KEQU', 'ILAG', 'NVFY', 'NTZ', 'SGBX', 'JCTCF', 'FGI'], '造紙': ['PG', 'KMB', 'CHD', 'IP', 'PKG', 'AVY', 'GPK', 'AMCR', 'EXP', 'WRK', 'SEE', 'SON', 'SUZ', 'EPC', 'SLVM', 'GEF', 'MERC', 'KAI', 'MATV', 'REYN', 'RYAM', 'CLW', 'TG', 'PACK', 'GLT', 'HNST', 'PTVE', 'GEF.B', 'KRT', 'OCTO', 'ITP', 'FGH'], '鋼鐵金屬': ['FCX', 'VALE', 'NEM', 'GOLD', 'ITW', 'NUE', 'RIO', 'FAST', 'X', 'BHP', 'STLD', 'AA', 'CCJ', 'AEM', 'CLF', 'PLM', 'ATI', 'TECK', 'RS', 'TS', 'MP', 'WPM', 'SCCO', 'MT', 'RGLD', 'AU', 'CMC', 'FNV', 'KGC', 'PAAS', 'GFI', 'GGB', 'SBSW', 'LAC', 'HL', 'AGI', 'SSD', 'AG', 'SSRM', 'ARNC', 'UEC', 'MLI', 'PKX', 'WOR', 'SGML', 'BTG', 'TMC', 'VMI', 'CSTM', 'ASTL', 'CDE', 'HMY', 'PLL', 'CRS', 'NXE', 'OR', 'CENX', 'SAND', 'EGO', 'EQX', 'TROX', 'FSM', 'TX', 'TMST', 'SID', 'BVN', 'DNN', 'EXK', 'REYN', 'UUUU', 'SCHN', 'SILV', 'MAG', 'NG', 'GSM', 'KALU', 'IAG', 'ZEUS', 'AZZ', 'HBM', 'SA', 'USAP', 'AMRK', 'SVM', 'NGD', 'TG', 'MRC', 'DRD', 'NFGC', 'LEU', 'MUX', 'IAUX', 'ERO', 'TRS', 'HAYN', 'IIIN', 'SLI', 'GATO', 'FRD', 'TGB', 'PKOH', 'HYMC', 'AMLI', 'ORLA', 'SKE', 'EU', 'NWPX', 'ATLX', 'GROY', 'CMCL', 'TFPM', 'CGAU', 'NEWP', 'NOA', 'GORO', 'NEXA', 'EMX', 'MTA', 'DC', 'URG', 'UROY', 'FEAM', 'HUDI', 'IONR', 'GLDG', 'PPTA', 'WWR', 'CTGO', 'USAS', 'MSB', 'HLP', 'NAK', 'ASM', 'USAU', 'DSGR', 'TRX', 'LITM', 'GAU', 'WRN', 'IPX', 'FSTR', 'TMQ', 'PLG', 'LGO', 'VGZ', 'ODV', 'FURY', 'ITRG', 'ELBM', 'VZLA', 'UAMY', 'USEG', 'XPL', 'AUMN', 'AP', 'CVR', 'ACNT', 'IDR', 'VOXR', 'AUST', 'GLG', 'THM', 'AAU', 'PZG', 'ZKIN', 'SIM', 'CHNR'], '車輛相關': ['TSLA', 'AMZN', 'RIVN', 'NIO', 'XPEV', 'F', 'LCID', 'LI', 'BIDU', 'AZO', 'HON', 'GM', 'CVNA', 'ORLY', 'PLUG', 'JCI', 'MMM', 'ETN', 'GPC', 'APTV', 'BWA', 'CPRT', 'AAP', 'KMX', 'PCAR', 'RACE', 'AN', 'CAR', 'CSL', 'WAB', 'HOG', 'LEA', 'LAD', 'NKLA', 'ALLY', 'CNHI', 'STLA', 'LKQ', 'QS', 'HTZ', 'BTBT', 'FSR', 'ALV', 'THO', 'VVV', 'PII', 'MGA', 'ABG', 'MULN', 'ITT', 'TKR', 'PAG', 'ALSN', 'GPI', 'OSK', 'TM', 'CACC', 'GOEV', 'HMC', 'WKHS', 'CWH', 'WGO', 'R', 'VC', 'SKY', 'ACVA', 'MOD', 'FFIE', 'PSNY', 'MCW', 'FOXF', 'WNC', 'AUR', 'ADNT', 'GTES', 'FSS', 'MCOM', 'SAH', 'XPEL', 'DAN', 'ENR', 'BLDP', 'MNRO', 'THRM', 'IDEX', 'ATHM', 'LCII', 'BLBD', 'VRM', 'RUSHA', 'AXL', 'GTX', 'DRVN', 'SHYF', 'CARS', 'SLDP', 'DORM', 'KAR', 'TSP', 'LPRO', 'CVGI', 'PRTS', 'MVST', 'CRMT', 'RIDE', 'CPS', 'UCAR', 'AMPX', 'IX', 'LEV', 'PTRA', 'SES', 'HYZN', 'SMP', 'NWTN', 'REVG', 'HYLN', 'PLOW', 'CJET', 'KNDI', 'RMBL', 'CENN', 'NIU', 'LVWR', 'GGR', 'ARVL', 'DFLI', 'HLLY', 'RUSHB', 'SOLO', 'UXIN', 'MPAA', 'ZEV', 'STRT', 'SEV', 'VOXX', 'ADN', 'LAZY', 'ATLC', 'WPRT', 'XOS', 'MLR', 'CAAS', 'KEN', 'CZOO', 'CBAT', 'WKSP', 'XPON', 'BRDS', 'SFT', 'SUP', 'FUV', 'CPSS', 'SPI', 'GP', 'VLCN', 'SYPR', 'MNTX', 'ALPP', 'AYRO', 'CANG', 'UFAB', 'JZXN', 'REE', 'EZGO', 'ID', 'KXIN', 'ZAPP', 'VEV', 'TC', 'SSU', 'PEV', 'EVTV', 'PAVS'], '電子': ['TSLA', 'NVDA', 'AAPL', 'MSFT', 'AMD', 'AMZN', 'META', 'GOOGL', 'GOOG', 'NFLX', 'BABA', 'MU', 'AVGO', 'V', 'ADBE', 'DIS', 'ABNB', 'MARA', 'INTU', 'PYPL', 'TSM', 'YNDX', 'INTC', 'MA', 'FIS', 'CRM', 'ORCL', 'BKNG', 'SHOP', 'AI', 'SNOW', 'MDB', 'WMT', 'PANW', 'SMCI', 'ENPH', 'MSTR', 'LRCX', 'PLTR', 'RIOT', 'ASML', 'VZ', 'CSCO', 'PDD', 'SQ', 'AMAT', 'ACN', 'TXN', 'CMCSA', 'MRVL', 'ON', 'ATVI', 'BIDU', 'UBER', 'ROKU', 'GE', 'QCOM', 'U', 'CSGP', 'T', 'MELI', 'DHR', 'ISRG', 'NOW', 'ADI', 'TMUS', 'HON', 'SEDG', 'EFX', 'JD', 'MCHP', 'NXPI', 'RBLX', 'SNPS', 'FSLR', 'KLAC', 'CHTR', 'CDNS', 'CRWD', 'EQIX', 'IBM', 'CVNA', 'ETSY', 'ADP', 'EXPE', 'SE', 'WDAY', 'FI', 'PLUG', 'FTNT', 'ADSK', 'W', 'MMM', 'AFRM', 'DDOG', 'SO', 'WBD', 'ETN', 'ANET', 'ROP', 'MPWR', 'DASH', 'GPN', 'HUBS', 'PINS', 'EBAY', 'A', 'EA', 'PPG', 'HPQ', 'INFY', 'SQM', 'DOCU', 'BBY', 'ZM', 'TTD', 'SWKS', 'SNAP', 'ZS', 'APH', 'VMW', 'LYFT', 'TCOM', 'DELL', 'TEAM', 'APTV', 'OKTA', 'DKS', 'MSI', 'PTC', 'KEYS', 'ENVX', 'CPRT', 'RUN', 'MTD', 'DD', 'SPOT', 'NTAP', 'COHR', 'PARA', 'NET', 'LSCC', 'VEEV', 'ENTG', 'TWLO', 'SAP', 'IONQ', 'MTCH', 'QRVO', 'CTSH', 'BILL', 'FDS', 'XYL', 'ANSS', 'ZI', 'NTES', 'STM', 'CDW', 'AKAM', 'CHWY', 'OSTK', 'PTON', 'TER', 'SONY', 'HPE', 'TTWO', 'PATH', 'CPNG', 'TEL', 'MNDY', 'CFLT', 'ARW', 'PSTG', 'CHKP', 'PAYC', 'CDAY', 'WAT', 'BAH', 'Z', 'S', 'MAT', 'MBLY', 'BILI', 'FTV', 'ACLS', 'GLW', 'CLSK', 'FFIV', 'FICO', 'ZBRA', 'VRSN', 'NXT', 'JBL', 'PENN', 'ARRY', 'WDC', 'STX', 'SPLK', 'FLT', 'GDDY', 'TOST', 'WOLF', 'HAS', 'DT', 'VRT', 'TRU', 'RMBS', 'IRM', 'GME', 'APLD', 'AVY', 'GRMN', 'LEA', 'FLEX', 'DUOL', 'SIMO', 'EPAM', 'ST', 'FIVN', 'GFS', 'BR', 'NOK', 'JKHY', 'HUBB', 'FTCH', 'OPRA', 'LBRDK', 'WIX', 'SOUN', 'AEHR', 'TYL', 'IEX', 'J', 'NICE', 'ALGM', 'PCOR', 'DBX', 'GEN', 'GLBE', 'TRIP', 'LITE', 'VIPS', 'SSNC', 'IOT', 'TRMB', 'CIEN', 'EXTR', 'UAA', 'LBTYK', 'GLOB', 'LAZR', 'MANH', 'BTBT', 'BB', 'SMAR', 'LSXMK', 'WEX', 'FOUR', 'JNPR', 'PCTY', 'GTLB', 'AYI', 'ALV', 'DOCN', 'ACMR', 'ESTC', 'NOVA', 'UMC', 'GRAB', 'IQ', 'STNE', 'SNX', 'VOD', 'NATI', 'CYBR', 'LDOS', 'CACI', 'MKSI', 'NEWR', 'SPWR', 'MGA', 'CSIQ', 'ASX', 'BSY', 'DOX', 'FUBO', 'NDSN', 'YMM', 'AYX', 'ASAN', 'HCP', 'PI', 'SLAB', 'BKI', 'ITT', 'WU', 'FRSH', 'WK', 'DXC', 'NWL', 'STEM', 'MTSI', 'YOU', 'CRDO', 'CGNX', 'FSLY', 'PAGS', 'JKS', 'TSEM', 'NOVT', 'PRGS', 'APP', 'SMTC', 'DQ', 'GWRE', 'WNS', 'RNG', 'GNTX', 'NTNX', 'SAIC', 'IRDM', 'IDCC', 'IAC', 'BFH', 'BOX', 'TDC', 'BMBL', 'SYNA', 'NVMI', 'DAVA', 'FROG', 'AVT', 'SSTK', 'TENB', 'CRUS', 'IPGP', 'LBTYA', 'LUMN', 'AAOI', 'YY', 'RPD', 'PD', 'AZPN', 'CARG', 'TME', 'POWI', 'MVIS', 'ERIC', 'OLED', 'G', 'FYBR', 'LSXMA', 'MXL', 'PLAB', 'SGH', 'SITM', 'DV', 'SPT', 'VNT', 'KLIC', 'LOGI', 'BCE', 'SQSP', 'RVLV', 'APPS', 'FVRR', 'AMX', 'SONO', 'SSYS', 'BRZE', 'ODP', 'FLYW', 'NSIT', 'UA', 'AMKR', 'VERX', 'IREN', 'VRRM', 'AMBA', 'VC', 'NCR', 'PHG', 'SHLS', 'VRNS', 'QLYS', 'ONTO', 'SPSC', 'ACVA', 'NVTS', 'COMM', 'KC', 'FN', 'IGT', 'VIAV', 'EEFT', 'BITF', 'NSSC', 'CVLT', 'VSH', 'RLX', 'MOMO', 'ESI', 'ITRI', 'ROG', 'WULF', 'IRTC', 'PWSC', 'BRC', 'ENV', 'MAXN', 'ADT', 'QBTS', 'CALX', 'ALIT', 'NNDM', 'YEXT', 'WB', 'ALTR', 'INTA', 'OSIS', 'REAL', 'HLIT', 'BELFB', 'HIMX', 'SFIX', 'ZG', 'BBAI', 'BL', 'VSAT', 'ENS', 'APPF', 'NGMS', 'UI', 'ASGN', 'YELP', 'EBIX', 'HIVE', 'ZD', 'DLB', 'KD', 'COOP', 'INDI', 'ZUO', 'RXT', 'BDC', 'EVBG', 'RELY', 'FSS', 'CCCS', 'RUM', 'ALRM', 'SKM', 'ZETA', 'MCOM', 'VICR', 'PEGA', 'DIOD', 'AEIS', 'VRNT', 'CXM', 'PRFT', 'TU', 'SABR', 'SANM', 'MQ', 'PYCR', 'WIT', 'QIWI', 'ENR', 'LFUS', 'XRX', 'MODN', 'JMIA', 'SPHR', 'PLXS', 'SPXC', 'TDS', 'CAN', 'FORM', 'BLDP', 'CRNC', 'ASTS', 'OTEX', 'EVTC', 'CTS', 'CIFR', 'NCNO', 'CCOI', 'VIV', 'BGC', 'ARLO', 'PINC', 'AMRC', 'RADI', 'PAYO', 'AGYS', 'UPBD', 'VREX', 'INFN', 'EB', 'ESMT', 'DDD', 'TASK', 'LBRDA', 'CD', 'RAMP', 'QRTEA', 'SMRT', 'SBGI', 'COHU', 'RGTI', 'FTCI', 'FORG', 'XMTR', 'HUYA', 'QTWO', 'ATHM', 'QUOT', 'AVDX', 'PLTK', 'NTCT', 'CLFD', 'APPN', 'DGII', 'CSGS', 'UCTT', 'PRO', 'TIMB', 'ATEN', 'WISH', 'MMYT', 'RPAY', 'GDS', 'ACIW', 'EVRI', 'AVID', 'GENI', 'LPSN', 'GREE', 'MTTR', 'NABL', 'GIB', 'CRSR', 'SKLZ', 'MAX', 'PGY', 'NOTE', 'GDYN', 'CARS', 'VECO', 'ESLT', 'PDFS', 'BAND', 'BLKB', 'MEI', 'SLDP', 'RCI', 'PUBM', 'BIGC', 'INOD', 'GSIT', 'IMMR', 'KT', 'ZH', 'MIR', 'PAR', 'THRY', 'GRPN', 'DLO', 'KAR', 'NVEC', 'WEAV', 'LSPD', 'AOSL', 'MTRN', 'EVLV', 'DFIN', 'DSGX', 'KIND', 'LILAK', 'BASE', 'ICHR', 'MVST', 'AMK', 'ADTN', 'SWI', 'KN', 'CLS', 'NVEI', 'MITK', 'DMRC', 'OUST', 'USM', 'INFA', 'TLK', 'ETWO', 'HKD', 'TWKS', 'SCPL', 'OLO', 'HSAI', 'KOPN', 'CRCT', 'CCSI', 'CHT', 'EGHT', 'KLR', 'JAMF', 'CAMT', 'CXAI', 'TTEC', 'LWLG', 'TTGT', 'HEAR', 'PSFE', 'VLD', 'FA', 'GOGO', 'AMPL', 'GPRO', 'VUZI', 'INTT', 'GDRX', 'AMPS', 'DM', 'AMCX', 'ROVR', 'GSAT', 'OSPN', 'AMPX', 'PLUS', 'REKR', 'TTMI', 'KODK', 'AVPT', 'GRWG', 'QUBT', 'ALKT', 'SEMR', 'DOMO', 'FNGR', 'AAN', 'LASR', 'RELL', 'AMSWA', 'CCRD', 'FARO', 'SPNS', 'TEF', 'ORAN', 'ADEA', 'ACCO', 'ONTF', 'SPOK', 'INVZ', 'ENFN', 'RNW', 'LYTS', 'ATTO', 'PBI', 'ABST', 'CWAN', 'CLEU', 'IIIV', 'SCSC', 'BOC', 'NTGR', 'LTCH', 'GCT', 'SMX', 'CGNT', 'CRNT', 'VMEO', 'VZIO', 'MPLN', 'ASUR', 'ECX', 'MLNK', 'SKYT', 'XPER', 'DDL', 'CMTL', 'BHE', 'TKC', 'CLMB', 'RENT', 'LUNA', 'FRGE', 'ACEL', 'VERI', 'CEVA', 'EXFY', 'RSKD', 'SURG', 'ARQQ', 'CLBT', 'SHEN', 'RMBL', 'ISPR', 'HUBC', 'PMTS', 'INBK', 'RDWR', 'SOL', 'TEO', 'IDT', 'HOLO', 'CNXN', 'VVX', 'AUDC', 'SSTI', 'RBBN', 'CTLP', 'ATEX', 'MYPS', 'IHS', 'SATS', 'TCX', 'LAW', 'UIS', 'AVNW', 'KE', 'IBEX', 'SRAD', 'RMNI', 'PRST', 'SUNW', 'UEIC', 'RSI', 'FOSL', 'MTLS', 'GRVY', 'INST', 'AEVA', 'AGS', 'TGS', 'BLND', 'XELA', 'SRI', 'IMBI', 'MX', 'AXTI', 'ATOM', 'MOND', 'WOW', 'ITI', 'BLZE', 'TDUP', 'SIFY', 'LQDT', 'BEEM', 'LOV', 'TIGO', 'JFIN', 'TYGO', 'ANY', 'VPG', 'INSG', 'GRND', 'AMOT', 'VNET', 'PALT', 'VCIG', 'ELTK', 'DFLI', 'TLS', 'AKTS', 'ATNI', 'ASYS', 'LILA', 'DAO', 'BZUN', 'CMPO', 'KLTR', 'PBTS', 'GILT', 'UXIN', 'TZOO', 'SNPO', 'INSE', 'MRAM', 'IMOS', 'EVCM', 'MKFG', 'AIP', 'PRCH', 'VTSI', 'YSG', 'ARBK', 'KARO', 'MYTE', 'VLN', 'EMAN', 'DCBO', 'OMH', 'DAKT', 'UPLD', 'GIC', 'LPL', 'GAN', 'MG', 'GBTG', 'RERE', 'PARAA', 'AIXI', 'API', 'EGIO', 'INVE', 'HEPS', 'DZSI', 'TIXT', 'ANGI', 'DSP', 'STBX', 'VOXX', 'TOUR', 'BCOV', 'CMBM', 'WETG', 'CNXA', 'VCSA', 'CNSL', 'SMWB', 'YALA', 'MICS', 'OOMA', 'ADN', 'DUO', 'FRGT', 'ITRN', 'SYTA', 'ASTC', 'WISA', 'MHH', 'EGAN', 'ICG', 'PAYS', 'PHI', 'NCTY', 'DOYU', 'ASPS', 'SMSI', 'NEGG', 'VEON', 'CNVS', 'NN', 'SOHU', 'PHUN', 'BELFA', 'WIMI', 'EMBK', 'CRKN', 'VTEX', 'KVHI', 'TRUE', 'BTCS', 'CINT', 'HKIT', 'IZM', 'SKIL', 'IRNT', 'WKME', 'TRVG', 'WATT', 'ARBE', 'QUIK', 'LKCO', 'LUCY', 'BTB', 'CAMP', 'IVAC', 'GRRR', 'MAPS', 'OCFT', 'SFR', 'STCN', 'HLGN', 'BRQS', 'PCYG', 'SQNS', 'BTOG', 'INPX', 'MVLA', 'MIGI', 'LCFY', 'CTG', 'WLDS', 'SCWX', 'NEON', 'GDEV', 'LPTV', 'PAY', 'CONN', 'ASST', 'IDAI', 'VSTA', 'STKH', 'CRGE', 'PWFL', 'VRAR', 'WKSP', 'LEJU', 'DIBS', 'TACT', 'LVO', 'AUID', 'CSPI', 'LTRX', 'LINK', 'XPON', 'QH', 'OCTO', 'DUOT', 'GDC', 'MARK', 'APCX', 'DSGR', 'CSSE', 'LIZI', 'LIDR', 'WORX', 'SILC', 'ADTH', 'BMR', 'PCTI', 'DGHI', 'CPTN', 'MKTW', 'TROO', 'WTT', 'VHC', 'AUUD', 'MSGM', 'LTRPA', 'ONDS', 'LFLY', 'TMPO', 'SPI', 'AREN', 'DTST', 'RBT', 'TGAN', 'POET', 'LGMK', 'LASE', 'MMV', 'NIR', 'SONM', 'CREX', 'CASA', 'XNET', 'ASTI', 'GNSS', 'IFBD', 'RVYL', 'CETX', 'TESS', 'OSS', 'PIK', 'PFSW', 'RCON', 'ISDR', 'BOSC', 'AMST', 'NHTC', 'MIMO', 'BCAN', 'EBET', 'ESP', 'GETR', 'ISUN', 'GAIA', 'SLNH', 'MGIC', 'BNMV', 'SOPA', 'EMKR', 'QMCO', 'BOXL', 'BQ', 'BKTI', 'ZFOX', 'CLRO', 'EBON', 'IVDA', 'RDVT', 'SAI', 'KWE', 'IPWR', 'GROM', 'GMGI', 'KORE', 'LITB', 'MINM', 'PXLW', 'OBLG', 'INTZ', 'CYN', 'CISO', 'TUYA', 'SYPR', 'CVV', 'SHPW', 'MRIN', 'WFCF', 'POL', 'ALLT', 'NSYS', 'KPLT', 'VQS', 'HIHO', 'FONR', 'ALPP', 'MYNA', 'MTEK', 'PEGY', 'UTME', 'NXPL', 'EGLX', 'NOGN', 'SOFO', 'QRTEB', 'RTC', 'SCOR', 'AEYE', 'RDCM', 'LVOX', 'NFTG', 'MOVE', 'FRSX', 'CURI', 'CPSH', 'COMS', 'OESX', 'SNTG', 'ULBI', 'LGL', 'MNDO', 'SNCR', 'JG', 'VERB', 'NTWK', 'LPTH', 'JZ', 'AWRE', 'ONVO', 'UPXI', 'YJ', 'LICN', 'MTC', 'SY', 'GVP', 'FENG', 'DPSI', 'ZEPP', 'MCHX', 'OCC', 'UUU', 'DMS', 'ALAR', 'BURU', 'BRSH', 'STIX', 'NA', 'MFH', 'KTCC', 'POCI', 'FCUV', 'GAME', 'ZDGE', 'BMTX', 'MYSZ', 'TAIT', 'VJET', 'UCL', 'MRM', 'AIRG', 'WKEY', 'OLB', 'MRDB', 'BLIN', 'CTM', 'EM', 'IDN', 'HTCR', 'OST', 'MPTI', 'MIXT', 'USIO', 'SVRE', 'KERN', 'ALOT', 'ARBB', 'DAIO', 'DATS', 'DAVE', 'MTBL', 'DDI', 'ID', 'NISN', 'VISL', 'VRME', 'SPCB', 'YVR', 'SRT', 'SJ', 'SATX', 'TANH', 'VS', 'BLBX', 'AMPG', 'WNW', 'BHAT', 'CMCM', 'TRT', 'PT', 'PRSO', 'MCLD', 'LTRPB', 'MOGU', 'NXTP', 'SGMA', 'SECO', 'JXJT', 'FATH', 'JFBR', 'CXDO', 'SSNT', 'PERF', 'OTMO', 'MLGO', 'KOSS', 'BRAG', 'BSQR', 'KUKE', 'KBNT', 'LEDS', 'PRTH', 'CUEN', 'WAVD', 'AGIL', 'KAVL', 'HOUR', 'FEIM', 'OMQS', 'MF', 'MGLD', 'TAOP', 'SWVL', 'TC', 'SSU', 'TSRI', 'EFOI', 'IDBA', 'CLPS', 'DGLY', 'DSWL', 'LYT', 'SYT', 'SGE', 'SNAL', 'SCKT', 'FORTY', 'IMTE', 'JFU', 'INLX', 'AGMH', 'AIU', 'ANGH', 'WYY', 'AHG', 'GSMG', 'DTSS', 'TGL', 'LSAK', 'MOXC', 'NTIP', 'OCG', 'LSXMB', 'SASI', 'SNT', 'GIGM', 'AEY', 'BKYI', 'ANTE', 'ASNS', 'RFIL', 'UTSI', 'MSN', 'ZENV', 'LBTYB', 'PAVS', 'SANG', 'SBIG', 'APWC', 'FRES', 'FGH', 'JWEL', 'FKWL', 'VIAO', 'NYAX'], '營建地產': ['AMZN', 'DHI', 'CSX', 'LEN', 'PHM', 'CBRE', 'OPEN', 'TOL', 'NVR', 'Z', 'BEKE', 'WSC', 'INVH', 'J', 'KBH', 'ACM', 'TMHC', 'KBR', 'JLL', 'MTZ', 'WRK', 'TTEK', 'RDFN', 'DDS', 'EME', 'MTH', 'FLR', 'GRBK', 'TRNO', 'CNM', 'STRL', 'SKY', 'MHO', 'MDC', 'CX', 'DY', 'TPH', 'FTDR', 'AJRD', 'LGIH', 'ZWS', 'EXPI', 'BZH', 'ZG', 'NVEE', 'APG', 'HHC', 'CWK', 'ACA', 'CCS', 'DEA', 'LEN.B', 'RYN', 'ROAD', 'JOE', 'AMRC', 'COMP', 'SJW', 'IMKTA', 'CVCO', 'LMB', 'BV', 'VGR', 'REZI', 'PRIM', 'DFH', 'HOUS', 'MEG', 'KW', 'MMI', 'ARLP', 'HOV', 'LSEA', 'TCN', 'GVA', 'AGRO', 'WE', 'NMRK', 'FOR', 'ALEX', 'IX', 'STN', 'GLDD', 'AGX', 'TPC', 'VEDU', 'DOUG', 'RMR', 'SWIM', 'BWMN', 'LEGH', 'LMNR', 'CRESY', 'REX', 'TISI', 'PKOH', 'RCMT', 'OPAD', 'ALCO', 'RMAX', 'BVH', 'OMH', 'IRS', 'FRPH', 'DOMA', 'DUO', 'WLDN', 'RDIB', 'MLP', 'REAX', 'ASPS', 'SCWO', 'PESI', 'SFR', 'TRC', 'AXR', 'STRR', 'LEJU', 'UHG', 'MTRX', 'GRNQ', 'TROO', 'LND', 'SLND', 'PCYO', 'ENG', 'ARL', 'RDI', 'VHI', 'NYC', 'BRN', 'HCDI', 'UK', 'WLGS', 'XIN', 'FPH', 'OIG', 'STRS', 'ORN', 'GRFX', 'FLJ', 'CHCI', 'DRTT', 'FTHM', 'PGRU', 'GGE', 'WLMS', 'RFL', 'SGBX', 'SYT', 'NEN', 'MITQ', 'MDJH', 'VIVK', 'TPHS', 'FGH', 'INTG', 'CKX', 'AENZ', 'MAYS'], '運輸': ['BRK.A', 'AMZN', 'BRK.B', 'UPS', 'YNDX', 'UBER', 'GE', 'FDX', 'DAL', 'MELI', 'AAL', 'JD', 'UNP', 'UAL', 'LUV', 'JOBY', 'ODFL', 'CSX', 'NSC', 'PSA', 'LYFT', 'SAIA', 'CP', 'JBHT', 'EXPD', 'ZTO', 'CHRW', 'RYAAY', 'KNX', 'XPO', 'STNG', 'JBLU', 'ALK', 'ZIM', 'TDW', 'CPA', 'FRO', 'GRAB', 'CNI', 'YMM', 'GXO', 'LSTR', 'AER', 'COLD', 'AZUL', 'ARCB', 'SUM', 'CNX', 'R', 'MATX', 'KEX', 'ALGT', 'TNK', 'SBLK', 'TFII', 'INSW', 'RXO', 'GNK', 'SKYW', 'DHT', 'ULCC', 'TRN', 'SAVE', 'EURN', 'SNDR', 'WERN', 'PAC', 'FWRD', 'ASR', 'LPG', 'BIPC', 'HA', 'UHAL.B', 'JMIA', 'CMRE', 'HUBG', 'UHAL', 'ASC', 'SFL', 'TK', 'YELL', 'NAT', 'CYRX', 'GSL', 'DAC', 'EGLE', 'BIP', 'TRMD', 'SNCY', 'NETI', 'GOGL', 'TGH', 'DADA', 'CVLG', 'ATSG', 'VTOL', 'TNP', 'CAAP', 'MRTN', 'CLCO', 'ATXG', 'OMAB', 'ALEX', 'HTLD', 'SP', 'SEB', 'PBI', 'SB', 'VLRS', 'BLDE', 'PANL', 'VVX', 'DSX', 'FIP', 'OSG', 'LOMA', 'IMPP', 'SHIP', 'DSKE', 'PKOH', 'EVEX', 'MESA', 'ULH', 'GASS', 'RLGT', 'NVGS', 'ESEA', 'AIRT', 'SFWL', 'HSHP', 'FRGT', 'UP', 'OP', 'EDRY', 'TORO', 'GRIN', 'STCN', 'BEST', 'TOPS', 'PTSI', 'HHS', 'PXS', 'JYD', 'DSGR', 'CRGO', 'CTRM', 'PSHG', 'USEA', 'CACO', 'SKYH', 'PATI', 'NM', 'DLHC', 'GLBS', 'SGLY', 'SWVL', 'YGMZ', 'AENZ'], '觀光休閒娛樂': ['CCL', 'DIS', 'PG', 'TGT', 'COST', 'BKNG', 'MCD', 'CMCSA', 'CMG', 'SBUX', 'BMY', 'ULTA', 'MAR', 'LVS', 'RCL', 'NCLH', 'EL', 'TJX', 'EXPE', 'DKNG', 'HLT', 'WYNN', 'YUM', 'DPZ', 'M', 'DRI', 'RL', 'TCOM', 'BBWI', 'CPRI', 'PTON', 'CZR', 'AMC', 'WING', 'MGM', 'MTN', 'CAVA', 'TXRH', 'YUMC', 'NUS', 'TPR', 'PENN', 'UL', 'GPS', 'FTCH', 'H', 'ELF', 'SIG', 'URBN', 'TRIP', 'ARMK', 'PFGC', 'COTY', 'CUK', 'HTHT', 'PLNT', 'BYD', 'SHAK', 'CBRL', 'CHH', 'WH', 'EAT', 'PZZA', 'WEN', 'CHDN', 'QSR', 'GLPI', 'SEAS', 'PLAY', 'SIX', 'VAC', 'HELE', 'LNW', 'L', 'BLMN', 'RHP', 'MANU', 'CAKE', 'MLCO', 'SG', 'TNL', 'XPOF', 'HGV', 'MSGS', 'JACK', 'IGT', 'GENK', 'CNK', 'ATAT', 'NGMS', 'IPAR', 'DIN', 'IHG', 'PLYA', 'LOCO', 'PTLO', 'SBH', 'GES', 'BROS', 'JMIA', 'EPC', 'DNUT', 'RRR', 'ARCO', 'XHR', 'KRUS', 'LIND', 'LTH', 'OSW', 'MMYT', 'TH', 'GDEN', 'BJRI', 'SKIN', 'FUN', 'FWRG', 'CHUY', 'NTCO', 'MCRI', 'DENN', 'ZGN', 'RRGB', 'EWCZ', 'BALY', 'MCS', 'TAST', 'RICK', 'BATRK', 'VINO', 'VVI', 'MOV', 'PLBY', 'PBPB', 'GAMB', 'RSI', 'FOSL', 'MOND', 'WALD', 'HNST', 'CVEO', 'TUP', 'VRA', 'CRESY', 'TZOO', 'DESP', 'BATRA', 'BVH', 'PAHC', 'YSG', 'BH', 'GAN', 'GBTG', 'NDLS', 'GROV', 'TOUR', 'SGHC', 'SHCO', 'THCH', 'NATH', 'LUXH', 'LANV', 'MLP', 'BODY', 'SOND', 'BRLT', 'TRVG', 'FXLV', 'HOFV', 'GRIL', 'BH.A', 'FRGI', 'BDL', 'NATR', 'CNTY', 'FLL', 'RGS', 'TKLF', 'STKS', 'EEX', 'LTRPA', 'HFFG', 'JUPW', 'RAVE', 'XELB', 'ELA', 'BFI', 'EBET', 'LFVN', 'RDI', 'GMBL', 'GTIM', 'ISPO', 'XWEL', 'EGLX', 'SLGG', 'ARKR', 'FAT', 'GHG', 'TRNR', 'YTRA', 'MSC', 'JEWL', 'LTRY', 'GAME', 'GBR', 'CTHR', 'CHSN', 'MRM', 'SLNA', 'GDHG', 'ELYS', 'YCBD', 'FAZE', 'CDRO', 'WNW', 'LTRPB', 'JXJT', 'NXTP', 'BGI', 'CPHC', 'MTEX', 'SBET', 'MGLD', 'BREA', 'AWX', 'FATBB', 'REBN', 'YOSH', 'BTBD', 'INTG'], '金融相關': ['BRK.A', 'AMZN', 'COIN', 'JPM', 'BABA', 'BAC', 'BRK.B', 'MARA', 'MS', 'C', 'WFC', 'RIOT', 'SCHW', 'GS', 'GE', 'AXP', 'SPGI', 'BLK', 'HUM', 'CVS', 'EFX', 'UPST', 'SOFI', 'USB', 'EQIX', 'AMT', 'BX', 'PLD', 'DLR', 'DHI', 'CI', 'URI', 'ICE', 'AFRM', 'PNC', 'PGR', 'AJG', 'O', 'MET', 'TFC', 'HOOD', 'CCI', 'FUTU', 'AIG', 'MMC', 'AON', 'KEY', 'SPG', 'MSCI', 'LEN', 'HDB', 'MCO', 'DFS', 'PHM', 'PSA', 'ALL', 'CFG', 'IBN', 'NDAQ', 'APO', 'MTB', 'CB', 'VICI', 'NU', 'TRV', 'CMA', 'COF', 'CME', 'AMP', 'WELL', 'AVB', 'RF', 'WTW', 'KKR', 'SBAC', 'ZION', 'EXR', 'PRU', 'WY', 'HBAN', 'NTRS', 'XP', 'AFL', 'FHN', 'TROW', 'LPLA', 'BK', 'VTR', 'MPW', 'BRO', 'ARE', 'BNS', 'CG', 'FITB', 'NVR', 'Z', 'ACGL', 'WAL', 'BXP', 'AGNC', 'PEAK', 'STT', 'SYF', 'FCNCA', 'NYCB', 'EQR', 'HST', 'RE', 'HSBC', 'NLY', 'VNO', 'IRM', 'WPC', 'BCS', 'APLD', 'MKTX', 'ITUB', 'PFG', 'ALLY', 'PACW', 'INVH', 'LNC', 'UDR', 'RNR', 'HUT', 'RJF', 'CPT', 'MORN', 'CINF', 'KIM', 'TS', 'SLG', 'SUI', 'ARCC', 'ESS', 'KBH', 'HIG', 'ARES', 'VIPS', 'BOH', 'MEOA', 'TD', 'KNSL', 'WRB', 'IBKR', 'MAA', 'BTBT', 'UNM', 'RPRX', 'SCRM', 'AEL', 'CBOE', 'IVZ', 'ABR', 'MKL', 'BN', 'AMH', 'UBS', 'OUT', 'AFG', 'CUBE', 'BEN', 'OHI', 'WTFC', 'BBD', 'REXR', 'ELS', 'EWBC', 'SNV', 'ADC', 'DB', 'TW', 'WBS', 'CBSH', 'LAMR', 'TRTN', 'NNN', 'OZK', 'CFR', 'STWD', 'GLPI', 'LSI', 'STAG', 'GL', 'TPL', 'REG', 'FR', 'RGA', 'HR', 'EGP', 'PNFP', 'FRT', 'PK', 'PB', 'FHI', 'BMO', 'HRI', 'TRUP', 'BXMT', 'VLY', 'COLB', 'BRX', 'TOP', 'AER', 'L', 'ING', 'JEF', 'BFH', 'EQH', 'KRC', 'RHP', 'AIZ', 'SSB', 'JBGS', 'RITM', 'RDN', 'COLD', 'DEI', 'MC', 'EFC', 'LMND', 'CADE', 'SIGI', 'ORI', 'UBSI', 'EVR', 'CUZ', 'HIW', 'HPP', 'SF', 'FNF', 'MFC', 'KRG', 'HLI', 'PFLT', 'BAM', 'BOKF', 'BNL', 'BDN', 'AMG', 'MAIN', 'FTAI', 'DOC', 'OWL', 'RY', 'ERIE', 'MTG', 'RLI', 'CVBF', 'IREN', 'RYAN', 'NSA', 'PRI', 'VOYA', 'ARR', 'AL', 'FNB', 'SRC', 'GBCI', 'FOCS', 'AGO', 'BITF', 'PECO', 'ORCC', 'PEB', 'AIRC', 'MDC', 'FAF', 'TCBI', 'EPR', 'WULF', 'IRT', 'LAZ', 'CM', 'JHG', 'MUFG', 'EPRT', 'IIPR', 'OMF', 'HOMB', 'CRBG', 'HASI', 'GNL', 'FIBK', 'GNW', 'BAP', 'RLJ', 'FCFS', 'DBRG', 'SHO', 'ONB', 'SMFG', 'BKU', 'APLE', 'SEIC', 'BPOP', 'ESNT', 'QFIN', 'EQC', 'UMBF', 'SITC', 'GATX', 'APAM', 'OCSL', 'SLM', 'KMPR', 'ZG', 'RKT', 'DRH', 'SBRA', 'NTST', 'BHF', 'PFSI', 'AX', 'TWO', 'ASB', 'HWC', 'CBU', 'NAVI', 'GGAL', 'CIM', 'HIVE', 'COOP', 'UCBI', 'CNO', 'ARGO', 'PDM', 'MAC', 'SKT', 'UNIT', 'OXLC', 'AXS', 'JXN', 'CATY', 'GEO', 'RELY', 'FSK', 'LU', 'THG', 'WD', 'FRME', 'VIRT', 'FRHC', 'NWG', 'AIV', 'HTGC', 'LXP', 'PCH', 'FFIN', 'CTRE', 'LEN.B', 'CASH', 'PUK', 'LYG', 'UHAL.B', 'RYN', 'HLNE', 'INDB', 'DHC', 'PIPR', 'PRG', 'TPG', 'ARI', 'PJT', 'FBP', 'NMFC', 'UMH', 'GTY', 'SAFE', 'TRIN', 'RC', 'UHAL', 'CIFR', 'AJX', 'IBTX', 'TBBK', 'ELME', 'OFC', 'IVR', 'SFBS', 'STEP', 'XHR', 'UE', 'TFIN', 'DX', 'ESRT', 'CIB', 'PFS', 'WAFD', 'FHB', 'SAN', 'HE', 'AUB', 'CLOV', 'PPBI', 'SLF', 'ROIC', 'IDEX', 'ABCB', 'MGEE', 'GSL', 'EGBN', 'BSBR', 'ATHM', 'VRTS', 'PGRE', 'LC', 'LADR', 'ORC', 'CLBR', 'RTL', 'VRE', 'AMBC', 'AKR', 'FACT', 'VCTR', 'ACT', 'AAT', 'FULT', 'ROOT', 'SBCF', 'FCPT', 'ENVA', 'MFA', 'APCA', 'PRAA', 'WTM', 'BANR', 'KB', 'EBC', 'CNA', 'NMIH', 'NTB', 'IBOC', 'PFBC', 'OSCR', 'LKFN', 'PSEC', 'WSFS', 'EVRI', 'CRVL', 'NHI', 'CUBI', 'PLYM', 'GREE', 'AVTA', 'GBDC', 'MGRC', 'CSWC', 'GSBD', 'INN', 'BBVA', 'MCB', 'TGH', 'BMA', 'DFH', 'UBA', 'RWT', 'FINV', 'ILPT', 'SFNC', 'PMT', 'ACRE', 'SKWD', 'LTC', 'OPI', 'ACRO', 'WT', 'CCAP', 'CNS', 'UWMC', 'ALX', 'HOPE', 'HTH', 'AEG', 'TSLX', 'ECC', 'NWBI', 'RILY', 'ECPG', 'PRA', 'GSHD', 'NXRT', 'FG', 'DFIN', 'PLMR', 'WSBC', 'VBTX', 'CHCO', 'BUR', 'SVC', 'FCF', 'BRP', 'HMN', 'LOB', 'EFSC', 'TIO', 'AMK', 'TRMK', 'IVT', 'STC', 'NRDS', 'OFG', 'CNNE', 'AGM', 'BANF', 'SASR', 'SYBT', 'NBHC', 'HKD', 'RPT', 'TRST', 'RNST', 'TREE', 'ALPA', 'WABC', 'NYMT', 'PKST', 'NWLI', 'NBTB', 'ATSG', 'BSTZ', 'SDIG', 'FBNC', 'FPI', 'ESGR', 'EIG', 'HRZN', 'SHG', 'FBK', 'BHLB', 'BANC', 'BBAR', 'HTLF', 'SLQT', 'BRSP', 'CHMI', 'BLX', 'CTO', 'FBRT', 'PNNT', 'SNEX', 'MCY', 'EHTH', 'TFSL', 'HAFC', 'EZPW', 'BSAC', 'BKKT', 'CHCT', 'FFBC', 'IMXI', 'SJT', 'JRVR', 'HCI', 'AMRK', 'CXW', 'GDOT', 'CIO', 'CFFN', 'PRK', 'ONL', 'OCFC', 'IX', 'GOOD', 'TPVG', 'BCAT', 'BRKL', 'CSR', 'CNOB', 'KREF', 'AHH', 'STEL', 'AAN', 'SBR', 'MBI', 'HFWA', 'CODI', 'TOWN', 'BUSE', 'GMRE', 'SRG', 'ALCC', 'PRLH', 'STBA', 'FBMS', 'QD', 'BHG', 'AHT', 'ECAT', 'MFG', 'WDH', 'SPNT', 'SAFT', 'HMST', 'BOC', 'SLRC', 'PBT', 'WASH', 'TCPC', 'NEWT', 'NFBK', 'AGBA', 'HBNC', 'CTBI', 'DCOM', 'GPMT', 'MFIC', 'LBAI', 'CMTG', 'PFC', 'UVE', 'OLP', 'CDAQ', 'CLDT', 'NNI', 'SHBI', 'TCBK', 'PSTL', 'CLBK', 'BTCM', 'UHT', 'CASS', 'BSIG', 'CGBD', 'SBSI', 'UVSP', 'PAX', 'BCH', 'WSR', 'TMP', 'ERES', 'HTBK', 'LAND', 'GAIN', 'NIC', 'ATAQ', 'NMR', 'GLAD', 'NXDT', 'DMLP', 'FRGE', 'BCSF', 'EVER', 'ISTR', 'CCB', 'SRCE', 'BBDC', 'WRLD', 'OSBC', 'TIGR', 'ASCB', 'CATC', 'INBK', 'DHIL', 'PEBO', 'GABC', 'AFCG', 'CAC', 'AMAL', 'PINE', 'AMSF', 'HT', 'AAIC', 'CBL', 'CPF', 'QCRH', 'DWAC', 'FFWM', 'PX', 'FMNB', 'UFCS', 'GLTA', 'KFS', 'EVE', 'TRTX', 'AAMC', 'SUPV', 'RIV', 'SAR', 'MBIN', 'KRNY', 'JFIN', 'FCBC', 'MSBI', 'AMTB', 'OPY', 'FTF', 'AAC', 'PLAO', 'FFIC', 'SCM', 'OXSQ', 'CION', 'REFI', 'BMRC', 'BRDG', 'NECB', 'HGTY', 'PGC', 'HONE', 'BHRB', 'RWAY', 'NRIM', 'BSVN', 'AROW', 'HIFS', 'STHO', 'BFS', 'MBWM', 'GOCO', 'CFFS', 'NSTC', 'HPLT', 'BY', 'ARBK', 'RACY', 'HIPO', 'LIVB', 'GSBC', 'CRD.A', 'FISI', 'WF', 'FLIC', 'ESQ', 'MRCC', 'WHF', 'VCXB', 'FDUS', 'BFC', 'SII', 'IFS', 'BFST', 'MTAL', 'CCNE', 'OCN', 'SMBC', 'BRT', 'FSP', 'EVBN', 'OPRT', 'MPB', 'GCMG', 'BHR', 'MEGL', 'GROY', 'CZFS', 'CORS', 'LBBB', 'RBCAA', 'GHL', 'IIM', 'WSBF', 'SPFI', 'NBN', 'IBCP', 'TIPT', 'SACH', 'EQBK', 'THFF', 'RRAC', 'ALRS', 'VINP', 'PCB', 'ITIC', 'BHB', 'RM', 'CITE', 'UIHC', 'SNFCA', 'FMBH', 'HGBL', 'CPZ', 'CFB', 'LX', 'ATLO', 'LFAC', 'HBT', 'MFIN', 'EIC', 'SEVN', 'BYNO', 'BCML', 'WMC', 'BWFG', 'PDLB', 'PVBC', 'MHLD', 'ATLC', 'ASPS', 'BWB', 'PTMN', 'MSSA', 'FLME', 'UBP', 'AOMR', 'BCSA', 'NWFL', 'BBUC', 'BBIG', 'FIAC', 'BLFY', 'NOAH', 'FVCB', 'BPRN', 'NKSH', 'GRNT', 'INTR', 'ML', 'NREF', 'BTCS', 'CIVB', 'ACNB', 'GLRE', 'MTR', 'ALTI', 'CCBG', 'MNSB', 'COFS', 'EARN', 'SMMF', 'VABK', 'MDWT', 'PWOD', 'DGICA', 'RBB', 'SSSS', 'GNTY', 'GAM', 'CARE', 'ADRT', 'BTB', 'FPAY', 'SFST', 'CFFI', 'PKBK', 'CLPR', 'CPAA', 'MVBF', 'HTBI', 'RMM', 'PFMT', 'FSBW', 'LGHL', 'HWBK', 'BTOG', 'BKCC', 'AULT', 'MIGI', 'EBMT', 'OCCI', 'BSRR', 'CHMG', 'FRST', 'BCBP', 'HBCP', 'JGGC', 'CZNC', 'UNTY', 'GGT', 'NETC', 'FANH', 'TSBK', 'MSB', 'LCNB', 'BWAQ', 'MITT', 'CVLY', 'SLAM', 'MOFG', 'LDI', 'ARRW', 'HCVI', 'GECC', 'YRD', 'AMTD', 'DMF', 'RCFA', 'WTBA', 'AFAR', 'FDBC', 'MCVT', 'OFS', 'FNLC', 'BTDR', 'FGBI', 'FSBC', 'SOS', 'SSBK', 'EBTC', 'BSAQ', 'DXF', 'FMAO', 'CVCY', 'SBFG', 'BHM', 'CBAN', 'FEXD', 'FLFV', 'ORRF', 'LOAN', 'FRBN', 'FRBA', 'CRD.B', 'OBT', 'ARTE', 'SWSS', 'WAVS', 'CALB', 'HRTG', 'FORL', 'TURN', 'PTRS', 'FRBK', 'RRBI', 'IGIC', 'GHIX', 'SAMG', 'BFIN', 'ISRL', 'MATH', 'OVLY', 'SMBK', 'TRIS', 'MBCN', 'FGMC', 'OTEC', 'PLBC', 'DGHI', 'BWC', 'AIB', 'IPVF', 'TROO', 'PUYI', 'SELF', 'MCBS', 'MYFW', 'VII', 'PMGM', 'ATEK', 'FBIZ', 'CSTR', 'CPSS', 'GCBC', 'VEL', 'RVSB', 'CURO', 'MDV', 'SCU', 'FCCO', 'AUBN', 'PUCK', 'ESSA', 'WLFC', 'FOA', 'PFIS', 'ROSE', 'JMSB', 'HYW', 'APMI', 'MCBC', 'RWOD', 'TCI', 'LBC', 'PRSR', 'MLVF', 'GATE', 'HUDA', 'RBKB', 'ADER', 'EFSH', 'XYF', 'FUSB', 'RELI', 'ONFO', 'GROW', 'OPOF', 'BTWN', 'LCAA', 'FSFG', 'MCAC', 'GOGN', 'GSD', 'LNKB', 'BNRE', 'TCBX', 'AMNB', 'CNGL', 'CHAA', 'HMA', 'NICK', 'CLAY', 'CPUH', 'ADEX', 'BLNG', 'TBNK', 'AC', 'CBNK', 'FRAF', 'KCGI', 'IRRX', 'VBNK', 'KPLT', 'FUNC', 'CLST', 'ACR', 'CBFV', 'LRFC', 'SQFT', 'HMAC', 'ICMB', 'BRBS', 'GEG', 'OPFI', 'BMAC', 'CIA', 'SIEB', 'VSAC', 'EGGF', 'GFOR', 'HALL', 'AQU', 'FCAP', 'LFT', 'OPBK', 'ROCL', 'OSI', 'MBAC', 'SNTG', 'NBST', 'CMCT', 'DMAQ', 'AVAL', 'BBDO', 'RSF', 'SUNL', 'BFAC', 'EDTX', 'CZWI', 'CNF', 'NCPL', 'RHE', 'PBFS', 'GLLI', 'BRKH', 'ANZU', 'COHN', 'HMPT', 'PBAX', 'USCT', 'SEDA', 'HMNF', 'ASRV', 'CARV', 'IVCB', 'NODK', 'OZ', 'PEBK', 'GBLI', 'SWKH', 'SOHO', 'VMCA', 'TCOA', 'CHN', 'CVII', 'DUET', 'DMYY', 'BIOS', 'QOMO', 'AFBI', 'ATAK', 'BRLI', 'GIPR', 'GLST', 'JT', 'MRBK', 'FNCB', 'ARYE', 'ASCA', 'IGTA', 'SFBC', 'SHFS', 'UBFO', 'ECBK', 'CORR', 'CIZN', 'AACT', 'HUIZ', 'MOGO', 'THCP', 'SBT', 'TIRX', 'UTAA', 'TWOA', 'WEL', 'WNEB', 'QFTA', 'PNBK', 'HNRA', 'AINC', 'DAVE', 'FNWD', 'IHT', 'KYCH', 'SKGR', 'PW', 'DALS', 'AVHI', 'BANX', 'RENE', 'LGST', 'GFX', 'USCB', 'FGF', 'CXAC', 'APGB', 'CCV', 'NSTB', 'NXTP', 'OPHC', 'PEGR', 'OVBC', 'OXAC', 'GGAA', 'LIFW', 'MARX', 'ITAQ', 'FNWB', 'FINW', 'WHG', 'DTOC', 'CSLM', 'KVSA', 'GDNR', 'MDRR', 'MSVB', 'PORT', 'KINS', 'ITCL', 'PLMI', 'PFTA', 'OPA', 'BYFC', 'AIHS', 'AMAO', 'ALSA', 'CUEN', 'FSRX', 'FSEA', 'FATP', 'KNSW', 'GHLD', 'WWAC', 'VHAQ', 'UBCP', 'UNB', 'TMKR', 'LMFA', 'LARK', 'MGLD', 'CONX', 'DOMH', 'BREZ', 'BCOW', 'RGT', 'MAQC', 'GBNY', 'ICCH', 'HHLA', 'VBOC', 'ZING', 'SFE', 'TGVC', 'STRW', 'LSBK', 'MOBV', 'OFED', 'BOTJ', 'CFIV', 'DPCS', 'DIST', 'CWBC', 'CLOE', 'COOL', 'DHAC', 'GAQ', 'BSBK', 'BRD', 'BITE', 'AFTR', 'BAFN', 'ATMV', 'MGYR', 'MURF', 'JFU', 'HFBL', 'SLAC', 'VCXA', 'VBFC', 'SSBI', 'SLVR', 'HNNA', 'LSAK', 'RMBI', 'BNIX', 'CFBK', 'FZT', 'FRXB', 'ESBA', 'DHCA', 'CULL', 'BKSC', 'BLAC', 'BOAC', 'AOGO', 'ACAQ', 'PIAI', 'PNAC', 'OXBR', 'MACA', 'HSPO', 'IMAQ', 'TETE', 'TCBC', 'SAL', 'WHLR', 'WMPN', 'WINV', 'VERY', 'TWCB', 'HNVR', 'GLBZ', 'MBSC', 'MCAG', 'PFX', 'MTAC', 'NFNT', 'AAME', 'ACBA', 'AGAC', 'APTM', 'BYN', 'EVGR', 'FFNW', 'FXNC', 'FICV', 'FNVT', 'FMIV', 'FGH', 'CNDA', 'CFSB', 'BYTS', 'CCVI', 'CETU', 'CBRG', 'BOCN', 'BRAC', 'BLUA', 'ARYD', 'ATMC', 'AGM.A', 'ALOR', 'ADOC', 'AEAE', 'ACAB', 'NFYS', 'MTRY', 'MITA', 'MNTN', 'OHAA', 'NUBI', 'NVAC', 'PGSS', 'PHYT', 'PPHP', 'PPYA', 'PLTN', 'PACI', 'PBBK', 'PCCT', 'RCAC', 'RCLF', 'RAND', 'MCAF', 'LCW', 'LOCC', 'LIBY', 'IROQ', 'IOR', 'INTE', 'KRNL', 'JWSM', 'GIA', 'GFGD', 'GBBK', 'GYRO', 'GPAC', 'ICNC', 'UPTD', 'TLGY', 'TRTL', 'TRON', 'WAVC', 'WNNR', 'WTMA', 'SAGA', 'SBXC', 'ROSS', 'SGII', 'TBCP', 'SUAC', 'SVII', 'TENK', 'TCBS', 'SRL', 'SSIC', 'SMAP', 'TGAA', 'SVVC', 'TBMC', 'SZZL', 'SHAP', 'SEPA', 'SDAC', 'SHUA', 'SCAQ', 'SAMA', 'XFIN', 'YOTA', 'XPAX', 'XPDB', 'WRAC', 'VHNA', 'TMTC', 'TRCA', 'TLGA', 'VAQC', 'TWLV', 'INAQ', 'IFIN', 'HWEL', 'HWKZ', 'HHGC', 'GTAC', 'HAIA', 'HCMA', 'GDST', 'GENQ', 'GMFI', 'JUN', 'KACL', 'KFFB', 'IOAC', 'IRAA', 'IXAQ', 'JAQC', 'IVCA', 'IVCP', 'LGVC', 'LHC', 'LCA', 'LATG', 'MCAA', 'MBTC', 'QDRO', 'PWUP', 'PROV', 'PRPC', 'PTWO', 'PTHR', 'RFAC', 'RMGC', 'PBHC', 'PEPL', 'OXUS', 'NSTD', 'NSTS', 'NOVV', 'NPAB', 'NRAC', 'OLIT', 'OCAX', 'OAKU', 'ONYX', 'MPRA', 'NCAC', 'ACAC', 'ACAH', 'ACAX', 'AACI', 'ALTU', 'AURC', 'ASPA', 'ATIF', 'BACA', 'ARBG', 'ARIZ', 'APXI', 'APAC', 'BLEU', 'BHAC', 'CCAI', 'CCTS', 'CFFE', 'BWAC', 'CHEA', 'CMCA', 'CLRC', 'CLIN', 'CNDB', 'CNFR', 'CREC', 'CPTK', 'CSTA', 'DECA', 'DISA', 'DGICB', 'DKDCA', 'DSAQ', 'DUNE', 'EAC', 'ESAC', 'EFHT', 'EMCG', 'EMLD', 'ENCP', 'ENER', 'ENTF', 'FHLT', 'FLAG', 'FWAC', 'GAMC', 'FTII', 'FSNB', 'FRLA'], '百貨通路': ['AMZN', 'TGT', 'COST', 'HD', 'WMT', 'LOW', 'CVS', 'ULTA', 'RH', 'WBA', 'DG', 'DLTR', 'TSCO', 'ROST', 'M', 'SYY', 'KR', 'WSM', 'KSS', 'JWN', 'BJ', 'FIVE', 'NUS', 'OLLI', 'CASY', 'ACI', 'FMX', 'SFM', 'MUSA', 'RBA', 'DDS', 'USFD', 'SITE', 'GO', 'FRG', 'UNFI', 'DK', 'MNSO', 'BIG', 'HLF', 'SBH', 'QRTEA', 'IMKTA', 'PSMT', 'CHEF', 'WMK', 'SPTN', 'HLMN', 'CENTA', 'BNED', 'RAD', 'ASAI', 'WINA', 'CBD', 'FLWS', 'UGP', 'GRWG', 'AAN', 'HVT', 'BRCC', 'APRN', 'IMBI', 'CENT', 'ARKO', 'TCS', 'DIT', 'VLGEA', 'DSS', 'BSET', 'BWMX', 'NGVC', 'NATR', 'GDC', 'DSGR', 'JOAN', 'GNLN', 'NHTC', 'KIRK', 'LFVN', 'XWEL', 'QRTEB', 'IPW', 'GLG', 'MTEX', 'WILC', 'HVT.A'], '公用事業': ['XOM', 'COST', 'GE', 'NEE', 'MPC', 'BP', 'ETR', 'SO', 'ECL', 'AEP', 'DUK', 'WMB', 'PCG', 'EXC', 'D', 'DD', 'CLX', 'XEL', 'XYL', 'DTE', 'AWK', 'ES', 'PPL', 'CMS', 'ED', 'NRG', 'BJ', 'WEC', 'PEG', 'CNP', 'EIX', 'AES', 'FE', 'AEE', 'CASY', 'SRE', 'LNT', 'NI', 'TTE', 'VST', 'DINO', 'EVRG', 'PNW', 'PNR', 'MUSA', 'POR', 'UGI', 'MDU', 'NGG', 'OGE', 'WTRG', 'ORA', 'YPF', 'IDA', 'AQN', 'ETRN', 'AM', 'STRL', 'WWD', 'AVA', 'AWR', 'AGR', 'ERII', 'BKH', 'PNM', 'CWT', 'OTTR', 'ABM', 'ALE', 'ENIC', 'NWE', 'SBS', 'AY', 'HE', 'MGEE', 'SJW', 'FTS', 'CIG', 'WKC', 'EBR', 'PAM', 'MSEX', 'CWCO', 'SPH', 'UGP', 'SP', 'CEPU', 'ARIS', 'GNE', 'ELP', 'GLP', 'KEP', 'TAC', 'ARTNA', 'UTL', 'BANL', 'ARKO', 'YORW', 'CDZI', 'EDN', 'NVVE', 'MLP', 'VIA', 'KEN', 'SPRU', 'GWRS', 'PCYO', 'CLWT', 'EZFL', 'NEPH', 'AENZ'], '控股': ['BABA', 'EXC', 'EIX', 'VST', 'RGA', 'L', 'FLR', 'FRG', 'HE', 'FTS', 'MATW', 'TIO', 'CODI', 'BOC', 'VINO', 'ARKO', 'VATE', 'LIVE', 'AULT', 'KEN', 'STRR', 'GDC', 'BNMV', 'GEG', 'PDEX', 'AEI', 'NL', 'AUVI', 'LTRPB', 'MGLD', 'FGH'], '生技醫療保健': ['AMZN', 'GOOG', 'AZN', 'LLY', 'BABA', 'UNH', 'JNJ', 'PG', 'PFE', 'COST', 'ABBV', 'ELV', 'AMGN', 'MRK', 'TMO', 'BMY', 'DHR', 'HCA', 'ISRG', 'GILD', 'HUM', 'REGN', 'CVS', 'ABT', 'VRTX', 'MDT', 'MRNA', 'LH', 'WBA', 'IBM', 'CI', 'PTGX', 'SYK', 'MCK', 'ALGN', 'MMM', 'BSX', 'ABC', 'EW', 'BDX', 'DXCM', 'ICLR', 'BMRN', 'ROP', 'KMB', 'IDXX', 'NVO', 'VTYX', 'ZTS', 'CHD', 'A', 'BIIB', 'ADM', 'NVS', 'RMD', 'IQV', 'CAH', 'BAX', 'ISEE', 'ZBH', 'PEN', 'CNC', 'ILMN', 'MTD', 'DD', 'SGEN', 'GEHC', 'GSK', 'VEEV', 'SWAV', 'PODD', 'AHI', 'BTAI', 'STE', 'MOH', 'CTLT', 'DGX', 'TECH', 'EXAS', 'WAT', 'AXSM', 'HOLX', 'TGTX', 'APLS', 'WST', 'SRPT', 'ARGX', 'NUS', 'TDOC', 'THC', 'SNY', 'UL', 'COO', 'INSP', 'JAZZ', 'RGEN', 'ALNY', 'MDGL', 'AVY', 'RVTY', 'HZNP', 'HSIC', 'SNN', 'BIO', 'UTHR', 'VTRS', 'HALO', 'CRL', 'UHS', 'ALC', 'MEDP', 'ACAD', 'BNTX', 'LNTH', 'INCY', 'CBAY', 'DVA', 'AVTR', 'DICE', 'CRSP', 'MASI', 'RPRX', 'SYNH', 'TEVA', 'KRTX', 'SDGR', 'MRTX', 'BGNE', 'OPCH', 'ENSC', 'WW', 'NBIX', 'AMED', 'XRAY', 'HLN', 'IMGN', 'RETA', 'MLTX', 'VKTX', 'NTRA', 'NVST', 'TFX', 'GMED', 'ABCM', 'NEOG', 'OGN', 'ELAN', 'NARI', 'GTLS', 'QGEN', 'ALKS', 'BPMC', 'CNMD', 'ARWR', 'HIMS', 'HELE', 'AGL', 'RCM', 'TXG', 'BRKR', 'SGRY', 'NTLA', 'PACB', 'DOCS', 'CHE', 'PDCO', 'ROIV', 'SAGE', 'EXEL', 'AMPH', 'NVCR', 'EHC', 'AKRO', 'IONS', 'GH', 'ASND', 'DNA', 'QDEL', 'ITCI', 'AVDL', 'LEGN', 'NVAX', 'GKOS', 'CPRX', 'TNDM', 'INMD', 'BBIO', 'PRFX', 'MED', 'AXNX', 'EVH', 'KDNY', 'BFAM', 'ICUI', 'ACHC', 'ETNB', 'RVNC', 'TMDX', 'PTCT', 'PRGO', 'PGNY', 'SQZ', 'TAK', 'SHC', 'EMBC', 'PRVA', 'TWST', 'SILK', 'PHG', 'AUPH', 'MORF', 'HAE', 'RARE', 'BHC', 'RVMD', 'MDRX', 'IOVA', 'CLDX', 'CYTK', 'PCVX', 'IART', 'IRWD', 'IRTC', 'ENOV', 'DVAX', 'CHRS', 'SNDX', 'INSM', 'AZTA', 'BEAM', 'STAA', 'PRCT', 'RMTI', 'VRDN', 'KRYS', 'NVRO', 'HQY', 'IMVT', 'ATEC', 'BMEA', 'PRTA', 'RDNT', 'ARDX', 'GMAB', 'OSIS', 'HROW', 'SWTX', 'VCYT', 'NNOX', 'SAVA', 'SLRN', 'HLF', 'ENSG', 'RCUS', 'MMSI', 'FIGS', 'RDY', 'AMLX', 'BHVN', 'FOLD', 'MRVI', 'BCRX', 'ACLX', 'VIR', 'RMED', 'ARCT', 'CERT', 'REPL', 'BLCO', 'DNLI', 'IRON', 'PLRX', 'SUZ', 'ZLAB', 'ABCL', 'OMCL', 'ZNTL', 'PHR', 'BDTX', 'AHCO', 'LIVN', 'BXRX', 'RYTM', 'BNGO', 'OPK', 'SIBN', 'QTRX', 'VRNA', 'SEM', 'MCRB', 'ALDX', 'NUVA', 'CERE', 'TVTX', 'ARQT', 'GERN', 'GPCR', 'ACET', 'XENE', 'IDYA', 'NUVL', 'ADUS', 'VBIV', 'EDIT', 'BACK', 'AGIO', 'RLAY', 'RXRX', 'MYGN', 'ANIP', 'FGEN', 'MD', 'ICPT', 'EBS', 'ONCY', 'MNKD', 'PINC', 'AGEN', 'ACCD', 'RNLX', 'NEO', 'FMS', 'KYMR', 'VCEL', 'TMCI', 'CORT', 'HRMY', 'VERV', 'RCKT', 'VERA', 'CDMO', 'CLOV', 'TERN', 'PCRX', 'BLUE', 'EHAB', 'MIRM', 'ESTA', 'QURE', 'IMCR', 'VECT', 'ARVN', 'INBX', 'PBH', 'OM', 'DAWN', 'AVXL', 'USPH', 'SUPN', 'ALLO', 'RNA', 'CYH', 'BCPC', 'ALVO', 'ASRT', 'MRNS', 'OMI', 'KPTI', 'MERC', 'IMUX', 'CABA', 'CRVL', 'LFST', 'RXST', 'CUTR', 'ATRC', 'NVTA', 'MATV', 'ITGR', 'KNSA', 'FATE', 'PETS', 'MDXG', 'PNT', 'LMAT', 'BLFS', 'CTKB', 'PLX', 'TSVT', 'KURA', 'CMP', 'ICVX', 'TBPH', 'CRMD', 'FLGT', 'SLP', 'FDMT', 'CANO', 'MYO', 'GNFT', 'EYPT', 'VYGR', 'SENS', 'RAD', 'XXII', 'LFMD', 'DYN', 'CARA', 'RGNX', 'KROS', 'MRSN', 'BCYC', 'CVAC', 'GLPG', 'ADPT', 'MODV', 'AMTX', 'OCUL', 'COGT', 'MLYS', 'MRUS', 'TCMD', 'RAPT', 'SCPH', 'CRNX', 'AMRS', 'IMTX', 'LXRX', 'APYX', 'AMAM', 'DH', 'XNCR', 'ADMA', 'ACRS', 'CYT', 'LQDA', 'DCGO', 'CCSI', 'IMNM', 'FNA', 'SANA', 'GRFS', 'PHAT', 'COLL', 'KIDS', 'NLSP', 'LFCR', 'DCPH', 'ENTA', 'AVNS', 'ALT', 'XFOR', 'INVA', 'HCAT', 'ALHC', 'OABI', 'OCGN', 'SPRY', 'CPSI', 'GDRX', 'IBRX', 'CRBU', 'CSTL', 'AMRX', 'EOLS', 'NRIX', 'INZY', 'MEDS', 'CYBN', 'AGLE', 'ZYXI', 'KODK', 'SMMT', 'LGND', 'VNDA', 'ANAB', 'CDNA', 'ZYME', 'RCEL', 'GRTX', 'SGMO', 'AMEH', 'ZIMV', 'USNA', 'NHC', 'ESPR', 'ALVR', 'SGTX', 'TNYA', 'NKTX', 'PDSB', 'AORT', 'PRME', 'MLAB', 'NSTG', 'BHG', 'INO', 'KOD', 'OFIX', 'TALS', 'XERS', 'INGN', 'NXGN', 'HWKN', 'ATAI', 'ITOS', 'CMAX', 'ALEC', 'XAIR', 'ATXS', 'MPLN', 'SRRK', 'LNZA', 'RPHM', 'HCM', 'GOSS', 'CTXR', 'EQRX', 'OSUR', 'ABEO', 'ALLK', 'AMWL', 'ARAY', 'BFLY', 'ZURA', 'AVIR', 'PMVP', 'ATOS', 'CMPS', 'EGRX', 'ANIK', 'CGEM', 'OMGA', 'BKD', 'TARS', 'TYRA', 'ME', 'PETQ', 'ALLR', 'OLMA', 'SRDX', 'ATRA', 'CERS', 'AGTI', 'PSTX', 'PBYI', 'ICAD', 'COSM', 'ELVN', 'MREO', 'PRTK', 'SCLX', 'GMDA', 'ZJYL', 'GRCL', 'DNMR', 'SLGC', 'SIGA', 'DERM', 'HUMA', 'RWLK', 'STOK', 'NOTV', 'SCYX', 'CMPX', 'RIGL', 'SVRA', 'ACIU', 'CTMX', 'EXAI', 'VXRT', 'CVRX', 'CARM', 'GLUE', 'OMER', 'ATRI', 'MBOT', 'URGN', 'MOR', 'NYMX', 'BCTX', 'JANX', 'LUNG', 'VMD', 'ABUS', 'OCUP', 'MTLS', 'EIGR', 'ORIC', 'PHVS', 'PNTG', 'MGNX', 'AMRN', 'VERU', 'OLK', 'DSGN', 'IGMS', 'FULC', 'LYEL', 'DMTK', 'VSTM', 'TRHC', 'STRO', 'CCCC', 'SIEN', 'HBIO', 'AIRS', 'NKTR', 'QSI', 'HRTX', 'OTLK', 'PGEN', 'ANGO', 'AVTE', 'HNST', 'TTOO', 'CDXS', 'PRAX', 'MNMD', 'NERV', 'FHTX', 'MACK', 'KALV', 'ANNX', 'YMAB', 'VRCA', 'BVS', 'EWTX', 'MXCT', 'IFRX', 'SEER', 'CUE', 'GTHX', 'SHCR', 'TCRX', 'CAE', 'THRX', 'KNTE', 'ABOS', 'SONN', 'GBIO', 'PAHC', 'AKBA', 'MASS', 'PROK', 'EVGN', 'BDRX', 'IMAB', 'APPH', 'TRDA', 'TELA', 'MIST', 'PIRS', 'IRMD', 'CLNN', 'OPRX', 'TARO', 'OCEA', 'NAUT', 'ATNM', 'AUGX', 'TNON', 'DMAC', 'IMMP', 'ARAV', 'ALPN', 'PIII', 'NGM', 'TNXP', 'GBNH', 'CBUS', 'WGS', 'RPTX', 'ERAS', 'WVE', 'JYNT', 'FWBI', 'CELC', 'AUTL', 'TALK', 'BIVI', 'NAVB', 'CMRX', 'KZR', 'AVTX', 'SELB', 'KTRA', 'HYPR', 'ZOM', 'ABSI', 'SHPH', 'MGTX', 'LIFE', 'IMMX', 'AADI', 'BIOX', 'GHRS', 'RAIN', 'ORGO', 'XOMA', 'MRKR', 'AKYA', 'QIPT', 'PLSE', 'BTMD', 'EVLO', 'SDC', 'PYXS', 'BLRX', 'SPPI', 'VBLT', 'UTMD', 'ALXO', 'INVO', 'LCTX', 'SURF', 'VIRI', 'MDWD', 'VRAY', 'LPTX', 'ORMP', 'PBLA', 'UNCY', 'RNXT', 'KRON', 'CELU', 'BIOL', 'HLVX', 'AQST', 'NUVB', 'BHIL', 'IMRX', 'CRVS', 'CMRA', 'GNPX', 'AVAH', 'HYFM', 'UBX', 'RBOT', 'NVCT', 'EFTR', 'MESO', 'NUTX', 'AFMD', 'CAPR', 'ASTC', 'GRTS', 'ELTX', 'ELEV', 'VOR', 'SEEL', 'ADVM', 'PHIO', 'RVPH', 'SMTI', 'BCAB', 'MYMD', 'AGFY', 'INAB', 'AXGN', 'NMRD', 'CNTG', 'AVRO', 'BTTX', 'ZVRA', 'CRDF', 'CDTX', 'ALIM', 'NTRB', 'ADAP', 'BFRI', 'GNLX', 'SMLR', 'XBIT', 'EYEN', 'LBPH', 'VTGN', 'CLPT', 'CVM', 'IVVD', 'SPRO', 'OBIO', 'NAMS', 'BOLT', 'TOVX', 'ANIX', 'AKTX', 'JAGX', 'POAI', 'CKPT', 'LRMR', 'CNTX', 'DSS', 'RSLS', 'ADCT', 'OPTN', 'ONTX', 'PSNL', 'FENC', 'STXS', 'IVA', 'BFRG', 'INFU', 'DARE', 'ASXC', 'PRQR', 'ANTX', 'BTCY', 'KRMD', 'HOOK', 'NVOS', 'FBIO', 'EDAP', 'APVO', 'CELL', 'HARP', 'TNGX', 'TCRT', 'ASMB', 'IKNA', 'INMB', 'TMBR', 'INKT', 'OVID', 'RLMD', 'SRTS', 'AQB', 'DTIL', 'LMDX', 'FUSN', 'RLYB', 'PRLD', 'STRR', 'SGHT', 'PASG', 'COYA', 'CGEN', 'VNRX', 'INFI', 'ASLN', 'HLTH', 'JSPR', 'CNTA', 'ATHA', 'LNSR', 'MBIO', 'AURA', 'CPHI', 'VIGL', 'NATR', 'PRPH', 'BCLI', 'MRAI', 'AGRX', 'ETON', 'DRIO', 'ACHL', 'IKT', 'LAB', 'PRE', 'LTRN', 'TIVC', 'VAXX', 'IPSC', 'TCBP', 'EPIX', 'ATIP', 'CFMS', 'YS', 'AIM', 'DBTX', 'DCTH', 'CNSP', 'GTBP', 'GHSI', 'PEPG', 'ADMP', 'FEMY', 'CWBR', 'CYTO', 'INNV', 'DRMA', 'KMDA', 'LYRA', 'KALA', 'BIOR', 'FIXX', 'LUMO', 'SLS', 'TIL', 'GLSI', 'COEP', 'CRIS', 'BNTC', 'ZVSA', 'MDXH', 'EVO', 'SYRS', 'MGRM', 'APTO', 'ENVB', 'CTSO', 'ACHV', 'SLN', 'OTRK', 'VIRX', 'SCTL', 'AZTR', 'DRRX', 'GANX', 'CATX', 'SLNO', 'ICCM', 'MGRX', 'MGTA', 'NAII', 'SPRB', 'SERA', 'OPGN', 'PALI', 'BWV', 'ANVS', 'TOI', 'TCON', 'TFFP', 'GRPH', 'LSTA', 'FNCH', 'WINT', 'CLGN', 'SOPH', 'JUPW', 'NBY', 'CFRX', 'APLT', 'BLPH', 'CLLS', 'NOVN', 'MNK', 'TRVI', 'TRVN', 'PAVM', 'PHGE', 'CING', 'ENOB', 'CBIO', 'AXDX', 'INDV', 'SXTC', 'LVTX', 'MBRX', 'MYNZ', 'STIM', 'ALGS', 'IBIO', 'NXTC', 'LGVN', 'RNAZ', 'YI', 'PROC', 'OCS', 'MTNB', 'ELOX', 'NDRA', 'PXMD', 'TPST', 'RANI', 'ARDS', 'BIOC', 'GRI', 'LIAN', 'SNTI', 'AGRI', 'GLYC', 'NUWE', 'ORTX', 'HEPA', 'CLSD', 'BNMV', 'CCEL', 'EQ', 'IOBT', 'BQ', 'ACER', 'TSHA', 'SYBX', 'XTNT', 'VINC', 'ELDN', 'STTK', 'SISI', 'ADXN', 'LFVN', 'VERO', 'TXMD', 'THRN', 'AEMD', 'DRTS', 'FRLN', 'HOTH', 'ELMD', 'RKDA', 'TARA', 'UTRS', 'REVB', 'SOBR', 'CGTX', 'HGEN', 'AGE', 'KTTA', 'NVNO', 'SVA', 'ACXP', 'BIMI', 'CELZ', 'VACC', 'VALN', 'AWH', 'BLTE', 'STRM', 'IGC', 'BNR', 'CALT', 'GDTC', 'ZYNE', 'FONR', 'GOVX', 'ENLV', 'DFFN', 'ATHX', 'SQL', 'OCX', 'CJJD', 'ENZ', 'CODX', 'ACOR', 'SNDA', 'ITRM', 'NCNA', 'XWEL', 'REUN', 'BSGM', 'HSCS', 'CMMB', 'BRTX', 'BPTH', 'BJDX', 'BBLG', 'APLM', 'THRD', 'UG', 'AYTU', 'GEG', 'GENE', 'RZLT', 'NRXP', 'NRBO', 'CSBR', 'UGRO', 'UPH', 'CRBP', 'AXLA', 'APT', 'PRPO', 'PDEX', 'SNCE', 'STSS', 'VRAX', 'CLVR', 'DBVT', 'ECOR', 'BEAT', 'SINT', 'PCSA', 'PPBT', 'NNVC', 'KPRX', 'KRBP', 'VAPO', 'MLSS', 'NXGL', 'HCTI', 'FRTX', 'CHEK', 'CDXC', 'ALZN', 'FORA', 'PSTV', 'SLRX', 'RPID', 'PTN', 'PRDS', 'PETV', 'ORGS', 'MTEM', 'LABP', 'IPA', 'NMTC', 'ONVO', 'CALC', 'BWAY', 'BDSX', 'ATNF', 'GLTO', 'QNRX', 'NEPT', 'INBS', 'LMNL', 'NBSE', 'NRSN', 'SLDB', 'HOWL', 'ACRV', 'TENX', 'SY', 'SWKH', 'THTX', 'APDN', 'BCDA', 'CLRB', 'NSPR', 'IMPL', 'EDSA', 'CADL', 'BYSI', 'CDIO', 'AMTI', 'ACRX', 'BCEL', 'CRDL', 'IMNN', 'MOLN', 'PROF', 'ICU', 'LIXT', 'EAR', 'AKLI', 'GRNA', 'LPCN', 'OMIC', 'ONCT', 'LSDI', 'LEXX', 'MNPR', 'CYCN', 'TTNP', 'VVOS', 'ZIVO', 'TKNO', 'DXR', 'MAIA', 'KA', 'SNGX', 'RGLS', 'HILS', 'EUDA', 'RDHL', 'RVP', 'SBFM', 'IMRN', 'NURO', 'NLTX', 'MNOV', 'PULM', 'CYTH', 'ARTL', 'CCLD', 'CNTB', 'COCP', 'EVAX', 'FREQ', 'PYPD', 'SLGL', 'MEIP', 'NVIV', 'KNW', 'YCBD', 'GALT', 'CEAD', 'ALRN', 'AFIB', 'FOXO', 'ETAO', 'HSDT', 'DLHC', 'PHAR', 'OGEN', 'OPT', 'VANI', 'IONM', 'LUCD', 'MOTS', 'NMTR', 'NHWK', 'SNSE', 'SRZN', 'CMND', 'ACST', 'AMPE', 'AMS', 'TBIO', 'THMO', 'XGN', 'ABIO', 'BVXV', 'AVGR', 'CYCC', 'DYAI', 'SILO', 'OKYO', 'SONX', 'MDGS', 'CANF', 'ALBT', 'TLSA', 'VYNE', 'AKU', 'ABVC', 'ATXI', 'DRUG', 'HUGE', 'MIRO', 'LIFW', 'RVLP', 'PMCB', 'PMD', 'QNCX', 'SNPX', 'BIAF', 'AIMD', 'VTVT', 'VRPX', 'XCUR', 'UPC', 'VCNX', 'ZTEK', 'GMVD', 'SABS', 'PRTG', 'INDP', 'MHUA', 'NPCE', 'MDNA', 'INM', 'OSA', 'SNOA', 'CPIX', 'AEZS', 'ACON', 'APM', 'BIO.B', 'BMRA', 'SNES', 'SPRC', 'LIPO', 'NBTX', 'NBRV', 'NEXI', 'MTEX', 'SSY', 'CASI', 'ADAG', 'ACGN', 'GCTK', 'EVOK', 'CVKD', 'DOMH', 'ADIL', 'ADTX', 'APRE', 'AZYO', 'RFL', 'NYXH', 'PTPI', 'IXHL', 'IRIX', 'ISPC', 'IPHA', 'LYT', 'BON', 'ENTX', 'GLMD', 'HSTO', 'ARMP', 'IMCC', 'IINN', 'JAN', 'QLGN', 'PLUR', 'XBIO', 'KZIA', 'ICCC', 'MLEC', 'AHG', 'ANEB', 'BNOX', 'HCWB', 'DYNT', 'NXL', 'SSKN', 'TLIS', 'SHLT', 'PTIX', 'NAOV', 'ELYM', 'CYAN', 'GTH', 'APGN', 'ATHE', 'AIH', 'BPTS', 'FRES', 'ERNA', 'FBRX', 'MODD', 'QLI', 'PAVS', 'RGC', 'TRIB', 'XLO', 'XRTX', 'XTLB', 'PRTC', 'PMN', 'NEPH', 'GNTA', 'CCM'], '初級產業': ['VALE', 'CTVA', 'RIO', 'BHP', 'MOS', 'WY', 'IP', 'UL', 'CGC', 'TLRY', 'DAR', 'CALM', 'EVA', 'SUZ', 'PCH', 'RYN', 'SLVM', 'GEF', 'BRFS', 'SNDL', 'MTX', 'DOLE', 'CRON', 'ACB', 'SLCA', 'AGRO', 'FDP', 'IAG', 'AVO', 'GRWG', 'IE', 'VITL', 'LMNR', 'CRESY', 'ALCO', 'GEF.B', 'EVGN', 'OGI', 'CDZI', 'SEED', 'NB', 'NCRA', 'TRC', 'VFF', 'BGXX', 'FLGC', 'LND', 'INCR', 'USGO', 'BCAN', 'SISI', 'SANW', 'LOCL', 'JEWL', 'EDBL', 'AKAN', 'AAU', 'FGH'], '航天軍工': ['TSLA', 'AMZN', 'GOOGL', 'GOOG', 'BA', 'HON', 'RTX', 'LMT', 'PH', 'NOC', 'GD', 'TDG', 'SPCE', 'AXON', 'LHX', 'BALL', 'HWM', 'TXT', 'TDY', 'CR', 'SPR', 'ITT', 'HEI', 'HXL', 'EH', 'CW', 'ACHR', 'RKLB', 'LILM', 'BWXT', 'CIR', 'WKHS', 'HEI.A', 'MRCY', 'WWD', 'AVAV', 'ERJ', 'AJRD', 'TGI', 'VSAT', 'MOG.A', 'GFF', 'KTOS', 'PSN', 'DRS', 'PL', 'ASLE', 'ESLT', 'SWBI', 'LLAP', 'B', 'RGR', 'DCO', 'BKSY', 'ATRO', 'EVTL', 'TRS', 'HAYN', 'VVX', 'KAMN', 'AMOT', 'CAE', 'POWW', 'LUNR', 'NPK', 'AZ', 'PKE', 'RDW', 'SPIR', 'AREB', 'TSAT', 'AOUT', 'ASTR', 'RCAT', 'UAVS', 'DPRO', 'SIDU', 'CAMP', 'TAYD', 'MNTS', 'CVU', 'BYRN', 'ESP', 'AWIN', 'OPXS', 'SYPR', 'COMS', 'SATL', 'MOB', 'ISSC', 'SIF', 'MOG.B'], '能源': ['BRK.A', 'XOM', 'BRK.B', 'CVX', 'GE', 'FCX', 'OXY', 'COP', 'DVN', 'VALE', 'SHEL', 'NEE', 'PXD', 'MPC', 'SLB', 'BP', 'VLO', 'ETR', 'SO', 'EOG', 'KMI', 'PBR', 'AEP', 'HAL', 'PSX', 'HES', 'LNG', 'DUK', 'LYB', 'MRO', 'EQT', 'CEG', 'WMB', 'BKR', 'PCG', 'EXC', 'D', 'BHP', 'FANG', 'XEL', 'CTRA', 'RIG', 'DTE', 'ES', 'OKE', 'PPL', 'CMS', 'SWN', 'ED', 'NRG', 'TRGP', 'WEC', 'OVV', 'APA', 'PBF', 'PEG', 'CLSK', 'AR', 'CNP', 'PDCE', 'NOV', 'EIX', 'AES', 'PBR.A', 'FE', 'ET', 'NE', 'AEE', 'SRE', 'EPD', 'CVE', 'LNT', 'TECK', 'NI', 'MUR', 'SU', 'ENB', 'CLH', 'EQNR', 'FTI', 'CHK', 'PTEN', 'BTU', 'CNQ', 'TTE', 'PR', 'CHX', 'VST', 'MTDR', 'DINO', 'ATO', 'SM', 'RRC', 'VAL', 'VVV', 'CHRD', 'CIVI', 'POR', 'UGI', 'TRP', 'CPE', 'HCC', 'HP', 'BE', 'MDU', 'NGG', 'OGE', 'CRK', 'PARR', 'L', 'WFRD', 'KOS', 'BWXT', 'AMR', 'ARCH', 'DO', 'PAA', 'MGY', 'CVI', 'XPRO', 'CRC', 'NEX', 'CEIX', 'ORA', 'YPF', 'IDA', 'VTLE', 'AQN', 'ETRN', 'NJR', 'AM', 'NOG', 'TALO', 'CNX', 'DTM', 'NBR', 'NFE', 'DEN', 'OGS', 'GLNG', 'NFG', 'SDRL', 'VNOM', 'AVA', 'DK', 'AGR', 'OII', 'SWX', 'CLB', 'BKH', 'IMO', 'SR', 'PNM', 'CWEN', 'WHD', 'EC', 'PBA', 'OTTR', 'SUZ', 'ERF', 'BEPC', 'VET', 'ESTE', 'TELL', 'VIST', 'ALE', 'GPOR', 'BTE', 'ENIC', 'NWE', 'HESM', 'CPG', 'RES', 'CLNE', 'NEXT', 'AY', 'HLX', 'MGEE', 'BIP', 'WDS', 'E', 'CPK', 'SMR', 'MERC', 'STR', 'FTS', 'CIG', 'TPIC', 'KNTK', 'PUMP', 'BEP', 'WKC', 'HPK', 'NWN', 'VTS', 'FLNG', 'CWEN.A', 'NINE', 'EBR', 'WES', 'SD', 'ARLP', 'OIS', 'BRY', 'PAM', 'SXC', 'ACDC', 'WTI', 'WTTR', 'SPH', 'SDIG', 'SSL', 'AMPS', 'UGP', 'TTI', 'SBOW', 'DRQ', 'EPM', 'METC', 'EGY', 'HNRG', 'RNW', 'SEB', 'CEPU', 'DNOW', 'MRC', 'HEP', 'REI', 'GNE', 'ELP', 'NR', 'CRGY', 'GLP', 'AMPY', 'EE', 'GTE', 'KEP', 'SOL', 'TAC', 'FF', 'UTL', 'BANL', 'NRP', 'RNGR', 'FET', 'ENLT', 'TGS', 'REPX', 'BW', 'NS', 'OBE', 'GPRK', 'TUSK', 'KLXE', 'WAVE', 'METCB', 'USAC', 'AMSC', 'LTBR', 'CEI', 'NVGS', 'PDS', 'TPET', 'GEL', 'GPP', 'SOI', 'SND', 'BWEN', 'AREC', 'EDN', 'NOA', 'NGS', 'CLMT', 'EPSN', 'VIA', 'PNRG', 'MTR', 'DKL', 'AZRE', 'SGU', 'TXO', 'OPAL', 'KEN', 'SPRU', 'RGCO', 'ALPS', 'SDPI', 'ICD', 'HUSA', 'NC', 'PFIE', 'PED', 'VVPR', 'BNMV', 'INDO', 'SAI', 'CETY', 'PHX', 'BRN', 'FTK', 'MIND', 'GIFI', 'EP', 'ESOA', 'ENSV', 'BATL', 'MXC', 'OPTT', 'PPIH', 'PATI', 'USEG', 'AE', 'GBR', 'EFXT', 'CREG', 'BNRG', 'SLNG', 'SMLP', 'HHRS', 'BROG', 'EZFL', 'DWSN', 'ELLO', 'NCSM', 'CHNR', 'AENZ'], '傳播出版': ['AMZN', 'GOOGL', 'GOOG', 'NFLX', 'BABA', 'DIS', 'YNDX', 'CMCSA', 'BIDU', 'MELI', 'JD', 'CHTR', 'WBD', 'PINS', 'TTD', 'SNAP', 'PARA', 'NTES', 'LYV', 'IPG', 'OMC', 'BILI', 'SIRI', 'FOXA', 'NXST', 'LBRDK', 'TRI', 'LBTYK', 'DISH', 'LSXMK', 'CABO', 'IQ', 'OUT', 'LAMR', 'WWE', 'NWSA', 'RELX', 'RHP', 'SSTK', 'LBTYA', 'WMG', 'NYT', 'LSXMA', 'BCE', 'EDR', 'MOMO', 'ATUS', 'TGNA', 'FOX', 'DNB', 'IAS', 'ZD', 'PERI', 'MGNI', 'MSGE', 'GHC', 'WLY', 'SPHR', 'IMAX', 'NWS', 'IHRT', 'SEAT', 'GTN', 'LBRDA', 'SBGI', 'HUYA', 'ATHM', 'MATW', 'WPP', 'RCI', 'ZH', 'THRY', 'TV', 'LILAK', 'LGF.B', 'LGF.A', 'DLX', 'TTGT', 'CDLX', 'STGW', 'AMCX', 'SCHL', 'PSO', 'FNKO', 'CRTO', 'TBLA', 'BOC', 'QNST', 'TOON', 'CNDT', 'CCO', 'EVC', 'PLBY', 'WOW', 'TRKA', 'SSP', 'TSQ', 'GCI', 'LILA', 'ADV', 'OB', 'DAO', 'BZUN', 'PARAA', 'GETY', 'DLPN', 'INUV', 'DSP', 'BCOV', 'SMWB', 'BZFD', 'DOYU', 'BAOS', 'CNVS', 'SOHU', 'WIMI', 'BBIG', 'CMLS', 'SGA', 'TRVG', 'SST', 'LIVE', 'TKAT', 'LCFY', 'UONE', 'HHS', 'UONEK', 'DJCO', 'NCMI', 'CSSE', 'CTV', 'ADTH', 'FLNT', 'AUUD', 'GTN.A', 'MOBQ', 'TRMR', 'AREN', 'MMV', 'IZEA', 'DRCT', 'EGLX', 'SCOR', 'RSVR', 'FENG', 'GAME', 'RCRT', 'ADD', 'ILLM', 'ISIG', 'YCBD', 'ICLK', 'DALN', 'CNET', 'SALM', 'SEAC', 'SWAG', 'NXTP', 'CPOP', 'KUKE', 'BBGI', 'WLYB', 'VALU', 'LYT', 'LEE', 'SGRP', 'EDUC', 'WHLM', 'ZCMD', 'KRKR', 'LSXMB', 'MDIA', 'LBTYB', 'SBIG', 'FGH'], '綜合': ['DSGR'], '傳產其他': ['AMZN', 'NKE', 'COST', 'ACN', 'MO', 'HON', 'PM', 'LULU', 'ADP', 'VRSK', 'JCI', 'SO', 'CROX', 'CTAS', 'ECL', 'AON', 'PAYX', 'CHD', 'WM', 'MCO', 'DECK', 'GWW', 'RL', 'POOL', 'DKS', 'VICI', 'ONON', 'IT', 'CLX', 'BTI', 'NTES', 'SKX', 'STE', 'PTON', 'WY', 'XP', 'BAH', 'MAT', 'OMC', 'RSG', 'IP', 'TPR', 'PENN', 'CRI', 'FL', 'EDU', 'ASO', 'SCI', 'HAS', 'TRU', 'BALL', 'VFC', 'DUOL', 'RS', 'CLH', 'ROL', 'AMCR', 'RHI', 'AMN', 'ARMK', 'CR', 'TRI', 'UAA', 'FWONK', 'TAL', 'CCK', 'FCN', 'CMC', 'BLD', 'CACI', 'CNXC', 'MSA', 'BOOT', 'MODG', 'HRB', 'CHDN', 'GTLS', 'NWL', 'BC', 'SPB', 'CLVT', 'LOPE', 'HXL', 'WNS', 'COLM', 'CHGG', 'LESL', 'MAN', 'TNET', 'MANU', 'SON', 'G', 'PCT', 'BOWL', 'SUM', 'BFAM', 'YETI', 'BZ', 'CNM', 'SSD', 'EDR', 'UA', 'EXLS', 'NCR', 'SLGN', 'SHOO', 'PLCE', 'OI', 'WOOF', 'BRC', 'CWST', 'IBP', 'WOR', 'LRN', 'MMS', 'GFL', 'BCO', 'CXT', 'ICFI', 'ALIT', 'EXPO', 'VMI', 'NSP', 'GOLF', 'ASGN', 'DBI', 'EYE', 'DNB', 'LAUR', 'CAL', 'VSTO', 'GIL', 'ABM', 'UPWK', 'GHC', 'WRBY', 'TNC', 'PYCR', 'WIT', 'STVN', 'RYI', 'RYN', 'EPC', 'ATGE', 'WWW', 'HI', 'LZ', 'KFY', 'VTNR', 'CCRN', 'CBZ', 'SBS', 'EB', 'UNF', 'GEF', 'HIBB', 'VRTV', 'SRCL', 'AIN', 'GCO', 'QRTEA', 'STRA', 'HURN', 'CSGS', 'SCVL', 'VGR', 'ZIP', 'FWONA', 'UVV', 'TPIC', 'MATW', 'DSEY', 'PRDO', 'COUR', 'MTX', 'CENTA', 'BNED', 'UDMY', 'XXII', 'ZUMZ', 'MTRN', 'SCHN', 'KFRC', 'LICY', 'RTO', 'GFAI', 'AMBP', 'MBUU', 'DLX', 'GOTU', 'CMPR', 'CSV', 'TWOU', 'FC', 'WINA', 'FA', 'HCSG', 'AZZ', 'AFYA', 'PSO', 'ROVR', 'KODK', 'RGP', 'BBW', 'MGOL', 'ACCO', 'BOOM', 'JAKK', 'TPB', 'HRT', 'CRAI', 'SPWH', 'CLEU', 'HCKT', 'NRDY', 'BATRK', 'VSEC', 'CASS', 'STER', 'BBSI', 'HCCI', 'DTC', 'MNTK', 'CDRE', 'CNDT', 'KELYA', 'TRS', 'ISPR', 'VEDU', 'HSTM', 'TLYS', 'TBI', 'MMAT', 'LOMA', 'MEC', 'CMT', 'INST', 'LXFR', 'EBF', 'BARK', 'CENT', 'CLAR', 'BGFV', 'HSII', 'HNST', 'COOK', 'QUAD', 'VCIG', 'NRC', 'ARCE', 'RCMT', 'DAO', 'BATRA', 'GEF.B', 'PIXY', 'PWP', 'JOUT', 'FORR', 'HQI', 'III', 'TCJH', 'PKE', 'GROV', 'ARC', 'UTI', 'BIRD', 'AREB', 'CNXA', 'LODE', 'SMWB', 'ACTG', 'SNFCA', 'MHH', 'TBLT', 'GNS', 'LAKE', 'NCTY', 'ACU', 'ESCA', 'AOUT', 'QRHC', 'DSS', 'SKIL', 'COE', 'AQMS', 'LINC', 'PESI', 'EJH', 'KULR', 'INPX', 'DHX', 'RCKY', 'HHS', 'VSTA', 'APEI', 'JOB', 'SOS', 'WRAP', 'MARK', 'QSG', 'GRNQ', 'MSGM', 'HITI', 'NLS', 'CRWS', 'OWLT', 'WEYS', 'GSUN', 'BQ', 'MGIH', 'VHI', 'RSSS', 'GB', 'TDCX', 'IPDN', 'QRTEB', 'PET', 'OMEX', 'RETO', 'TRNR', 'TPCS', 'VTRU', 'JZ', 'YJ', 'LICN', 'BAER', 'HSON', 'SY', 'YQ', 'BGSF', 'WAFU', 'GAME', 'RCRT', 'ADD', 'AMBI', 'STG', 'IH', 'LIQT', 'HPCO', 'MGAM', 'STAF', 'LXEH', 'DLHC', 'METX', 'TANH', 'CREG', 'BHAT', 'SECO', 'FORD', 'KUKE', 'CPHC', 'AGAE', 'MGLD', 'MDVL', 'GWAV', 'DOGZ', 'SSU', 'EEIQ', 'EDTK', 'FEDU', 'AIU', 'AWX', 'TEDU', 'ZCMD', 'BEDU', 'PYR', 'OCG', 'KRKR', 'AACG', 'DYNT', 'AMBO', 'TLF', 'GEHI', 'KELYB']}
print(all_type_pages.keys())
# all_type_pages


print("公用事業" + ":", len(all_type_pages["公用事業"]))




# import requests
from bs4 import BeautifulSoup as BS
from bs4 import NavigableString
import time
from dateutil import parser
from datetime import datetime
import re
import os
#from lxml import etree
import numpy as np
import pandas as pd

from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.chrome.options import Options  # 針對chrome的webdriver



import matplotlib.pyplot as plt
from matplotlib.ticker import MaxNLocator
from matplotlib.pyplot import MultipleLocator


# Multithreading
import threading
IS_ACTIVATE = True
stop_flag = threading.Event()

def update_msg(msg):
    
    if IS_ACTIVATE:
        if(re.search(r"Alert Text: DataTables warning: table id=filingsTable - Cannot reinitialise DataTable", msg)):
            msg = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。"
        elif(re.search(r"'NoneType' object has no attribute 'astype'", msg)):
            return None
            
        elif(re.search(r"\[Errno 13\] Permission denied:", msg)):
            msg = "Please close the related files then restart again." if IS_ENGLISH else "請關閉相關的檔案，然後再執行一次搜尋。"
            
        
        elif(re.search(r"element not interactable", msg)):
            msg = "No 10-K and 10-Q reports provided. Please try another company." if IS_ENGLISH else "無10-K與10-Q財報。請輸入其他公司。"
           
        # elif(re.search(r"", msg)):
            
        
        else:
            pass
        
        
    print(msg)





def get_source(target_stock, quarter_num, stop_flag = None):
    global msgs

    #print(quarter_num)
    
    try:
        # Process 1: Get financial statements from SEC.gov
        # Visit "EDGAR | Company Filings" of SEC.gov to search for a targeted company
        #print('Start connecting ...')
        update_msg("Start connecting ..." if IS_ENGLISH else "開始連線 ...")
        
        
        # Settings for chrome webdriver
        # User-agent交替使用
        #user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36"
        user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Edg/115.0.1901.188"
        opts = Options()
        #opts.add_argument("user-agent={}".format(user_agent)) 
        opts.add_argument("--user-agent=%s" % user_agent)
        # opts.add_argument('--disk-cache-dir=./mycache')
        #opts.add_argument("--headless")
        #opts.add_argument("--no-proxy-server")
        
        
        #browser = webdriver.Edge(r"msedgedriver.exe")    # Start webdriver.exe of Edge 
        browser = webdriver.Chrome(executable_path = r"chromedriver.exe", options=opts)  # Start webdriver.exe of Chrome
        
        
        #time.sleep(np.random.rand() + 2)    # Give 2.0 ~ 3.0 seconds for opening the webdriver.exe
        #WebDriverWait(browser, 10).until(lambda driver : driver is not None)
        WebDriverWait(browser, 2.0)
        #time.sleep(2.0)
        
        
        
       
        # Break point
        if(stop_flag.is_set()):
            return None

        
        url_search = "https://www.sec.gov/edgar/searchedgar/companysearch"

        browser.get(url_search)
        #time.sleep(np.random.rand() + 2) #@@ back to 2   # Give 2.0 ~ 3.0 seconds for loading web content from server
        # Max wait time: 100 sec; If web page laoded completely then continuing the procedure
        WebDriverWait(browser, 120).until(EC.presence_of_element_located((By.ID, "edgar-company-person")), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
        #time.sleep(2.0)
        print("Getting URL completed.")
        
        
        # Break point
        if(stop_flag.is_set()):
            return None

        # Find input element to enter the target stock abbreviation and press enter
        stock_input = browser.find_element(By.ID, "edgar-company-person")
        stock_input.send_keys(target_stock)
        
        
        #time.sleep(np.random.rand() + 3)   #@@ remember to change back to 3
        WebDriverWait(browser, 120).until(EC.visibility_of_element_located((By.CLASS_NAME, "smart-search-container")), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
        #time.sleep(2.0)
        
        
        # Max wait time: 100 sec; If web page laoded completely then continuing the procedure
        #WebDriverWait(browser, 100).until(lambda driver : driver.execute_script("return document.readyState") == "complete")
        print("Input abbr completed.")
        
        # Break point
        if(stop_flag.is_set()):
            return None

        stock_input.send_keys(Keys.ENTER)
        
        #time.sleep(np.random.rand() + 1)  #@@ remember to change back to 2   # Hold 2 ~ 3 seconds for loading content from server
        #WebDriverWait(browser, 30).until(EC.visibility_of_element_located((By.ID, "name")))
        
        # Max wait time: 100 sec; If web page laoded completely then continuing the procedure
        WebDriverWait(browser, 120).until(lambda driver : driver.execute_script("return document.readyState === 'complete';"), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。"
#         WebDriverWait(browser, 30).until(
#             lambda browser : browser.execute_script(
#                 """
#                 var result
                
#                     window.addEventListener('load', () => {
#                         result = 'OK'
#                     })
                
                
#                 return result
#             """) == "OK"
            #BS(browser.page_source, "html.parser").find('div', id='contentDiv') or
            #browser.find_element(By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/h5')  
            #EC.visibility_of_element_located((By.CLASS_NAME, "noCompanyMatch")) or
            #BS(browser.page_source, "html.parser").find('div', id='contentDiv') or
            #EC.visibility_of_element_located((By.ID, "name"))
        )
        print("Loading completed.")
        #time.sleep(np.random.rand() + 1)  #@@ back to 1  # Wait for 1 ~ 2 seconds
        #WebDriverWait(browser, 2.0)
        #time.sleep(2.0)
        
        # Break point
        if(stop_flag.is_set()):
            return None



        # # Find the submit button to search for the result
        # submit = browser.find_element(By.CLASS_NAME, "collapsed-submit")

        # # Input the stock abbr. and submit
        # stock_input.send_keys(target_stock)
        # submit.click()


        # Click "View all 10-Ks and 10-Qs" button
        # If no matching companies is showed, then prompt retry message
        WebDriverWait(browser, 3).until(lambda driver : driver.execute_script("return document.readyState === 'complete';"), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
        time.sleep(1 + np.random.rand())
        find_result_check = BS(browser.page_source, "html.parser").find('div', id='contentDiv')
        

        # if not re.search(r".*No matching companies\..*", find_result_check):
        # if not re.search(r".*No matching companies\..*", ):
        # if (not browser.find_element(By.XPATH, '//*[@id="contentDiv"]/div')):
        if not find_result_check:
            #print("Getting reports of ", target_stock, " from SEC.gov ...")
            msg = "Getting reports of " + target_stock + " from SEC.gov ..." if IS_ENGLISH else "從SEC.GOV取得" + target_stock + "的財報 ..."
            update_msg(msg)

            # Click "Selected Filings>>10-K (annual reports) and 10-Q (quarterly reports)"
            #WebDriverWait(browser, 3.0).until(EC.visibility_of_element_located((By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/h5')))           
            #print("進到裡面")
            
            #WebDriverWait(browser, 120).until(EC.visibility_of_element_located((By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/h5')))
            WebDriverWait(browser, 120).until(lambda driver : driver.execute_script("return document.readyState === 'complete';"), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
            time.sleep(1 + np.random.rand())
            annual_quarterly_report = browser.find_element(By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/h5')  
            
            #print(annual_quarterly_report)
            #print(annual_quarterly_report is not None)
            
            if annual_quarterly_report is not None:
                #annual_quarterly_report = browser.find_element(By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/h5')
                WebDriverWait(browser, 3).until(EC.element_to_be_clickable((By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/h5')), message = "No 10-K and 10-Q reports provided. Please try another company." if IS_ENGLISH else "無10-K與10-Q財報。請輸入其他公司。")
                time.sleep(1 + np.random.rand())
                annual_quarterly_report.click()
                #time.sleep(np.random.rand() + 1)  #@@ back to 1  # Wait for 1 ~ 2 seconds
                WebDriverWait(browser, 1 + np.random.rand())
            else:
                print("走else")
                update_msg("No 10-K and 10-Q reports provided. Please try another company." if IS_ENGLISH else "無10-K與10-Q財報。請輸入其他公司。")
                return None
            
            
            
            # Break point
            if(stop_flag.is_set()):
                return None

            
            
            # Click "View all 10-Ks and 10-Qs"
            all_KQs = browser.find_element(By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/div/button[1]')
            WebDriverWait(browser, 120).until(EC.visibility_of_element_located((By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/div/button[1]')), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
            time.sleep(1 + np.random.rand())
            all_KQs.click()
            
            #all_KQs = browser.find_element(By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/div/button[1]')
#             WebDriverWait(browser, 120).until(EC.visibility_of_element_located((By.XPATH, '//*[@id="filingsStart"]/div[2]/div[3]/div/button[1]')), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
#             time.sleep(1 + np.random.rand())
#             all_KQs.click()
            #time.sleep(np.random.rand() + 2)  #@@ back to 2
            WebDriverWait(browser, 120).until(EC.visibility_of_element_located((By.ID, "filingDateFrom")), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
            
            
                

            # Add this part will cause reports clicked lack of 1? -> OK! .clear() method will automatically press enter key!
            # Clear reports' "From Date"
            from_date = browser.find_element(By.ID, "filingDateFrom")
            from_date.clear()
            #time.sleep(np.random.rand() + 1.5)  #@@ back to 1.5
    #         from_date.send_keys(Keys.ENTER)
    #         time.sleep(np.random.rand() + 3)
            WebDriverWait(browser, 120).until(lambda driver : driver.execute_script("return document.readyState === 'complete';"), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
            time.sleep(1 + np.random.rand())
    
            # Break point
            if(stop_flag.is_set()):
                return None


            # To get customized number of  quarterly report (including 10-K reports and 10-Q reports), first n files needs scanned
            reports = list()  # To store 8 HTMLs of financial statements
            company_name = browser.find_element(By.ID, "name").text
            #time.sleep(np.random.rand() + 3)
            

            
            no_10_k_q_reports_list = ["CLOROX CO /DE/","CARNIVAL CORP","WELLS FARGO & COMPANY/MN","INTERNATIONAL BUSINESS MACHINES CORP",
                             "micromobility.com Inc.","WATSCO INC","UFP INDUSTRIES INC","CENNTRO ELECTRIC GROUP Ltd","OPTICAL CABLE CORP"]
            dont_support_list = ["NORTHROP GRUMMAN CORP /DE/","TREDEGAR CORP","CONSUMER PORTFOLIO SERVICES, INC.","Dragonfly Energy Holdings Corp.",
                                "Hyzon Motors Inc.","Workhorse Group Inc.","YELP INC","Desktop Metal, Inc.","CXApp Inc.",
                                "Mondee Holdings, Inc.","TIGO ENERGY, INC.","Ascent Solar Technologies, Inc.",
                                "Taylor Morrison Home Corp","DILLARD'S, INC.","Terreno Realty Corp","HEARTLAND EXPRESS INC",
                                "Wendy's Co","Extra Space Storage Inc.","Altimar Acquisition Corp. III","Compass Digital Acquisition Corp.",
                                "Ares Acquisition Corp","Blockchain Coinvestors Acquisition Corp. I","byNordic Acquisition Corp",
                                "CF Acquisition Corp. VII","Home Plate Acquisition Corp","LIV Capital Acquisition Corp. II",
                                "Metal Sky Star Acquisition Corp","Northern Star Investment Corp. III","Relativity Acquisition Corp",
                                "Adit EdTech Acquisition Corp.","Chavant Capital Acquisition Corp.","L Catterton Asia Acquisition Corp",
                                "Bridgetown Holdings Ltd","Aura Fat Projects Acquisition Corp","Hudson Acquisition I Corp.","Marblegate Acquisition Corp.",
                                "Rose Hill Acquisition Corp","Goal Acquisitions Corp.","AIB Acquisition Corp","Four Leaf Acquisition Corp","AlTi Global, Inc.",
                                "Clean Energy Special Situations Corp.","Artemis Strategic Investment Corp","HNR Acquisition Corp.",
                                "Murphy Canyon Acquisition Corp.","Quantum FinTech Acquisition Corp","AfterNext HealthTech Acquisition Corp.",
                                "Bite Acquisition Corp.","Thunder Bridge Capital Partners IV, Inc.","Corner Growth Acquisition Corp.",
                                "COMMUNITY WEST BANCSHARES /","DP Cap Acquisition Corp I","CF ACQUISITION CORP. IV","Inception Growth Acquisition Ltd",
                                "TG Venture Acquisition Corp.","Aurora Technology Acquisition Corp.","BioPlus Acquisition Corp.","DUET Acquisition Corp.",
                                "Maquia Capital Acquisition Corp","Churchill Capital Corp VII","CONX Corp.","Worldwide Webb Acquisition Corp.",
                                "TKB Critical Technologies 1","PHOENIX BIOTECH ACQUISITION CORP.","Finserv Acquisition Corp. II","Khosla Ventures Acquisition Co.",
                                "Osiris Acquisition Corp.","Industrial Tech Acquisitions II, Inc.","Genesis Growth Tech Acquisition Corp.",
                                "Jet.AI Inc.","Black Mountain Acquisition Corp.","Churchill Capital Corp V","Achari Ventures Holdings Corp. I",
                                "TradeUP Acquisition Corp.","Iconic Sports Acquisition Corp.","Gyrodyne, LLC","Kernel Group Holdings, Inc.",
                                "Abri SPAC I, Inc.","Perception Capital Corp. II","Northern Star Investment Corp. IV","Chain Bridge I",
                                "INCOME OPPORTUNITY REALTY INVESTORS INC /TX/","Nubia Brand International Corp.","Northern Star Investment Corp. IV",
                                "Churchill Capital Corp VI","Leo Holdings Corp. II","Frontier Investment Corp","Genesis Unicorn Capital Corp.",
                                "Electriq Power Holdings, Inc."]

            if(company_name in no_10_k_q_reports_list):
                update_msg("No 10-K or 10-Q financial statements provided. Please try another company!" if IS_ENGLISH else "無提供10-K或10-Q財報。請嘗試其他公司！")
                return None

            elif(company_name in dont_support_list):
                update_msg("Do not support this company. Please try another company!" if IS_ENGLISH else "不支援此公司。請嘗試其他公司！")
                return None
            
            elif(re.search(r"[Aa][Cc][qQ][uU][iI][sS][iI][tT][iI][oO][nN]", company_name)):
                update_msg("Do not support acquisition corporation. Please try another company!" if IS_ENGLISH else "不支援空白支票公司。請嘗試其他公司！")
                return None
            
            else:
                pass
            
            # Get current window handle
            # Because when clicking the linkage of report, new tab will be created. 
            # Need to switch back to the original web page to get another report of different quarter.
            # current_window = browser.current_window_handle
            # print(current_window)

            # Parameters for requests
#             user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36"
#             headers = {'user-agent': user_agent}


            # Get first 8 10-K or 10-Q reports
            #try:
            # Count the amount of filed reports without duplication (Reporting date must be unique)

            # reports_count = 8 if len(browser.find_elements(By.XPATH, '//*[@id="filingsTable"]/tbody/tr')) >= 8 else len(browser.find_elements(By.XPATH, '//*[@id="filingsTable"]/tbody/tr'))
            found_trs = browser.find_elements(By.XPATH, '//*[@id="filingsTable"]/tbody/tr')
            reports_count = len(found_trs)
            
            if(reports_count <= 1):
                update_msg("Total number of report is too little to be processed. Please try another company." if IS_ENGLISH else "財報數量過少。請輸入其他公司。")
                return None
            #print('reports count: ', reports_count)


            # For test
            # xpath = '//*[@id="filingsTable"]/tbody/tr[1]/td[2]/div/a[1]'
            # report_link = browser.find_element(By.XPATH, xpath)
            # time.sleep(np.random.rand() + 1)
            # report_link.click()


            # A set to store reporting date
            reporting_date = set()
            
            #2023-07-10 addition
            # A dictionary to map window ID and report date
            report_id_date_dict = dict()


            # Open financial statements of search result from SEC.gov
            for i in range(reports_count):
                # Break point
                if(stop_flag.is_set()):
                    return None
                
                
                xpath_date = '//*[@id="filingsTable"]/tbody/tr[' + str(i + 1) + ']/td[4]/a'     
                

                xpath = '//*[@id="filingsTable"]/tbody/tr[' + str(i + 1) + ']/td[2]/div/a[1]'
                

                check_amendment = re.compile(r"amendment")
                check_notification = re.compile(r"Notification")            
                

                # APPL: //*[@id="filingsTable"]/tbody/tr[1]/td[4]/a
                # TSLA: //*[@id="filingsTable"]/tbody/tr[1]/td[4]/a
                #     # Record current window ID for switching between tabs of browser
                #     reports_window = browser.current_window_handle

                # args = (By.XPATH, xpath)

                if(len(reporting_date) < (int(quarter_num) + 1)):
                    if((not check_amendment.search(browser.find_element(By.XPATH, xpath).text)) and (not check_notification.search(browser.find_element(By.XPATH, xpath).text))):
                        reporting_date.add(browser.find_element(By.XPATH, xpath_date).text)
                        report_link = browser.find_element(By.XPATH, xpath)
                        #time.sleep(np.random.rand() + 1.5)  #@@ back to 1.5
                        WebDriverWait(browser, 120).until(EC.element_to_be_clickable((By.XPATH, xpath)), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
                        time.sleep(1 + np.random.rand())
                        report_link.click()
                        #time.sleep(np.random.rand() + 2)  #@@ back to 2
                        WebDriverWait(browser, 1.0)
                        time.sleep(1 + np.random.rand())
                        
                        
                        #2023-07-10 addition
                        # Create a report-date mapping
                        temp_windows = browser.window_handles
                        temp_current_window = browser.current_window_handle
                        
                        window_ID = ""
                        for temp_window in temp_windows:
                            if((temp_window != temp_current_window) and (temp_window not in list(report_id_date_dict.keys()))):
                                window_ID = temp_window
                                
                                
                        window_date = browser.find_element(By.XPATH, xpath_date).text
                        report_id_date_dict[window_ID] = window_date

                    else:
                        continue


                elif(len(reporting_date) >= (int(quarter_num) + 1)):
                    break
                else:
                    #print("Something wrong when clicking report link!")
                    update_msg("Something wrong when clicking report link!" if IS_ENGLISH else "開啟財報連結出現錯誤！")
                    break




            # Get HTMLs from web tabs
            # Record new tab of window ID, string type
            new_windows = browser.window_handles

            # Get current window handle
            current_window = browser.current_window_handle

            for window in new_windows:
                if(window != current_window):
                    browser.switch_to.window(window)
                    #time.sleep(np.random.rand() + 1.5)
                    WebDriverWait(browser, 120).until(lambda driver : driver.execute_script("return document.readyState === 'complete';"), message = "Please check your network environment!" if IS_ENGLISH else "請確認您的網路環境。")
                    time.sleep(1 +  np.random.rand())
                    
                    # Break point
                    if(stop_flag.is_set()):
                        return None
                    
                    
                    report = BS(browser.page_source, "html.parser")
                    url = browser.current_url
                    #date_match = re.search(r"([-_]\d{8}).*\.htm$", url)

                    # (BeautifulSoup object, url, date)
    #                 date = None
    #                 if not date_match:
    #                     date = parser.parse(report.find(name = "ix:nonnumeric", attrs = {"name" : "dei:DocumentPeriodEndDate"}).text)
    #                 else:
    #                     date = parser.parse(date_match.group(1))

                    #date = parser.parse(report.find(name = "ix:nonnumeric", attrs = {"name" : "dei:DocumentPeriodEndDate"}).text  if report.find(name = "ix:nonnumeric", attrs = {"name" : "dei:DocumentPeriodEndDate"}) else list(reporting_date)[new_windows.index(window) - 1])
        
                    #2023-07-10 addition
                    date = parser.parse(report_id_date_dict[window])
                    reports.append((report, url, date))
            
                    if(len(reports) <= 1):
                        pass
                    elif(len(reports) == 2):
                        #print(len(reports) - 1, " report is gotten.")
                        msg = str(len(reports) - 1) + " report is gotten." if IS_ENGLISH else "取得" + str(len(reports) - 1) + "份財報"
                        update_msg(msg)
                    else:
                        #print(len(reports) - 1, " reports are gotten.")
                        msg = str(len(reports) - 1) + " reports are gotten." if IS_ENGLISH else "取得" + str(len(reports) - 1) + "份財報"
                        update_msg(msg)







            """
            # This section is bulit elsewhere. It will be replaced after the program of this part is completed.
            # Process 2: Extract financial statements from the collected HTMLs
            # Format settings of dataframe
            report_data = []
            report_index = []
            report_column = []

            for report in reports:
                print(type(report))

            # Differnt type of stocks (company and financial industry)
            # Financial industry has no inventories. It's a industry earning money by money! Different measurement needs to be implyed.
            """
            #print("All reports collected completely!")
            update_msg("All reports collected completely!" if IS_ENGLISH else "成功取得所有財報！")



        else:
            #print('Execute else statement ...') 
            #print('No matching companies. Please try again.')
            update_msg("No matching companies. Please try again." if IS_ENGLISH else "查無此公司。請輸入其他公司。")
            browser.quit()  # Close the webdriver.exe 
            return None



        # except:
            #print('Can not get 10-K or 10-Q reports from SEC.gov!')
        # finally:
        #     pass
        #     browser.close()

         
        return (reports, company_name)
    
    
    except Exception as e:
        #print("Something wrong while getting reports from SEC.gov")
        update_msg(str(e))
        
    finally:
        browser.quit()  # Close the webdriver.exe
        #print("End connecting ...")        
        update_msg("End connecting ..." if IS_ENGLISH else "中斷連線 ...")




# ## Function definition: Data processing

# In[5]:




# Check the report type (10-K or 10-Q)
def check_report_type(soup):
    # print(str(soup))
    #test_list = soup.find_all("ix:nonnumeric", {"id" : re.compile(r"fact-identifier-\d+")})
    #test_list = soup.find_all("ix:nonnumeric", {"name" : "dei:DocumentType"})
    # print(test)
    # test = etree.HTML(str(soup)).xpath('//*[@id="dynamic-xbrl-form"]/div[10]/table/tbody/tr[2]/td[2]/span')[0].text
    
    IS_QUARTERLY = soup.find("ix:nonnumeric", {"name" : "dei:DocumentQuarterlyReport"})
    REPORT_FORM = soup.find("ix:nonnumeric", {"name" : "dei:DocumentType"})
    IS_ANNUAL = soup.find("ix:nonnumeric", {"name" : "dei:DocumentAnnualReport"})
    IS_TRANSITION = soup.find("ix:nonnumeric", {"name" : "dei:DocumentTransitionReport"})
    
    # 遍立每個test才能決定是哪個報表!! -> 不需要了!
#     if(any(test.string == "10-Q" for test in test_list)):
#         return 'Q'
#     elif(any((test.string == "10-K")for test in test_list)):
#         return 'K'
#     else:
#         return "Drop"

    if((IS_QUARTERLY and re.search("[☑☒X]",IS_QUARTERLY.string)) or (IS_TRANSITION and re.search("[☑☒X]", IS_TRANSITION.string)) or (REPORT_FORM and re.search(r"10-Q", REPORT_FORM.string))):
        return 'Q'
    elif((IS_ANNUAL and re.search("[☑☒X]", IS_ANNUAL.string)) or (REPORT_FORM and re.search(r"10-K", REPORT_FORM.string))):
        return 'K'
    else:
        return "Drop"


# Different companies have different scale of industry -> Not all monetary unit is i"in million"! -> Depends on "scale"
def transform_to_number(soup):
    number = 0
    if soup:
        # print(soup.text.replace(',', ''))
        number = float(soup.text.replace(',', '').replace('$', '')) if (re.search(r"[^—–\$\-\/a-zA-Z\s,\(\)\.]", soup.text)) else np.nan
        #number *= np.power(10, (float(soup["scale"]) - 6)) if (soup["decimals"] != "2") else 1
        number *= np.power(10, (float(soup["scale"]))) if soup.has_attr("scale") else 1
        number = number if ((soup.has_attr("isnegativesonly") and soup["isnegativesonly"] == "false") or (not soup.has_attr("isnegativesonly") and not re.search("\(.*\)",soup.parent.parent.text))) else -number
    else:
        number = np.nan
        
    #print("transformed number: ", number)
    return number


# Get data from table
def extract_data(tables, pattern, iscalculationsonly, position):
    
    # table: The source of data
    # pattern: The pattern of "name" tag. Different data have their own patterns
    # iscalculationsonly: Feature to further focus on the targeted tag of data
    # position: The position of the targeted data
    
    temp_list = []
    for table in tables:
        if iscalculationsonly:
            temp_list.extend(table.find_all(name = "ix:nonfraction", attrs = {"name" : re.compile(pattern), "iscalculationsonly" : re.compile(iscalculationsonly)}))
        else:
            temp_list.extend(table.find_all(name = "ix:nonfraction", attrs = {"name" : re.compile(pattern)}))
    
    # Filter out elements with parent's attribute = style="display:none"
    temp_list_filter = filter(lambda tag : not any(parent.has_attr("style") and re.search(r"display:none", parent["style"]) for parent in tag.parents), temp_list)
    data_tag = sorted(temp_list_filter, key = lambda x : int(re.search(r"\d+", x.get("id")).group(0)))[position] if len(temp_list) - 1 >= position else None
    #print(data_tag)
    data = transform_to_number(data_tag)
    temp_list.clear()
#     table.clear()
    return data
    
#     if(isinstance(position, int)):
#         data_tag = sorted(temp_list, key = lambda x : int(re.search(r"\d+", x.get("id")).group(0)))[position] if len(temp_list) - 1 >= position else None
#         data = transform_to_number(data_tag)
#         temp_list.clear()
#     #     table.clear()
#         return data
    
#     elif(isinstance(position, str)):
#         if(position == "GET_MAX"):
#             data_tags = sorted(temp_list, key = lambda x : int(re.search(r"\d+", x.get("id")).group(0))) if len(temp_list) - 1 > 0 else None
#             datas = [transform_to_number(data_tag) for data_tag in data_tags]
#             data = max(datas)
#             return data
#         else:
#             pass
#     else:
#         print("Unknown parameter")
#         return None
    

def check_industry_type(soup):
    test_list = soup.find_all("ix:nonfraction", {"name" : re.compile(r"^us-gaap:Inventory"), "iscalculationsonly" : "true"})
    
    if(len(test_list) == 0):
        return "F"
    elif(len(test_list) > 0):
        return "N"
    else:
        #print("Unknown industry type")
        return "U"

# Visualization of data


# ## Function definition: Extract data and build dataframe
# Need to update the portion of special cases.

# In[6]:


# For executing this module first time, please execute the above program first, then "reports" are obtained.
# Build program of section 2 -> OK!
# Extract data from reports
# Need to consider some special case. Like GOOGLE

def extract_from_reports(reports, industry_type, special_case = None, stop_flag = None):
    
    #Default settings
    #Filter tag functions
    def find_table_operations(tag):
        if(tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
            return True
        return False
    
    def find_table_comprehensive(tag):
        if(tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
            return True
        return False
    
    def find_table_balance(tag):
        if(tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
            return True
        return False
    
    def find_table_cashflow(tag):
        if(tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
            return True
        return False
    
    def find_table_credit(tag):
        if(tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
            return True
        return False
    
    
    
    def find_table_balance_nested(tag):
        #print("Overwrite success!")
        if(tag.name == "table" and any((element.name == "span" and title_regex.search(element.text)) for element in tag.descendants)):
            return True
        return False

    def find_table_operations_nested(tag):
        #print("Overwrite success!")
        if(tag.name == "table" and any((element.name == "span" and title_regex.search(element.text)) for element in tag.descendants)):
            return True
        return False

    def find_table_comprehensive_nested(tag):
        #print("Overwrite success!")
        if(tag.name == "table" and any((element.name == "span" and title_regex.search(element.text)) for element in tag.descendants)):
            return True
        return False

    def find_table_cashflow_nested(tag):
        #print("Overwrite success!")
        if(tag.name == "table" and any((element.name == "span" and title_regex.search(element.text)) for element in tag.descendants)):
            return True
        return False

    def find_table_credit_nested(tag):
        if(tag.name == "table" and any((element.name == "span" and title_regex.search(element.text)) for element in tag.descendants)):
            return True
        return False
    
    def find_table_risk_weighted_assets_nested(tag):
        if(tag.name == "table" and any((element.name == "span" and title_regex.search(element.text)) for element in tag.descendants)):
            return True
        return False
   
    def find_risk_weighted_assets(tag):
        #if(tag.name = "span" and tag.parent.)
        pass

    # Title patterns
    title_pattern_balance = "[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [bB][aA][lL][aA][nN][cC][eE] [sS][hH][eE][eE][tT][sS]?\s?$"
    title_pattern_comprehensive = "[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]? [oO][fF] [cC][oO][mM][pP][rR][eE][hH][eE][nN][sS][iI][vV][eE] [iI][nN][cC][oO][mM][eE]"
    title_pattern_operations = "[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]? [oO][fF] [oO][pP][eE][rR][aA][tT][iI][oO][nN][sS]?\s?$|[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]? [oO][fF] [iI][nN][cC][oO][mM][eE]$|[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]? [oO][fF] [eE][aA][rR][nN][iI][nN][gG][sS]$|[cC][oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [iI][nN][cC][oO][mM][eE] [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]?$"
    title_pattern_cashflow = "[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]? [oO][fF] [cC][aA][sS][hH] [fF][lL][oO][wW][sS]?|[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [cC][aA][sS][hH] [fF][lL][oO][wW][sS]? [sS][tT][aA][tT][eE][mM][eE][nN][tT][sS]?"
    title_pattern_credit = "^[cC][rR][eE][dD][iI][tT] [qQ][uU][aA][lL][iI][tT][yY]"
    title_pattern_risk_weighted_assets = "^Risk-weighted [aA]ssets"

    
    # Datas' position
    position = (0, 2, 0)  # (current quarter, previous quarter, fiscal year) 
    position_income = (0, 2, 0)
    position_comprehensive = (0, 2, 0)
    position_nonperforming_loans = 0
    position_cash_flow = (0, 0, 0)  # (current quarter, previous quarter, fiscal year)
#     iscalculationsonly_revenue = "true"
    
    
    # Flags related to financial statement's structure
    CASHFLOW_QUARTER_NEED_COUNT = True
    TITLE_NESTED_IN_TABLE = False
    DONT_FIND_TABLE = True
    RISK_WEIGHTED_ASSETS_NOT_IN_TABLE = False
    
    
    # Don't use match-case (only supported above 3.10.x)
    """ 
    match special_case:
        case "Alphabet Inc.":
            position = (1, 3, 2)
            position_cash_flow = (1, 1, 2)
            iscalculationsonly_revenue = "true|false"
        case _:
            pass
    """
    
    # Special case params
    # Special case params
    
        
    if(special_case == "Alphabet Inc."):
        #DONT_FIND_TABLE = False
        position = (1, 1, 2)
        position_income = (1, 3, 2)
        position_comprehensive = (1, 3, 2)
        position_cash_flow = (1, 1, 2)
        iscalculationsonly_revenue = "true|false"
        
    elif(special_case == "MICROSOFT CORP"):
        title_pattern_balance = r"^BALANCE SHEETS\s?$"
        title_pattern_operations = r"^INCOME STATEMENTS\s?$"
        title_pattern_comprehensive = r"^COMPREHENSIVE INCOME STATEMENTS\s?$"
        title_pattern_cashflow = r"^CASH FLOWS STATEMENTS\s?$"
        
        position_cash_flow = (0, 2, 0)  # (current quarter, previous quarter, fiscal year)
        CASHFLOW_QUARTER_NEED_COUNT = False
        
#         def find_table_balance(tag):
#             #print("Overwrite success!")
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
#         def find_table_operations(tag):
#             #print("Overwrite success!")
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
#         def find_table_comprehensive(tag):
#             #print("Overwrite success!")
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
#         def find_table_cashflow(tag):
#             #print("Overwrite success!")
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
    elif(special_case == "BANK OF AMERICA CORP /DE/"):
        
        # Table's title is included in targeted table 
#         TITLE_NESTED_IN_TABLE = True
        
        position_nonperforming_loans = -2
        
    elif(special_case == "Monster Beverage Corp"):
        pass
#         title_pattern_balance = "CONSOLIDATED BALANCE SHEETS$"
#         def find_table_balance(tag):
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
#         title_pattern_operations = "CONSOLIDATED STATEMENTS OF INCOME$"
#         def find_table_operations(tag):
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
#         title_pattern_comprehensive = "CONSOLIDATED STATEMENTS OF COMPREHENSIVE INCOME$"
#         def find_table_comprehensive(tag):
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False
        
#         title_pattern_cashflow = "CONSOLIDATED STATEMENTS OF CASH FLOWS$"
#         def find_table_cashflow(tag):
#             if(tag.name == "p" and title_regex.search(tag.text)):
#                 return True
#             return False

    elif(special_case == "KIMBERLY CLARK CORP"):
        pass
    
    elif(special_case == "CLOROX CO /DE/"):
        #print("No 10-K financial statements provided. Please try other company!")
        update_msg("No 10-K or 10-Q financial statements provided. Please try another company!" if IS_ENGLISH else "無提供10-K或10-Q財報。請嘗試其他公司！")
        return None
    
    
    elif(special_case == "CARNIVAL CORP"):
        #print("No 10-K financial statements provided. Please try other company!")
        update_msg("No 10-K financial statements provided. Please try another company!" if IS_ENGLISH else "無提供10-K財報。請嘗試其他公司！")
        return None
    
    elif(special_case == "CHURCH & DWIGHT CO INC /DE/"):
        pass
#         title_pattern_balance = "[oO][nN][sS][oO][lL][iI][dD][aA][tT][eE][dD] [bB][aA][lL][aA][nN][cC][eE] [sS][hH][eE][eE][tT][sS]$"
#         def find_table_balance(tag):
#             if(re.search("p|span", tag.name) and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
#                 return True
#             return False
        
#         def find_table_operations(tag):
#             if(re.search("p|span", tag.name) and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
#                 return True
#             return False
        
#         def find_table_cashflow(tag):
#             if(re.search("p|span", tag.name) and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
#                 return True
#             return False
    
    elif(special_case == "GENERAL MILLS INC"):
        
#         title_pattern_operations = "^Consolidated Statements of Earnings\s?$"
#         def find_table_operations(tag):
#             if(re.search("div|span", tag.name) and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString):
#                 return True
#             return False
        
        # Some titles are nested in tables, some even have no tables containing data (after 2022-5-29)!
#         TITLE_NESTED_IN_TABLE = True
        pass
    
    elif(special_case == "BEYOND MEAT, INC."):
        pass
#         TITLE_NESTED_IN_TABLE = True
      
    elif(special_case == "Philip Morris International Inc."):
        position_income = (2, 0, 0)
        position_comprehensive = (2, 0, 0)
        
    elif(special_case == "CONSTELLATION BRANDS, INC."):
        position_income = (2, 0, 0)
        position_comprehensive = (2, 0, 0)
        
    elif(special_case == "AMAZON COM INC"):
        position_income = (1, 3, 2)
        position = (1, 0, 1)
        position_comprehensive = (1, 3, 2)
        position_cash_flow = (1, 3, 2)
        CASHFLOW_QUARTER_NEED_COUNT = False
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "MCDONALDS CORP"):
        CASHFLOW_QUARTER_NEED_COUNT = False
        position_cash_flow = (0, 2, 0)
        
    elif(special_case == "YUM BRANDS INC"):
#         DONT_FIND_TABLE = False
#         TITLE_NESTED_IN_TABLE = True
        pass
    
    
#     elif(special_case == "ROYAL CARIBBEAN CRUISES LTD"):
#         DONT_FIND_TABLE = False
#         title_pattern_operations = "CONSOLIDATED STATEMENTS OF COMPREHENSIVE LOSS"
#         title_pattern_comprehensive = "CONSOLIDATED STATEMENTS OF COMPREHENSIVE LOSS"
    elif(special_case == "NETFLIX INC"):
        CASHFLOW_QUARTER_NEED_COUNT = False
        position_cash_flow = (0, 2, 0)
        
        
    elif(special_case == "NORTHROP GRUMMAN CORP /DE/"):
        #REVENUES_SPECIAL = True
        #position_income_is_false = (0, )
        update_msg("Do not support this company. Please try another company!" if IS_ENGLISH else "不支援此公司。請嘗試其他公司！")
        return None
        
    elif(special_case == "PFIZER INC"):
        DONT_FIND_TABLE = False
        
    elif(special_case == "Merck & Co., Inc."):
        DONT_FIND_TABLE = False
        
    elif(special_case == "MARRIOTT INTERNATIONAL INC /MD/"):
        DONT_FIND_TABLE = False
        
    
    elif(special_case == "WELLS FARGO & COMPANY/MN"):
        update_msg("No 10-K financial statements provided. Please try another company!" if IS_ENGLISH else "無提供10-K財報。請嘗試其他公司！")
        return None
    
    
    elif(special_case == "INTERNATIONAL BUSINESS MACHINES CORP"):
        update_msg("No 10-K financial statements provided. Please try another company!" if IS_ENGLISH else "無提供10-K財報。請嘗試其他公司！")
        return None
    
    
    elif(special_case == "ADVANCED MICRO DEVICES INC"):
        #DONT_FIND_TABLE = False
        position_income = (0, 3, 0)
        
    elif(special_case == "AT&T INC."):
        DONT_FIND_TABLE = False
        TITLE_NESTED_IN_TABLE = True
        
    elif(special_case == "Fresh Vine Wine, Inc."):
        update_msg("No 10-K financial statements provided. Please try another company!" if IS_ENGLISH else "無提供10-K財報。請嘗試其他公司！")
        return None
        
        
    elif(special_case == "Rivian Automotive, Inc. / DE"):
        position = (1, 1, 1)
        position_income = (1, 3, 2)
        position_comprehensive = (1, 3, 2)
        position_cash_flow = (1, 1, 2)
        
        
    elif(special_case == "BUNGELTD"):
        DONT_FIND_TABLE = False
        
        title_pattern_operations = r"CONSOLIDATED STATEMENTS OF INCOME"
        title_pattern_comprehensive = r"CONSOLIDATED STATEMENTS OF COMPREHENSIVE INCOME"
        
        
        
        
        
    elif(special_case == "DARLING INGREDIENTS INC."):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "GRIFFON CORP"):
        DONT_FIND_TABLE = False
        title_pattern_operations = r"CONSOLIDATED STATEMENTS OF OPERATIONS AND"
        title_pattern_comprehensive = r"CONSOLIDATED STATEMENTS OF OPERATIONS AND"
        
        
    elif(special_case == "MUELLER INDUSTRIES INC"):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "CALERES INC"):
        DONT_FIND_TABLE = False
        #title_pattern_balance = r"[cC]"
        #title_pattern_operations = r"^INCOME STATEMENTS\s?$"
        #title_pattern_comprehensive = r"^COMPREHENSIVE INCOME STATEMENTS\s?$"
        #title_pattern_cashflow = r"^CASH FLOWS STATEMENTS\s?$"
        
        
        def find_table_balance(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_operations(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_comprehensive(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_cashflow(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        
#     elif(special_case == "CATERPILLAR INC"):  # only "net income" portion is different
#         position_income = (0, 4, 0)
#         position_comprehensive = (0, 4, 0)
        
    
    elif(special_case == "Eaton Corp plc"):
        position_income = (0, 3, 0)
        position_comprehensive = (0, 3, 0)
        
        
    elif(special_case == "TIDEWATER INC"):
        DONT_FIND_TABLE = False
        
        
        
        def find_table_balance(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_operations(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_comprehensive(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_cashflow(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        
        
    elif(special_case == "TORO CO"):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "KAMAN Corp"):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "DOW INC."):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "KRONOS WORLDWIDE INC"):
        DONT_FIND_TABLE = False
        title_pattern_balance = r"CONSOLIDATED BALANCE SHEETS (CONTINUED)$"
        
        
        def find_table_balance(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_operations(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_comprehensive(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_cashflow(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        
    elif(special_case == "Otis Worldwide Corp"):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "Aptiv PLC"):
        DONT_FIND_TABLE = False
        
        title_pattern_operations = r"^CONSOLIDATED STATEMENTS OF OPERATIONS"
        
        
    elif(special_case == "Hyzon Motors Inc."):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "Sunnova Energy International Inc."):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "Bumble Inc."):
        DONT_FIND_TABLE = False
        
        
        def find_table_balance(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_operations(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_comprehensive(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_cashflow(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        
    elif(special_case == "i3 Verticals, Inc."):
        DONT_FIND_TABLE = False
        
        
    elif(special_case == "COMPUTER TASK GROUP INC"):
        DONT_FIND_TABLE = False
        
        def find_table_balance(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_operations(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_comprehensive(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_cashflow(tag):
            #print("Overwrite success!")
            if(tag.name == "p" and title_regex.search(tag.text)):
                return True
            return False
        
        
    elif(special_case == "American Strategic Investment Co."):
        DONT_FIND_TABLE = False
        title_pattern_operations = r"CONSOLIDATED STATEMENTS OF OPERATIONS AND COMPREHENSIVE LOSS"
        title_pattern_operations = r"CONSOLIDATED STATEMENTS OF OPERATIONS AND COMPREHENSIVE LOSS"
        
        
    elif(special_case == "Legacy Housing Corp"):
        DONT_FIND_TABLE = False
        title_pattern_operations = r"STATEMENTS OF INCOME$"
        
        def find_table_balance(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_operations(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_comprehensive(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
        def find_table_cashflow(tag):
            #print("Overwrite success!")
            if(tag.name == "b" and title_regex.search(tag.text)):
                return True
            return False
        
    elif(special_case == "Extra Space Storage Inc."):
        DONT_FIND_TABLE = False
        
    else:
        # Normal report structure
        pass
    
    
    
    # Break point
    if(stop_flag.is_set()):
        return None
    
    # Sort reports by its date, also filter out unwanted reports
    reports_filtered = filter(lambda report : report[2] is not None, reports)
    #print(type(reports_filtered))
    reports_sorted = sorted(reports_filtered, key = lambda report : report[2])  # Sorted by date, ascending
    #print("reports count: ", str(len(reports_sorted)))

    # for report in reports_sorted:
    #     print(report[1])  # url, string
    #     print(report[2])  # Date object
    #     print(check_report_type(report[0]))  #report[0]: BS object



   
    # In case that financial statement may be divided into two tables, all the eligible title spans need to be founded
    # Find table for "Consolidated statements of operations (incomes)"
    table_operations = []
    for report in reports_sorted:
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        title_regex = re.compile(title_pattern_operations)
        
        if not TITLE_NESTED_IN_TABLE:
            
            # title_span = report[0].find("span", text = title_regex)
            title_spans = report[0].find_all(find_table_operations)
            #title_spans = report[0].find_all(lambda tag : tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString)
            tables = [title_span.findNext("table") for title_span in title_spans] # No matter the element is nested or not, just find the conformed element sequentially
            tables = report[0] if not tables else tables
            #print("Income: ", len(tables))
            table_operations.append((title_spans, tables, report[2]))  
        else:
            tables = report[0].find_all(find_table_operations_nested)
            tables = report[0] if not tables else tables
            #print("Nested Income: ", len(tables))
            table_operations.append((None, tables, report[2])) 
            
        if DONT_FIND_TABLE:
            table_operations.pop()
            table_operations.append((None, report[0], report[2]))



    # print(table_operations[7][1])


    # Find table for "Consolidated statements of comprehensive income"
    table_comprehensive_income = []
    for report in reports_sorted:
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        title_regex = re.compile(title_pattern_comprehensive)
        
        if not TITLE_NESTED_IN_TABLE:
            # title_span = report[0].find("span", text = title_regex)
            #title_spans = report[0].find_all(lambda tag : tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString)

            title_spans = report[0].find_all(find_table_comprehensive)
            tables = [title_span.findNext("table") for title_span in title_spans] # No matter the element is nested or not, just find the conformed element sequentially
            tables = report[0] if not tables else tables
            #print("Comprehensive: ", len(tables))
            table_comprehensive_income.append((title_spans, tables, report[2])) 
        else:
            tables = report[0].find_all(find_table_comprehensive_nested)
            tables = report[0] if not tables else tables
            #print("Nested Comprehensive: ", len(tables))
            table_comprehensive_income.append((None, tables, report[2])) 
            
            
        if DONT_FIND_TABLE:
            table_comprehensive_income.pop()
            table_comprehensive_income.append((None, report[0], report[2]))



    # print(table_comprehensive_income[7][1])


    # Find table for "Consolidated balance sheets"
    table_balances = []
    for report in reports_sorted:
        # Break point
        if(stop_flag.is_set()):
            return None
        
        title_regex = re.compile(title_pattern_balance)
        
        if not TITLE_NESTED_IN_TABLE:
            # title_span = report[0].find("span", text = title_regex)
            #title_spans = report[0].find_all(lambda tag : tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString)

            title_spans = report[0].find_all(find_table_balance)

            tables = [title_span.findNext("table") for title_span in title_spans]  # No matter the element is nested or not, just find the conformed element sequentially
            tables = report[0] if not tables else tables
            #print("Balance: ", len(tables))
            table_balances.append((title_spans, tables, report[2]))  
        else:
            tables = report[0].find_all(find_table_balance_nested)
            tables = report[0] if not tables else tables
            #print("Nested Balance: ", len(tables))
            table_balances.append((None, tables, report[2]))  
            
        if DONT_FIND_TABLE:
            table_balances.pop()
            table_balances.append((None, report[0], report[2]))


    # print(table_balances[2][1])



    # Find table of "Consolidated statements of cash flows"
    table_cashflows = []
    for report in reports_sorted:
        # Break point
        if(stop_flag.is_set()):
            return None
        
        title_regex = re.compile(title_pattern_cashflow)
        
        if not TITLE_NESTED_IN_TABLE:
            # title_span = report[0].find("span", text = title_regex)
            #title_spans = report[0].find_all(lambda tag : tag.name == "span" and title_regex.search(tag.text) and type(tag.contents[0]) is NavigableString)

            title_spans = report[0].find_all(find_table_cashflow)

            tables = [title_span.findNext("table") for title_span in title_spans]  # No matter the element is nested or not, just find the conformed element sequentially
            tables = report[0] if not tables else tables
            #print("Cashflows: ", len(tables))
            table_cashflows.append((title_spans, tables, report[2]))  
        else:
            tables = report[0].find_all(find_table_cashflow_nested)
            tables = report[0] if not tables else tables
            #print("Nested Cashflows: ", len(tables))
            table_cashflows.append((None, tables, report[2]))  
            
            
        if DONT_FIND_TABLE:
            table_cashflows.pop()
            table_cashflows.append((None, report[0], report[2]))


    # print(table_cashflows[2][1])
    
    
    # Find table of "Credit quality" (for financial industry)
    table_credit_quality = []
    for report in reports_sorted:
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        title_regex = re.compile(title_pattern_credit)
        if not TITLE_NESTED_IN_TABLE:
            title_spans = report[0].find_all(find_table_credit)

            tables = [title_span.findNext("table") for title_span in title_spans]  # No matter the element is nested or not, just find the conformed element sequentially
            tables = report[0] if not tables else tables
            #print("Credit: ", len(tables))
            table_credit_quality.append((title_spans, tables, report[2])) 
        else:
            tables = report[0].find_all(find_table_credit_nested)
            tables = report[0] if not tables else tables
            #print("Nested Credit: ", len(tables))
            table_credit_quality.append((None, tables, report[2]))  
            
        if DONT_FIND_TABLE:
            table_credit_quality.pop()
            table_credit_quality.append((None, report[0], report[2]))


    # Find table of "Risk-weighted assets"
    table_risk_weighted_assets = []
    for report in reports_sorted:
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        title_regex = re.compile(title_pattern_risk_weighted_assets)
        tables = report[0].find_all(find_table_risk_weighted_assets_nested)
        tables = report[0] if not tables else tables
        #print("Nested Risk-weighted: ", len(tables))
        table_risk_weighted_assets.append((None, tables, report[2])) 
        
        
        if DONT_FIND_TABLE:
            table_risk_weighted_assets.pop()
            table_risk_weighted_assets.append((None, report[0], report[2]))

    
    # Extract the targeted data from the above tables, quarter by quarter, depends on industry type
    #print("Start processing data ...")
    update_msg("Start processing data ..." if IS_ENGLISH else "資料處理中 ...")
    if(industry_type == "N"):
        # Settings of pandas's dataframe
        
        result_columns = []  # Quarter date
        result_index = []
        if IS_ENGLISH:
            result_index = ["Assets", "Inventories", "Liabilities", "Total stockholder's equity", "Earning per share basic", "Earning per share diluted",
                         "Revenue", "Gross profit", "Earning before provision for taxes on income", "Net income", "Comprehensive income net of tax",
                         "Net cash from operating activities", "Net cash from investing activities", "Net cash from financing activities",
                         "Gross margin (%)", "Operating margin (%)", "Net income margin (%)", "Days Inventory (days)",
                         "Return on assets (%)", "Return on equity (%)"]
        else:
            result_index = ["總資產", "存貨", "總負債", "股東權益", "基本每股盈餘", "稀釋每股盈餘",
                         "營業收入", "毛利", "稅前淨利", "淨收入", "綜合收入",
                         "營業活動現金流量", "投資活動現金流量", "融資活動現金流量",
                         "毛利率 (%)", "營業利益率 (%)", "稅後淨利率 (%)", "存貨周轉天數 (天)",
                         "資產報酬率 (%)", "股東權益報酬率 (%)"]
            
        result_data = [[0] * (len(reports) - 1) for _ in range(len(result_index))]
        #print(len(reports_sorted))





        # Extract data from the above tables version 2
        # Probably no 9 reports will be gotten!
        for i in range(1, len(reports)):
            # Break point
            if(stop_flag.is_set()):
                return None
        
        
            # Add quarter date
            result_columns.append(reports_sorted[i][2].date())


            # Get assets
            result_data[0][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:Assets$", None, position[0])


            # Get inventories    
            result_data[1][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:InventoryNet$|^us-gaap:InventoryWorkInProcessAndRawMaterialsNetOfReserves$", None, position[0])


            # Get liabilities (May need to be calculated!)
            result_data[2][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:Liabilities$", None, position[0])



            # Get total stockholder's equity (May need to be calculated!)
            name="us-gaap:StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest"
            if not np.isnan(extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity$|^us-gaap:StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest$", None, position[0])):
                result_data[3][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity$|^us-gaap:StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest$", None, position[0])
            #elif not np.isnan(extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity", None, position[0])):
                #result_data[3][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity", None, position[0])
            else:
                result_data[3][i - 1] = np.nan


            # Calculate liabilities or stockholder's equity

            for j in range(len(reports) - 1):
                if(not np.isnan(result_data[0][j]) and np.isnan(result_data[2][j]) and not np.isnan(result_data[3][j])):
                    result_data[2][j] = result_data[0][j] - result_data[3][j]
                elif(not np.isnan(result_data[0][j]) and not np.isnan(result_data[2][j]) and np.isnan(result_data[3][j])):
                    result_data[3][j] = result_data[0][j] - result_data[2][j]
                else:
                    pass

            # Calculate liabilities or stockholder's equity
            """
            if(not np.isnan(result_data[0][i - 1]) and np.isnan(result_data[2][i - 1]) and not np.isnan(result_data[3][i - 1])):
                result_data[2][i - 1] = result_data[0][i - 1] - result_data[3][i - 1]
            elif(not np.isnan(result_data[0][i - 1]) and not np.isnan(result_data[2][i - 1]) and np.isnan(result_data[3][i - 1])):
                result_data[3][i - 1] = result_data[0][i - 1] - result_data[2][i - 1]
            else:
                pass
            """



            # Difference between 10-K and 10-Q reports
            if(check_report_type(reports_sorted[i][0]) == "Q"):

                # Get EPS (basic)
                result_data[4][i - 1] = np.round(extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareBasic$|^us-gaap:IncomeLossFromContinuingOperationsPerBasicShare$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[0]), 2)

                # Get EPS (diluted)
                result_data[5][i - 1] = np.round(extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareDiluted$|^us-gaap:IncomeLossFromContinuingOperationsPerDilutedShare$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[0]), 2)

                # Get revenues
                #print("Revenue")    
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[0])):
                    result_data[6][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[0])):
                    result_data[6][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[0])
                else:
                    result_data[6][i - 1] = np.nan
                



                # Get gross profit (May need to be calculated)
                cost_of_revenue = np.nan                
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", "true", position_income[0])):
                    cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", "true", position_income[0])  
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", None, position_income[0])):
                    cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", None, position_income[0])
                else:
                    pass
                
                
                gross_profit = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[0])):
                    gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", None, position_income[0])):
                    gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", None, position_income[0])
                else:
                    pass
                
                if not np.isnan(gross_profit):
                    result_data[7][i - 1] = gross_profit
                elif not np.isnan(result_data[6][i - 1]) and not np.isnan(cost_of_revenue):
                    result_data[7][i - 1] = result_data[6][i - 1] - cost_of_revenue
                else:
                    result_data[7][i - 1] = np.nan
                    

                # Get Income before provision for income taxes
                name="fls:EarningsBeforeIncomeTaxes"
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[0])):
                    result_data[8][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[0])):
                    result_data[8][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[0])
                else:
                    result_data[8][i - 1] = np.nan
                    
                    

                # Get net income
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[0])):
                    result_data[9][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[0])                
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[0])):
                    result_data[9][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[0])    
                else:
                    result_data[9][i - 1] = np.nan


                # Get comprehensive income net of tax
                if not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[0])):
                    result_data[10][i - 1] = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[0])
                elif not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[0])):
                    result_data[10][i - 1] = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[0])
                else:
                    result_data[10][i - 1] = np.nan

            elif(check_report_type(reports_sorted[i][0]) == "K"):

                # Get EPS (basic)
                result_data[4][i - 1] = np.round(extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareBasic$|^us-gaap:IncomeLossFromContinuingOperationsPerBasicShare$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[2]), 2)

                # Get EPS (diluted)
                result_data[5][i - 1] = np.round(extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareDiluted$|^us-gaap:IncomeLossFromContinuingOperationsPerDilutedShare$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[2]), 2)


                # Get revenues (Need to get data from the previous quarter report, then calculate it)
                # 1. Get nine months accumulated data
                previous_revenues = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[1])):
                    previous_revenues = extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[1])):
                    previous_revenues = extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[1])
                else:
                    pass


                # 2. Get revenues of whole fiscal year
                year_revenues = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[2])):
                    year_revenues = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[2])):
                    year_revenues = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[2])
                else:
                    pass

                # 3. Calculate revenue from the above values
                if not np.isnan(year_revenues) and not np.isnan(year_revenues):
                    result_data[6][i - 1] = year_revenues - previous_revenues
                else:
                    result_data[6][i - 1] = np.nan
                
                
                #print("Revenue calculated!")
                #print("year_revenues: ", year_revenues)
                #print("previous_revenues: ", previous_revenues )


                # Get gross profit (Need to get data from the previous quarter report, then calculate it)
                previous_gross_profit = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", "true", position_income[1])):
                    previous_gross_profit = extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", None, position_income[1])):
                    previous_gross_profit = extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", None, position_income[1])
                else:
                    pass
                
                
                year_gross_profit = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[2])):
                    year_gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", None, position_income[2])):
                    year_gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", None, position_income[2])
                else:
                    pass
                
                gross_profit = np.nan
                if not np.isnan(year_gross_profit) and not np.isnan(previous_gross_profit):
                    gross_profit = year_gross_profit - previous_gross_profit
                else:
                    pass

                previous_cost_of_revenue = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", "true", position_income[1])):
                    previous_cost_of_revenue = extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", None, position_income[1])):
                    previous_cost_of_revenue = extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", None, position_income[1])
                else:
                    pass
                
                year_cost_of_revenue = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", "true", position_income[2])):
                    year_cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", None, position_income[2])):
                    year_cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$|^us-gaap:CostOfGoodsAndServicesSold$|^us-gaap:ProductionAndDistributionCosts$|:CostOfProductsSold$|:CostOfProductsSoldExcludingInventoryAdjustments$|^us-gaap:CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization$|^us-gaap:DirectOperatingCosts$", None, position_income[2])
                else:
                    pass
                
                
                cost_of_revenue = np.nan
                if not np.isnan(year_cost_of_revenue) and not np.isnan(previous_cost_of_revenue):                
                    cost_of_revenue = year_cost_of_revenue - previous_cost_of_revenue
                else:
                    pass

                if not np.isnan(gross_profit):
                    result_data[7][i - 1] = gross_profit
                elif not np.isnan(result_data[6][i - 1]) and not np.isnan(cost_of_revenue):
                    result_data[7][i - 1] = result_data[6][i - 1] - cost_of_revenue
                else:
                    result_data[7][i - 1] = np.nan



                # Get Income before provision for income taxes
                previous_income_before_tax = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[1])):
                    previous_income_before_tax = extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[1])):
                    previous_income_before_tax = extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[1])
                else:
                    pass

                year_income_before_tax = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[2])):                    
                    year_income_before_tax = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[2])):
                    year_income_before_tax = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossIncludingPortionAttributableToNoncontrollingInterest$|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[2])
                else:
                    pass
                
                income_before_tax = np.nan
                if not np.isnan(year_income_before_tax) and not np.isnan(previous_income_before_tax):
                    income_before_tax = year_income_before_tax - previous_income_before_tax
                else:
                    pass
                
                if not np.isnan(income_before_tax):
                    result_data[8][i - 1] = income_before_tax
                else:
                    result_data[8][i - 1] = np.nan


                # Get net income
                previous_income = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[1])):
                    previous_income = extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[1])):
                    previous_income = extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[1])
                else:
                    pass
                
                year_income = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[2])):
                    year_income = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[2])):
                    year_income = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[2])
                else:
                    pass
                
                if not np.isnan(year_income) and not np.isnan(previous_income):
                    result_data[9][i - 1] = year_income - previous_income
                else:
                    result_data[9][i - 1] = np.nan


                # Get comprehensive income net of tax
                previous_comprehensive_income = np.nan
                if not np.isnan(extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[1])):
                    previous_comprehensive_income = extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[1])
                elif not np.isnan(extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[1])):
                    previous_comprehensive_income = extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[1])
                else:
                    pass
                
                
                year_comprehensive_income = np.nan
                if not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[2])):
                    year_comprehensive_income = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[2])
                elif not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[2])):
                    year_comprehensive_income = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[2])
                else:
                    pass
                
                if not np.isnan(year_comprehensive_income) and not np.isnan(previous_comprehensive_income):
                    result_data[10][i - 1] = year_comprehensive_income - previous_comprehensive_income
                else:
                    result_data[10][i - 1] = np.nan

            else:
                #print("Something wrong after filtering and sorting")
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None



            # Get net cash provided by operating activities 
            # No information of cash flow in current quarter period! Only accululated value is provided! Have special case!
            # Need some calculation to get cash flow in the quarter period
            if(check_report_type(reports_sorted[i - 1][0]) == "K"):
                # First quarter
                result_data[11][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[0])

            elif(check_report_type(reports_sorted[i - 1][0]) == "Q"):
                if CASHFLOW_QUARTER_NEED_COUNT:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        current_cash_flow_operating = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[0])
                        previous_cash_flow_operating = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[1])
                        cash_flow_operating = current_cash_flow_operating - previous_cash_flow_operating
                        result_data[11][i - 1] = cash_flow_operating
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_operating = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[2])
                        previous_cash_flow_operating = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[1])
                        cash_flow_operating = current_cash_flow_operating - previous_cash_flow_operating
                        result_data[11][i - 1] = cash_flow_operating
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
                else:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):            
                        result_data[11][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[0])
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_operating = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[2])
                        previous_cash_flow_operating = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[1])
                        cash_flow_operating = current_cash_flow_operating - previous_cash_flow_operating
                        result_data[11][i - 1] = cash_flow_operating
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
            else:
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None



            # Get net cash provided by investing activities 
            # No information of cash flow in current quarter period! Only accululated value is provided!
            # Need some calculation to get cash flow in the quarter period
            if(check_report_type(reports_sorted[i - 1][0]) == "K"):
                # Q1
                result_data[12][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[0])


            elif(check_report_type(reports_sorted[i - 1][0]) == "Q"):
                if CASHFLOW_QUARTER_NEED_COUNT:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        current_cash_flow_investing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[0])
                        previous_cash_flow_investing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[1])
                        cash_flow_investing = current_cash_flow_investing - previous_cash_flow_investing
                        result_data[12][i - 1] = cash_flow_investing
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_investing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[2])
                        previous_cash_flow_investing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[1])
                        cash_flow_investing = current_cash_flow_investing - previous_cash_flow_investing
                        result_data[12][i - 1] = cash_flow_investing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
                else:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        result_data[12][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[0])
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_investing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[2])
                        previous_cash_flow_investing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[1])
                        cash_flow_investing = current_cash_flow_investing - previous_cash_flow_investing
                        result_data[12][i - 1] = cash_flow_investing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
            else:
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None




            # Get net cash provided by financing activities 
            # No information of cash flow in current quarter period! Only accululated value is provided!
            # Need some calculation to get cash flow in the quarter period
            if(check_report_type(reports_sorted[i - 1][0]) == "K"):
                # First quarter
                result_data[13][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[0])

            elif(check_report_type(reports_sorted[i - 1][0]) == "Q"):
                if CASHFLOW_QUARTER_NEED_COUNT:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        current_cash_flow_financing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[0])
                        previous_cash_flow_financing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[1])
                        cash_flow_financing = current_cash_flow_financing - previous_cash_flow_financing
                        result_data[13][i - 1] = cash_flow_financing
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_financing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[2])
                        previous_cash_flow_financing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[1])
                        cash_flow_financing = current_cash_flow_financing - previous_cash_flow_financing
                        result_data[13][i - 1] = cash_flow_financing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
                else:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        result_data[13][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[0])
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_financing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[2])
                        previous_cash_flow_financing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[1])
                        cash_flow_financing = current_cash_flow_financing - previous_cash_flow_financing
                        result_data[13][i - 1] = cash_flow_financing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
            else:
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None




            # Calculate some important indicator based on the gotten data
            # Gross margin
            # Gross profit / Revenue * 100%
            gross_margin = np.round(result_data[7][i - 1] / result_data[6][i - 1] * 100, 2) if (not np.isnan(result_data[7][i - 1]) and not np.isnan(result_data[6][i - 1]) and result_data[6][i - 1] != 0) else np.nan
            result_data[14][i - 1] = gross_margin


            # Operating margin
            # Earning before provision for taxes on income / Revenue * 100%
            operating_margin = np.round(result_data[8][i - 1] / result_data[6][i - 1] * 100, 2) if (not np.isnan(result_data[8][i - 1]) and not np.isnan(result_data[6][i - 1]) and result_data[6][i - 1] != 0) else np.nan
            result_data[15][i - 1] = operating_margin


            # Net income margin
            # Net income / Revenue * 100%
            net_income_margin = np.round(result_data[9][i - 1] / result_data[6][i - 1] * 100, 2) if (not np.isnan(result_data[9][i - 1]) and not np.isnan(result_data[6][i - 1]) and result_data[6][i - 1] != 0) else np.nan
            result_data[16][i - 1] = net_income_margin


            # Days inventory
            # (Revenues - Gross profit) / inventories
            days_inventory = np.round(365 * result_data[1][i - 1] / (result_data[6][i - 1] - result_data[7][i - 1]), 2) if (not np.isnan(result_data[1][i - 1]) and not np.isnan(result_data[7][i - 1]) and not np.isnan(result_data[6][i - 1]) and (result_data[6][i - 1] - result_data[7][i - 1] != 0)) else np.nan
            result_data[17][i - 1] = days_inventory


            # Return on assets
            # Net income / Assets * 100%
            ROA = np.round(result_data[9][i - 1] / result_data[0][i - 1] * 100, 2) if (not np.isnan(result_data[9][i - 1]) and not np.isnan(result_data[0][i - 1]) and result_data[0][i - 1] != 0) else np.nan
            result_data[18][i - 1] = ROA

            # Return on equity
            # Net income / Total stockholder's equity * 100%
            ROE = np.round(result_data[9][i - 1] / result_data[3][i - 1] * 100, 2) if (not np.isnan(result_data[9][i - 1]) and not np.isnan(result_data[3][i - 1]) and result_data[3][i - 1] != 0) else np.nan
            result_data[19][i - 1] = ROE

        result = pd.DataFrame(data = result_data, index = result_index, columns = result_columns)
        #result = result.round(2) -> does't work
        #result = result.apply(lambda x : "%.2f" % x, axis = 1) -> TypeError: cannot convert the series to <class 'float'>
        result = result.apply(lambda x : x.apply("{0:.2f}".format))  #-> OK; df.apply: Invoke function to series, not values!  series.apply: Invoke function on values of series! 
        #print("Data process finished")
        update_msg("Data process finished." if IS_ENGLISH else "資料處理完成。")
        return result
    
    
    elif(industry_type == "F"):
        #print("Financial industry")
        # Settings of pandas's dataframe
        
        result_columns = []  # Quarter date
        result_index = []
        
        if IS_ENGLISH:
            result_index = ["Assets", "Liabilities", "Total stockholder's equity",
                            "Risk weighted assets", 
                            "Total loans", "Non-performing loans", "Allowance for loan and lease losses",
                            "Total investment","Earning per share basic", "Earning per share diluted",
                             "Revenue", "Gross Profit", "Earning before provision for taxes on income", "Net income",
                            "Comprehensive income net of tax",
                            "Net cash from operating activities", "Net cash from investing activities", "Net cash from financing activities",
                            "Gross margin (%)", "Operating margin (%)", "Net income margin (%)", "Non-performing loans ratio (%)", "Capital adequacy ratio (%)",
                            "Coverage ratio (%)", "Return on assets (%)", "Return on equity (%)"]
        else:
            result_index = ["總資產", "總負債", "股東權益",
                            "風險性資產總額", 
                            "放款總額", "逾期放款", "放款備抵呆帳",
                            "總投資","基本每股盈餘", "稀釋每股盈餘",
                             "營業收入", "毛利", "稅前淨利", "淨收入",
                            "綜合收入",
                            "營業活動現金流量", "投資活動現金流量", "融資活動現金流量",
                            "毛利率 (%)", "營業利益率 (%)", "稅後淨利率 (%)", "逾期放款比率 (%)", "資本適足率 (%)",
                            "備抵呆帳覆蓋率 (%)", "資產報酬率 (%)", "股東權益報酬率 (%)"]
            
        result_data = [[0] * (len(reports) - 1) for _ in range(len(result_index))]
        
        #print(len(reports_sorted))





        # Extract data from the above tables version 2
        # Probably no 9 reports will be gotten!
        for i in range(1, len(reports)):
            # Add quarter date
            result_columns.append(reports_sorted[i][2].date())


            # Get assets
            result_data[0][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:Assets$", None, position[0])


#             # Get inventories
#             result_data[1][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:InventoryNet$", "true", position[0])


            # Get liabilities (May need to be calculated!)
            result_data[1][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:Liabilities$", None, position[0])



            # Get total stockholder's equity (May need to be calculated!)
            if not np.isnan(extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity$|^us-gaap:StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest$", None, position[0])):
                result_data[2][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity$|^us-gaap:StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest$", None, position[0])
            #elif not np.isnan(extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity", None, position[0])):
                #result_data[2][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:StockholdersEquity", None, position[0])
            else:
                result_data[2][i - 1] = np.nan
            
            
            # Calculate liabilities or stockholder's equity

            for j in range(len(reports) - 1):
                if(not np.isnan(result_data[0][j]) and np.isnan(result_data[1][j]) and not np.isnan(result_data[2][j])):
                    result_data[1][j] = result_data[0][j] - result_data[2][j]
                elif(not np.isnan(result_data[0][j]) and not np.isnan(result_data[1][j]) and np.isnan(result_data[2][j])):
                    result_data[2][j] = result_data[0][j] - result_data[1][j]
                else:
                    pass
            
            # Get risk-weighted assets (under Basel 3 standardized)
            result_data[3][i - 1] = extract_data(table_risk_weighted_assets[i][1], r"^us-gaap:RiskWeightedAssets$", None, position[0])
            
            
            # Get total loans
            result_data[4][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:FinancingReceivableExcludingAccruedInterestAfterAllowanceForCreditLoss$|^us-gaap:NotesReceivableNet$", None, position[0])
            
            
            # Get nonperforming loans
            result_data[5][i - 1] = extract_data(table_credit_quality[i][1], r"^us-gaap:FinancingReceivableExcludingAccruedInterestNonaccrual$|^us-gaap:FinancingReceivableRecordedInvestmentNonaccrualStatus$", None, position_nonperforming_loans)            
            # If data is not in table (with ix:nonfraction tag wrapped, the data may not be referenced)
#             if RISK_WEIGHTED_ASSETS_NOT_IN_TABLE:  
#                 pass
#             else:
        
            # Get allowance for loan and lease losses
            #print("allowance for loan")
            result_data[6][i - 1] = np.absolute(extract_data(table_balances[i][1], r"^us-gaap:FinancingReceivableAllowanceForCreditLossExcludingAccruedInterest$|^us-gaap:FinancingReceivableAllowanceForCreditLosses$", None, position[0]))
            
            
            
            # Get total investment (for insurance industry)
            result_data[7][i - 1] = extract_data(table_balances[i][1], r"^us-gaap:Investments$", None, position[0])                           

#             # Get Tier 1 capital (approximately equal to total stockholder's equity)
#             # Tier 1 capital = shareholder's equity(preferred stock + common stock) + retained earnings
#             preferred_stock = extract_data(table_balances[i][1], r"^us-gaap:RetainedEarnings", None, position[0])
#             retained_earnings = extract_data(table_balances[i][1], r"^us-gaap:RetainedEarnings", None, position[0])
#             result_data[3][i - 1] = result_data[2][i - 1] + retained_earnings

#             Calculate liabilities or stockholder's equity -- version 1

#             for j in range(8):
#                 if(not np.isnan(result_data[0][j]) and np.isnan(result_data[2][j]) and not np.isnan(result_data[3][j])):
#                     result_data[2][j] = result_data[0][j] - result_data[3][j]
#                 elif(not np.isnan(result_data[0][j]) and not np.isnan(result_data[2][j]) and np.isnan(result_data[3][j])):
#                     result_data[3][j] = result_data[0][j] - result_data[2][j]
#                 else:
#                     pass

#             # Calculate liabilities or stockholder's equity -- version 2
#             """
#             if(not np.isnan(result_data[0][i - 1]) and np.isnan(result_data[2][i - 1]) and not np.isnan(result_data[3][i - 1])):
#                 result_data[2][i - 1] = result_data[0][i - 1] - result_data[3][i - 1]
#             elif(not np.isnan(result_data[0][i - 1]) and not np.isnan(result_data[2][i - 1]) and np.isnan(result_data[3][i - 1])):
#                 result_data[3][i - 1] = result_data[0][i - 1] - result_data[2][i - 1]
#             else:
#                 pass
#             """



            # Difference between 10-K and 10-Q reports
            if(check_report_type(reports_sorted[i][0]) == "Q"):

                # Get EPS (basic)
                result_data[8][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareBasic$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[0])

                # Get EPS (diluted)
                result_data[9][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareDiluted$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[0])

                # Get revenues                
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[0])):                    
                    result_data[10][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[0])):
                    result_data[10][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[0])
                else:
                    result_data[10][i - 1] = np.nan



                # Get gross profit (May need to be calculated)
                cost_of_revenue = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", "true", position_income[0])):
                    cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", None, position_income[0])):
                    cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", None, position_income[0])
                else:
                    pass
                
                gross_profit = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[0])):
                    gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[0])):
                    gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[0])
                else:
                    pass
                
                if not np.isnan(gross_profit):
                    result_data[11][i - 1] = gross_profit 
                elif not np.isnan(result_data[10][i - 1]) and not np.isnan(cost_of_revenue):
                    result_data[11][i - 1] = result_data[10][i - 1] - cost_of_revenue
                else:
                    result_data[11][i - 1] = np.nan

                    
                # Get Income before provision for income taxes
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[0])):
                    result_data[12][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[0])):
                    result_data[12][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[0])
                else:
                    result_data[12][i - 1] = np.nan


                # Get net income
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[0])):
                    result_data[13][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[0])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[0])):
                    result_data[13][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[0])
                else:
                    result_data[13][i - 1] = np.nan


                # Get comprehensive income net of tax
                if not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[0])):
                    result_data[14][i - 1] = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[0])
                elif not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[0])):
                    result_data[14][i - 1] = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[0])
                else:
                    result_data[14][i - 1] = np.nan

            elif(check_report_type(reports_sorted[i][0]) == "K"):

                # Get EPS (basic)
                result_data[8][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareBasic$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[2])

                # Get EPS (diluted)
                result_data[9][i - 1] = extract_data(table_operations[i][1], r"^us-gaap:EarningsPerShareDiluted$|^us-gaap:EarningsPerShareBasicAndDiluted$", None, position_income[2])


                # Get revenues (Need to get data from the previous quarter report, then calculate it)
                # 1. Get nine months accumulated data
                previous_revenues = 0
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[1])):
                    previous_revenues = extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None, position_income[1])):
                    previous_revenues = extract_data(table_operations[i - 1][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None , position_income[1])
                else:
                    pass


                # 2. Get revenues of whole fiscal year
                year_revenues = 0
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[2])):
                    year_revenues = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None , position_income[2])):
                    year_revenues = extract_data(table_operations[i][1], r"^us-gaap:Revenues$|^us-gaap:RevenueFromContractWithCustomerExcludingAssessedTax$|^us-gaap:RevenuesNetOfInterestExpense$|^us-gaap:RevenueFromContractWithCustomerIncludingAssessedTax$|^us-gaap:OperatingLeaseLeaseIncome$", None , position_income[2])
                else:
                    pass
                

                # 3. Calculate revenue from the above values
                revenues = year_revenues - previous_revenues
                result_data[10][i - 1] = revenues


                # Get gross profit (Need to get data from the previous quarter report, then calculate it)
                previous_gross_profit = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", "true", position_income[1])):
                    previous_gross_profit = extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", None, position_income[1])):
                    previous_gross_profit = extract_data(table_operations[i - 1][1], r"^us-gaap:GrossProfit$", None, position_income[1])
                else:
                    pass
                
                
                year_gross_profit = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[2])):
                    year_gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", None, position_income[2])):
                    year_gross_profit = extract_data(table_operations[i][1], r"^us-gaap:GrossProfit$", None, position_income[2])
                else:
                    pass
                
                
                gross_profit = np.nan
                if not np.isnan(year_gross_profit) and not np.isnan(previous_gross_profit):
                    gross_profit = year_gross_profit - previous_gross_profit
                else:
                    pass
                
                
                previous_cost_of_revenue = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$", "true", position_income[1])):
                    previous_cost_of_revenue = extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$", None, position_income[1])):
                    previous_cost_of_revenue = extract_data(table_operations[i - 1][1], r"^us-gaap:CostOfRevenue$", None, position_income[1])
                else:
                    pass
                
                
                year_cost_of_revenue = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", "true", position_income[2])):
                    year_cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", None, position_income[2])):
                    year_cost_of_revenue = extract_data(table_operations[i][1], r"^us-gaap:CostOfRevenue$", None, position_income[2])
                else:
                    pass
                
                
                cost_of_revenue = np.nan
                if not np.isnan(year_cost_of_revenue) and not np.isnan(previous_cost_of_revenue):                    
                    cost_of_revenue = year_cost_of_revenue - previous_cost_of_revenue
                else:
                    pass

                
                if not np.isnan(gross_profit):
                    result_data[11][i - 1] = gross_profit 
                elif not np.isnan(result_data[10][i - 1]) and not np.isnan(cost_of_revenue):
                    result_data[11][i - 1] = result_data[10][i - 1] - cost_of_revenue
                else:
                    result_data[11][i - 1] = np.nan



                # Get Income before provision for income taxes
                previous_income_before_tax = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[1])):
                    previous_income_before_tax = extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[1])):
                    previous_income_before_tax = extract_data(table_operations[i - 1][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[1])
                else:
                    pass
                
                year_income_before_tax = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[2])):
                    year_income_before_tax = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[2])):
                    year_income_before_tax = extract_data(table_operations[i][1], r"^us-gaap:IncomeLossFromContinuingOperationsBeforeIncomeTaxes|^us-gaap:IncomeLossAttributableToParent$|:EarningsBeforeIncomeTaxes$", None, position_income[2])
                else:
                    pass
                
                if not np.isnan(year_income_before_tax) and not np.isnan(previous_income_before_tax):
                    result_data[12][i - 1] = year_income_before_tax - previous_income_before_tax
                else:
                    result_data[12][i - 1] = np.nan


                # Get net income
                previous_income = np.nan
                if not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[1])):
                    previous_income = extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[1])
                elif not np.isnan(extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[1])):
                    previous_income = extract_data(table_operations[i - 1][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[1])
                else:
                    pass
                
                year_income = np.nan
                if not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[2])):
                    year_income = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", "true", position_income[2])
                elif not np.isnan(extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[2])):
                    year_income = extract_data(table_operations[i][1], r"^us-gaap:NetIncomeLoss$|^us-gaap:NetIncomeLossAvailableToCommonStockholdersBasic$|^us-gaap:ProfitLoss$|^us-gaap:IncomeLossFromContinuingOperationsIncludingPortionAttributableToNoncontrollingInterest$", None, position_income[2])
                else:
                    pass
                
                
                if not np.isnan(year_income) and not np.isnan(previous_income):
                    result_data[13][i - 1] = year_income - previous_income
                else:
                    result_data[13][i - 1] = np.nan


                # Get comprehensive income net of tax
                previous_comprehensive_income = np.nan
                if not np.isnan(extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[1])):
                    previous_comprehensive_income = extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[1])
                elif not np.isnan(extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[1])):
                    previous_comprehensive_income = extract_data(table_comprehensive_income[i - 1][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[1])
                else:
                    pass
                
                year_comprehensive_income = np.nan
                if not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[2])):
                    year_comprehensive_income = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", "true", position_comprehensive[2])
                elif not np.isnan(extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[2])):
                    year_comprehensive_income = extract_data(table_comprehensive_income[i][1], r"^us-gaap:ComprehensiveIncomeNetOfTax$|^us-gaap:ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest$", None, position_comprehensive[2])
                else:
                    pass
                
                
                if not np.isnan(year_comprehensive_income) and not np.isnan(previous_comprehensive_income):
                    result_data[14][i - 1] = year_comprehensive_income - previous_comprehensive_income
                else:
                    result_data[14][i - 1] = np.nan

            else:
                #print("Something wrong after filtering and sorting")
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None



            # Get net cash provided by operating activities 
            # No information of cash flow in current quarter period! Only accululated value is provided! Have special case!
            # Need some calculation to get cash flow in the quarter period
            if(check_report_type(reports_sorted[i - 1][0]) == "K"):
                # First quarter
                result_data[15][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[0])
                #print("Cash flow here!")
            elif(check_report_type(reports_sorted[i - 1][0]) == "Q"):
                if CASHFLOW_QUARTER_NEED_COUNT:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        current_cash_flow_operating = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[0])
                        previous_cash_flow_operating = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[1])
                        cash_flow_operating = current_cash_flow_operating - previous_cash_flow_operating
                        result_data[15][i - 1] = cash_flow_operating
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_operating = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[2])
                        previous_cash_flow_operating = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[1])
                        cash_flow_operating = current_cash_flow_operating - previous_cash_flow_operating
                        result_data[15][i - 1] = cash_flow_operating
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
                else:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):            
                        result_data[15][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[0])
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_operating = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[2])
                        previous_cash_flow_operating = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInOperatingActivities", None, position_cash_flow[1])
                        cash_flow_operating = current_cash_flow_operating - previous_cash_flow_operating
                        result_data[15][i - 1] = cash_flow_operating
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
            else:
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None
                #print(check_report_type(reports_sorted[i - 1][0]))
                #print(reports_sorted[i - 1][2])



            # Get net cash provided by investing activities 
            # No information of cash flow in current quarter period! Only accululated value is provided!
            # Need some calculation to get cash flow in the quarter period
            if(check_report_type(reports_sorted[i - 1][0]) == "K"):
                # Q1
                result_data[16][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[0])


            elif(check_report_type(reports_sorted[i - 1][0]) == "Q"):
                if CASHFLOW_QUARTER_NEED_COUNT:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        current_cash_flow_investing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[0])
                        previous_cash_flow_investing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[1])
                        cash_flow_investing = current_cash_flow_investing - previous_cash_flow_investing
                        result_data[16][i - 1] = cash_flow_investing
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_investing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[2])
                        previous_cash_flow_investing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[1])
                        cash_flow_investing = current_cash_flow_investing - previous_cash_flow_investing
                        result_data[16][i - 1] = cash_flow_investing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
                else:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        result_data[16][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[0])
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_investing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[2])
                        previous_cash_flow_investing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInInvestingActivities", None, position_cash_flow[1])
                        cash_flow_investing = current_cash_flow_investing - previous_cash_flow_investing
                        result_data[16][i - 1] = cash_flow_investing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
            else:
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None




            # Get net cash provided by financing activities 
            # No information of cash flow in current quarter period! Only accululated value is provided!
            # Need some calculation to get cash flow in the quarter period
            if(check_report_type(reports_sorted[i - 1][0]) == "K"):
                # First quarter
                result_data[17][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[0])

            elif(check_report_type(reports_sorted[i - 1][0]) == "Q"):
                if CASHFLOW_QUARTER_NEED_COUNT:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        current_cash_flow_financing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[0])
                        previous_cash_flow_financing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[1])
                        cash_flow_financing = current_cash_flow_financing - previous_cash_flow_financing
                        result_data[17][i - 1] = cash_flow_financing
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_financing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[2])
                        previous_cash_flow_financing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[1])
                        cash_flow_financing = current_cash_flow_financing - previous_cash_flow_financing
                        result_data[17][i - 1] = cash_flow_financing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
                else:
                    if(check_report_type(reports_sorted[i][0]) == "Q"):
                        result_data[17][i - 1] = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[0])
                    elif(check_report_type(reports_sorted[i][0]) == "K"):
                        current_cash_flow_financing = extract_data(table_cashflows[i][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[2])
                        previous_cash_flow_financing = extract_data(table_cashflows[i - 1][1], r"^us-gaap:NetCashProvidedByUsedInFinancingActivities", None, position_cash_flow[1])
                        cash_flow_financing = current_cash_flow_financing - previous_cash_flow_financing
                        result_data[17][i - 1] = cash_flow_financing
                    else:
                        update_msg("Something wrong when extracting data of cash flows from 10-K report" if IS_ENGLISH else "處理10-K財報之現金流量出現問題。")
            else:
                update_msg("Reports' data not extractable. Please try another company." if IS_ENGLISH else "財報資料無法取得。請輸入其他公司。")
                return None




            # Calculate some important indicator based on the gotten data
            # Gross margin
            # Gross profit / Revenue * 100%
            gross_margin = np.round(result_data[11][i - 1] / result_data[10][i - 1] * 100, 2) if (not np.isnan(result_data[11][i - 1]) and not np.isnan(result_data[10][i - 1]) and result_data[10][i - 1] != 0) else np.nan
            result_data[18][i - 1] = gross_margin


            # Operating margin
            # Earning before provision for taxes on income / Revenue * 100%
            operating_margin = np.round(result_data[12][i - 1] / result_data[10][i - 1] * 100, 2) if (not np.isnan(result_data[12][i - 1]) and not np.isnan(result_data[10][i - 1]) and result_data[10][i - 1] != 0) else np.nan
            result_data[19][i - 1] = operating_margin


            # Net income margin
            # Net income / Revenue * 100%
            net_income_margin = np.round(result_data[13][i - 1] / result_data[10][i - 1] * 100, 2) if (not np.isnan(result_data[13][i - 1]) and not np.isnan(result_data[10][i - 1]) and result_data[10][i - 1] != 0) else np.nan
            result_data[20][i - 1] = net_income_margin
            
            
            # Non-performing lonas ratio
            # Non-performing loans / Total loans * 100%
            non_performing_loans_ratio = np.round(result_data[5][i - 1] / result_data[4][i - 1] * 100, 2) if (not np.isnan(result_data[5][i - 1]) and not np.isnan(result_data[4][i - 1]) and result_data[4][i - 1] != 0) else np.nan
            result_data[21][i - 1] = non_performing_loans_ratio
            
            
            # Capital adequacy ratio
            # (Tier 1 capital + Tier 2 capital) / Risk weighted assets * 100% = Total stockholder's equity / Risk weighted assets * 100%
            capital_adequacy_ratio = np.round(result_data[2][i - 1] / result_data[3][i - 1] * 100, 2) if (not np.isnan(result_data[2][i - 1]) and not np.isnan(result_data[3][i - 1]) and result_data[3][i - 1] != 0) else np.nan
            result_data[22][i - 1] = capital_adequacy_ratio
            
            
            # Coverage ratio
            # Allowance for loan and lease losses / Non-performing loans * 100%
            coverage_ratio = np.round(result_data[6][i - 1] / result_data[5][i - 1] * 100, 2) if (not np.isnan(result_data[6][i - 1]) and not np.isnan(result_data[5][i - 1]) and result_data[5][i - 1] != 0) else np.nan
            result_data[23][i - 1] = coverage_ratio


#             # Days inventory
#             # (Revenues - Gross profit) / inventories
#             days_inventory = np.round((result_data[6][i - 1] - result_data[7][i - 1]) / result_data[1][i - 1], 2) if (not np.isnan(result_data[6][i - 1]) and not np.isnan(result_data[7][i - 1]) and not np.isnan(result_data[1][i - 1]) and result_data[1][i - 1] != 0) else np.nan
#             result_data[17][i - 1] = days_inventory


            # Return on assets
            # Net income / Assets * 100%
            ROA = np.round(result_data[13][i - 1] / result_data[0][i - 1] * 100, 2) if (not np.isnan(result_data[13][i - 1]) and not np.isnan(result_data[0][i - 1]) and result_data[0][i - 1] != 0) else np.nan
            result_data[24][i - 1] = ROA

            # Return on equity
            # Net income / Total stockholder's equity * 100%
            ROE = np.round(result_data[13][i - 1] / result_data[2][i - 1] * 100, 2) if (not np.isnan(result_data[13][i - 1]) and not np.isnan(result_data[2][i - 1]) and result_data[2][i - 1] != 0) else np.nan
            result_data[25][i - 1] = ROE

            
        
        result = pd.DataFrame(data = result_data, index = result_index, columns = result_columns)
        result = result.apply(lambda x : x.apply("{0:.2f}".format))  #-> OK; df.apply: Invoke function to series, not values!  series.apply: Invoke function on values of series! 
        update_msg("Data process finished." if IS_ENGLISH else "資料處理完成。")
        return result
        
        
    else:
        update_msg("Unknown industry type?!" if IS_ENGLISH else "未知的產業類別？")
        return None


# Section 3: Plot 4 figures using seaborn package according to the above dataframe
def plot_data(result, industry_type, company_name, stop_flag = None):

    
    result = result.astype("float64", copy = True)
    #print(df.dtypes)
    
    # Create a new folder of the company's name
    current_date = datetime.now().strftime("%Y-%m-%d")
    folder_name = r"results\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name)
    if not os.path.isdir(folder_name):
        os.mkdir(folder_name)
    else:
        pass
    
    
    # Setting Chinese / English font
    if not IS_ENGLISH:
        plt.rcParams['font.sans-serif'] = ['Taipei Sans TC Beta']
    
    
    if(industry_type == 'N'):
        #rint("Industry:", industry_type)
        
        # Figure 1: Liabilities and Stockholder's equity stacked barchart (summation is assets)
        fig1 = plt.subplot(111)
        fig1.yaxis.set_major_locator(MaxNLocator(10))  # Max number of labels in y axis
        #fig1.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis

        
        x = list(result.columns)  # x labels (quarter date)
        x_temp = np.arange(len(x))
        #x = [1,2,3,4,5,6,7,8]

        Liabilities = result.loc['Liabilities', :] if IS_ENGLISH else result.loc['總負債', :]
        Equity = result.loc["Total stockholder's equity", :] if IS_ENGLISH else result.loc['股東權益', :]
        #print(Liabilities)
        #print(Equity)

        plt.bar(x_temp, Liabilities, color='blue', width=0.5, zorder=3, label = "Liabilities" if IS_ENGLISH else "總負債")
        #plt.ylabel("Liabilities") if IS_ENGLISH else plt.ylabel("總負債")
        
        plt.bar(x_temp,Equity,color='green',label="Total stockholder's equity" if IS_ENGLISH else "股東權益", width=0.5, bottom=Liabilities, zorder=3)
        plt.title("Company's balance\n(" + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title("公司負債與股東權益\n(" + company_name + ")", fontsize=18)
        plt.xticks(rotation=45)
        plt.xticks(x_temp, x)
        plt.ylabel('USD')
        plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')
        plt.grid(axis='y')
        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Liabilities and Stockholder's equity.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()

        
        # Break point
        if(stop_flag.is_set()):
            return None




        # Figure 2: Cash flow stacked barchart
        fig2 = plt.subplot(111)
        fig2.yaxis.set_major_locator(MaxNLocator(10)) # Max number of labels in y axis
        #fig2.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis
        
        operating =  result.loc['Net cash from operating activities', :] if IS_ENGLISH else result.loc['營業活動現金流量', :]

        investing = result.loc['Net cash from investing activities', :] if IS_ENGLISH else result.loc['投資活動現金流量', :]

        financing = result.loc['Net cash from financing activities', :] if IS_ENGLISH else result.loc['融資活動現金流量', :]

        plt.bar(x_temp, operating, color='blue', label='Net cash from\noperating activities' if IS_ENGLISH else "營業活動現金流量", width=0.5, zorder=3)

        # Stack upward or downward depends on the sign of value. Downward for negative values
        # Reference: https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.bar.html
        baseline = []



        # Setting baseline for stacking investing values
        for idx in range(len(result.columns)):
            if(investing[idx] < 0):
                if(operating[idx] < 0):
                    baseline.append(operating[idx]) 
                else:
                    baseline.append(0) 
            else:
                if(operating[idx] < 0):
                    baseline.append(0) 
                else:
                    baseline.append(operating[idx]) 


        plt.bar(x_temp, investing, color='green',label='Net cash from\ninvesting activities' if IS_ENGLISH else "投資活動現金流量", width=0.5, zorder=3, bottom=baseline)



        baseline2 = []
        for idx in range(len(result.columns)):

            # Same sign of investing value and financing value (++ or --)
            if(investing[idx]*financing[idx] >= 0):
                if(operating[idx]*investing[idx] >= 0):                    
                    baseline2.append(investing[idx] + operating[idx])
                else:
                    baseline2.append(investing[idx])

            # Different sign of investing and financing value (+- or -+)
            else:

                # Same sign of investing value and operating value (++ or --)
                if(operating[idx]*investing[idx] >= 0):
                    baseline2.append(0)
                    #print('second')

                # Different sign of investing and operating value (+- or -+)    
                else:
                    baseline2.append(operating[idx])
                    #print('third')
                    #print(operating[idx]*investing[idx])

        plt.bar(x_temp, financing, color='gray', label='Net cash from\nfinancing activities' if IS_ENGLISH else "融資活動現金流量", width=0.5, zorder=3, bottom=baseline2)

        plt.title('Cash flows\n(' + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title('現金流量\n(' + company_name + ")", fontsize=18)
        plt.xticks(rotation=45)
        plt.xticks(x_temp, x)
        plt.ylabel('USD')
        plt.legend(bbox_to_anchor=(1.02, 0.7), loc='upper left')
        plt.grid(axis='y')
        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Cash flows.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()

        
        # Break point
        if(stop_flag.is_set()):
            return None


        # Figure 3: Operating circumstance
        fig3 = plt.subplot(111)
        fig3.yaxis.set_major_locator(MaxNLocator(10)) # Max number of labels in y axis
        #fig3.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis
        
        plt.xticks(rotation=45)  # Need to place this setting before plotting or interpreter will confuse

        revenue = result.loc['Revenue', :] if IS_ENGLISH else result.loc['營業收入', :]
        gross_profit = result.loc['Gross profit', :] if IS_ENGLISH else result.loc['毛利', :]
        net_income = result.loc['Net income', :] if IS_ENGLISH else result.loc['淨收入', :]
        comprehensive_income = result.loc['Comprehensive income net of tax', :] if IS_ENGLISH else result.loc['綜合收入', :]         
        other_income = comprehensive_income - net_income
        days_inventory = result.loc['Days Inventory (days)', :] if IS_ENGLISH else result.loc['存貨周轉天數 (天)', :]

        #x_temp = np.arange(len(x))

        br1 = plt.bar(x_temp - 0.2, revenue, color='blue',label='Revenues' if IS_ENGLISH else "營業收入", width=0.6, zorder=2, alpha = 0.85)
        br2 = plt.bar(x_temp - 0.2, gross_profit, color='green',label='Gross profit' if IS_ENGLISH else "毛利", width=0.6, zorder=2, alpha = 0.85) if (not gross_profit.isna().all()) else None
        br3 = plt.bar(x_temp - 0.2, net_income, color='orange',label='Net income' if IS_ENGLISH else "淨收入", width=0.6, zorder=3, alpha = 0.85)
        br4 = plt.bar(x_temp + 0.2, other_income, color='brown',label='Other income' if IS_ENGLISH else "其他收入", width=0.4, zorder=1, alpha = 0.85)



        # Double y axes
        fig3_1 = fig3.twinx()
        ln1 = fig3_1.plot(x_temp, days_inventory, color='red', marker='D',label='Days inventory' if IS_ENGLISH else "其他收入") if (not days_inventory.isna().all()) else None

        plt.xticks(x_temp, x)

        plt.title("Operating circumstances\n(" + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title("營運狀況\n(" + company_name + ")", fontsize=18)

        #plt.ylabel('Million USD')


        fig3.set_ylabel('USD')
        fig3_1.set_ylabel('Days')

        #print(type(br1))

        #brs_lns = br1 + br2 + br3 + br4 + ln1
        #brs_lns = list(br1) + ln1
        #brs_lns = [br1, br2, br3, br4] + ln1        
        #labels = [bl.get_label() for bl in brs_lns]
        
        brs_lns = [br1, br3, br4] + (ln1 if ln1 else [])
        if br2:
            brs_lns.append(br2)
        else:
            pass
        
        plt.legend(handles = brs_lns, bbox_to_anchor=(1.2,0.7), loc='upper left')
        #plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')

        plt.grid(axis='y')

        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Operating circumstances.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()

        
        # Break point
        if(stop_flag.is_set()):
            return None


        # Figure 4: Competitiveness
        gross_margin = result.loc['Gross margin (%)', :] if IS_ENGLISH else result.loc['毛利率 (%)', :]
        operating_margin = result.loc['Operating margin (%)', :] if IS_ENGLISH else result.loc['營業利益率 (%)', :]
        net_income_margin = result.loc['Net income margin (%)', :] if IS_ENGLISH else result.loc['稅後淨利率 (%)', :]


        fig4 = plt.subplot(111)
        fig4.yaxis.set_major_locator(MaxNLocator(10))
        #fig4.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis

        fig4.plot(x_temp,gross_margin,color='blue', marker='o',label='Gross margin (%)' if IS_ENGLISH else "毛利率 (%)") if (not gross_margin.isna().all()) else None
        fig4.plot(x_temp,operating_margin,color='green', marker='o',label='Operating margin (%)' if IS_ENGLISH else "營業利益率 (%)")
        fig4.plot(x_temp,net_income_margin,color='orange', marker='o',label='Net income margin (%)' if IS_ENGLISH else "稅後淨利率 (%)")

        fig4.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')
        fig4.grid(axis='y')
        plt.xticks(rotation=45)
        plt.xticks(x_temp, x)
        plt.title('Competitiveness\n(' + company_name + ')', fontsize=18) if IS_ENGLISH else plt.title('競爭力\n(' + company_name + ')', fontsize=18)
        fig4.set_ylabel('%')
        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Competitiveness.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()



        # Break point
        if(stop_flag.is_set()):
            return None
        
        

        # Figure 5: Investment return
        fig5 = plt.subplot(111)
        fig5.yaxis.set_major_locator(MaxNLocator(10))
        #fig5.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis
        plt.xticks(rotation=45)

        earning_per_share_basic = result.loc['Earning per share basic', :] if IS_ENGLISH else result.loc["基本每股盈餘", :]
        earning_per_share_diluted = result.loc['Earning per share diluted', :] if IS_ENGLISH else result.loc["稀釋每股盈餘", :]
        return_on_assets = result.loc['Return on assets (%)', :] if IS_ENGLISH else result.loc["資產報酬率 (%)", :]
        return_on_equity = result.loc['Return on equity (%)', :] if IS_ENGLISH else result.loc["股東權益報酬率 (%)", :]

        ln1 = plt.plot(x_temp,earning_per_share_basic,color='blue', marker='o',label='Earning per share\n(basic)' if IS_ENGLISH else "基本每股盈餘")
        ln2 = plt.plot(x_temp,earning_per_share_diluted,color='green', marker='o',label='Earning per share\n(diluted)' if IS_ENGLISH else "稀釋每股盈餘")


        # Double y axes
        fig5_1 = fig5.twinx()
        ln3 = fig5_1.plot(x_temp, return_on_assets, color='orange', marker='D',label='Return on assets' if IS_ENGLISH else "資產報酬率 (%)")
        ln4 = fig5_1.plot(x_temp, return_on_equity, color='brown', marker='D',label='Return on equity' if IS_ENGLISH else "股東權益報酬率 (%)")

        plt.xticks(x_temp, x)

        plt.title("Investment return\n(" + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title("投資回報\n(" + company_name + ")", fontsize=18)




        fig5.set_ylabel('EPS (USD)')
        fig5_1.set_ylabel('Return (%)')

        #print(type(br1))

        #brs_lns = br1 + br2 + br3 + br4 + ln1
        #brs_lns = list(br1) + ln1
        lns = ln1 + ln2 + ln3 + ln4
        #labels = [bl.get_label() for bl in brs_lns]
        plt.legend(handles = lns, bbox_to_anchor=(1.2,0.7), loc='upper left')
        #plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')

        plt.grid(axis='y')

        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Investment return.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()
        
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        # Save the financial statements as .csv
        result.to_csv(folder_name + "\\" + "Financial Statements.csv", encoding = "utf-8")
        
        update_msg("Financial statements and their visualization are saved successfully!" if IS_ENGLISH else "財報圖表已成功儲存完畢！")
        #print("plot_data的folder_name:", folder_name)
        return (folder_name, company_name)
    
    
        
        
        
    elif(industry_type == 'F'):
        #print("Financial industry")
        
        # Figure 1: Liabilities and Stockholder's equity stacked barchart (summation is assets)
        fig1 = plt.subplot(111)
        fig1.yaxis.set_major_locator(MaxNLocator(10))  # Max number of labels in y axis
        #fig1.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis

        x = list(result.columns)  # x labels (quarter date)
        x_temp = np.arange(len(x))  # For bar chart's offset
        #x = [1,2,3,4,5,6,7,8]

        
        Liabilities = result.loc['Liabilities', :] if IS_ENGLISH else result.loc['總負債', :]
        Equity = result.loc["Total stockholder's equity", :] if IS_ENGLISH else result.loc['股東權益', :]
        Investment = result.loc["Total investment", :] if IS_ENGLISH else result.loc['總投資', :]
        #Investment = pd.Series([1000000] * 8, dtype = "float64")
        Risk_Weighted_Assets = result.loc["Risk weighted assets", :] if IS_ENGLISH else result.loc['風險性資產總額', :]
        #Risk_Weighted_Assets = pd.Series([np.nan] * 8, dtype = "float64")

        plt.bar(x_temp - 0.2, Liabilities, color='blue',label='Liabilities' if IS_ENGLISH else '總負債', width=0.5, zorder=3)
        plt.bar(x_temp - 0.2, Equity,color='green',label="Total stockholder's equity" if IS_ENGLISH else '股東權益', width=0.5, bottom=Liabilities, zorder=3)
        plt.bar(x_temp, Investment, color='orange',label="Total investment" if IS_ENGLISH else '總投資', width=0.5, zorder=3) if (not Investment.isna().all()) else None
        plt.bar(x_temp + 0.2, Risk_Weighted_Assets,color='red',label="Risk weighted assets" if IS_ENGLISH else '風險性資產總額', width=0.4, zorder=3) if (not Risk_Weighted_Assets.isna().all()) else None
        plt.xticks(x_temp, x)
        
        plt.title("Company's Balance\n(" + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title("公司負債與股東權益\n(" + company_name + ")", fontsize=18)
        
        plt.xticks(rotation=45)
        plt.ylabel('USD')
        plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')
        plt.grid(axis='y')
        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Liabilities and Stockholder's equity.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()
        
        # Break point
        if(stop_flag.is_set()):
            return None
        
#         # Figure 2: Loans composition (if having loans)
#         Total_loans = result.loc['Total loans', :]
#         if (not Total_loans.isna().all()):
#             fig2 = plt.subplot(111)
#             fig2.yaxis.set_major_locator(MaxNLocator(10))  # Max number of labels in y axis
            
#             Allowance_for_loans_and_lease_losses = result.loc['Allowance for loan and lease losses', :]
#             Nonperforming_loans = result.loc['Non-performing loans', :]
#             Performing_loans = Total_loans + Allowance_for_loans_and_lease_losses - Nonperforming_loans
            
#             plt.bar(x, Performing_loans, color='blue',label='Performing loans', width=60, zorder=3) if (not Performing_loans.isna().all()) else None
#             plt.bar(x, Nonperforming_loans,color='green',label="Non-performing loans", width=60, bottom=Performing_loans, zorder=3) if (not Nonperforming_loans.isna().all()) else None
#             plt.bar(x, -Allowance_for_loans_and_lease_losses, color='orange',label="Allowance for loan and lease losses", width=60, zorder=3) if (not Allowance_for_loans_and_lease_losses.isna().all()) else None
            
#             plt.title("Loans' composition\n(" + company_name + ")", fontsize=18)
#             plt.xticks(rotation=45)
#             plt.ylabel('Million USD')
#             plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')
#             plt.grid(axis='y')
#             plt.show()
            
#         else:
#             pass
        
        
        # Figure 2: Cash flow stacked barchart
        fig2 = plt.subplot(111)
        fig2.yaxis.set_major_locator(MaxNLocator(10)) # Max number of labels in y axis
        #fig2.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis
        
        operating =  result.loc['Net cash from operating activities', :] if IS_ENGLISH else result.loc['營業活動現金流量', :]

        investing = result.loc['Net cash from investing activities', :] if IS_ENGLISH else result.loc['投資活動現金流量', :]

        financing = result.loc['Net cash from financing activities', :] if IS_ENGLISH else result.loc['融資活動現金流量', :]

        plt.bar(x_temp, operating, color='blue', label='Net cash from\noperating activities' if IS_ENGLISH else '營業活動現金流量', width=0.5, zorder=3)

        # Stack upward or downward depends on the sign of value. Downward for negative values
        # Reference: https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.bar.html
        baseline = []



        # Setting baseline for stacking investing values
        for idx in range(len(result.columns)):
            if(investing[idx] < 0):
                if(operating[idx] < 0):
                    baseline.append(operating[idx]) 
                else:
                    baseline.append(0) 
            else:
                if(operating[idx] < 0):
                    baseline.append(0) 
                else:
                    baseline.append(operating[idx]) 


        plt.bar(x_temp, investing, color='green',label='Net cash from\ninvesting activities' if IS_ENGLISH else '投資活動現金流量', width=0.5, zorder=3, bottom=baseline)

        baseline2 = []
        for idx in range(len(result.columns)):

            # Same sign of investing value and financing value (++ or --)
            if(investing[idx]*financing[idx] >= 0):
                if(operating[idx]*investing[idx] >= 0):                    
                    baseline2.append(investing[idx] + operating[idx])
                else:
                    baseline2.append(investing[idx])

            # Different sign of investing and financing value (+- or -+)
            else:

                # Same sign of investing value and operating value (++ or --)
                if(operating[idx]*investing[idx] >= 0):
                    baseline2.append(0)
                    #print('second')

                # Different sign of investing and operating value (+- or -+)    
                else:
                    baseline2.append(operating[idx])
                    #print('third')
                    #print(operating[idx]*investing[idx])

        plt.bar(x_temp, financing, color='gray', label='Net cash from\nfinancing activities' if IS_ENGLISH else '融資活動現金流量', width=0.5, zorder=3, bottom=baseline2)

        plt.title('Cash flows\n(' + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title('現金流量\n(' + company_name + ")", fontsize=18)
        plt.xticks(rotation=45)
        plt.xticks(x_temp, x)
        plt.ylabel('USD')
        plt.legend(bbox_to_anchor=(1.02, 0.7), loc='upper left')
        plt.grid(axis='y')
        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Cash flows.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()
        
        
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        
        # Figure 3: Operating circumstance
        fig3 = plt.subplot(111)
        fig3.yaxis.set_major_locator(MaxNLocator(10)) # Max number of labels in y axis
        plt.xticks(rotation=45)  # Need to place this setting before plotting or interpreter will confuse
        plt.grid(True, axis='y', zorder = 0)

        revenue = result.loc['Revenue', :] if IS_ENGLISH else result.loc['營業收入', :]
        gross_profit = result.loc['Gross Profit', :] if IS_ENGLISH else result.loc['毛利', :]
        net_income = result.loc['Net income', :] if IS_ENGLISH else result.loc['淨收入', :]
        comprehensive_income = result.loc['Comprehensive income net of tax', :] if IS_ENGLISH else result.loc['綜合收入', :]
        other_income = comprehensive_income - net_income
        
        nonperforming_loans_ratio = result.loc["Non-performing loans ratio (%)", :] if IS_ENGLISH else result.loc['逾期放款比率 (%)', :]
        capital_adequacy_ratio = result.loc["Capital adequacy ratio (%)", :] if IS_ENGLISH else result.loc['資本適足率 (%)', :]
        coverage_ratio = result.loc["Coverage ratio (%)", :] if IS_ENGLISH else result.loc['備抵呆帳覆蓋率 (%)', :]

        x_temp = np.arange(len(x))

        br1 = plt.bar(x_temp - 0.2, revenue, color='blue',label='Revenues' if IS_ENGLISH else '營業收入', width=0.6, zorder=3)
        br2 = plt.bar(x_temp - 0.2, gross_profit, color='green',label='Gross profit' if IS_ENGLISH else '毛利', width=0.6, zorder=3)  if (not gross_profit.isna().all()) else None
        br3 = plt.bar(x_temp - 0.2, net_income, color='orange',label='Net income' if IS_ENGLISH else '淨收入', width=0.6, zorder=3, alpha = 1)
        br4 = plt.bar(x_temp + 0.2, other_income, color='brown',label='Other income' if IS_ENGLISH else '其他收入', width=0.4, zorder=3, alpha = 1)



        # Double y axes
        fig3_1 = fig3.twinx()
        ln1 = fig3_1.plot(x_temp, nonperforming_loans_ratio, color='red', marker='D',label='Non-performing\nloans ratio' if IS_ENGLISH else '逾期放款比率') if (not nonperforming_loans_ratio.isna().all()) else None
        ln2 = fig3_1.plot(x_temp, capital_adequacy_ratio, color='purple', marker='D',label='Capital adequacy\nratio' if IS_ENGLISH else '資本適足率') if (not capital_adequacy_ratio.isna().all()) else None
        ln3 = fig3_1.plot(x_temp, coverage_ratio, color='pink', marker='D',label='Coverage ratio' if IS_ENGLISH else '備抵呆帳覆蓋率') if (not coverage_ratio.isna().all()) else None
        #ln3 = None (for test)
        
        plt.xticks(x_temp, x)

        plt.title("Operating circumstances\n(" + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title("營運狀況\n(" + company_name + ")", fontsize=18)

        #plt.ylabel('Million USD')


        fig3.set_ylabel('USD')
        fig3_1.set_ylabel('%')

        #print(type(br1))

        #brs_lns = br1 + br2 + br3 + br4 + ln1
        #brs_lns = list(br1) + ln1
        brs_lns = [br1, br3, br4] + (ln1 if ln1 else []) + (ln2 if ln2 else []) + (ln3 if ln3 else [])
        if br2:
            #pass
            #print("br2 is None")
            brs_lns.append(br2) 
        else:
            pass
        
        
        #labels = [bl.get_label() for bl in brs_lns]
        plt.legend(handles = brs_lns, bbox_to_anchor=(1.2,0.7), loc='upper left')
        #plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')

        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Operating circumstances.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()
        
        
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        
        # Figure 4: Competitiveness
        gross_margin = result.loc["Gross margin (%)", :] if IS_ENGLISH else result.loc["毛利率 (%)", :]
        operating_margin = result.loc['Operating margin (%)', :] if IS_ENGLISH else result.loc["營業利益率 (%)", :]
        net_income_margin = result.loc['Net income margin (%)', :] if IS_ENGLISH else result.loc["稅後淨利率 (%)", :]


        fig4 = plt.subplot(111)
        fig4.yaxis.set_major_locator(MaxNLocator(10))
        #fig4.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis

        fig4.plot(x_temp,gross_margin,color='blue', marker='o',label='Gross margin (%)' if IS_ENGLISH else "毛利率 (%)") if (not gross_margin.isna().all()) else None
        fig4.plot(x_temp,operating_margin,color='green', marker='o',label='Operating margin (%)' if IS_ENGLISH else "營業利益率 (%)") if (not operating_margin.isna().all()) else None
        fig4.plot(x_temp,net_income_margin,color='orange', marker='o',label='Net income margin (%)' if IS_ENGLISH else "稅後淨利率 (%)")

        fig4.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')
        fig4.grid(axis='y')
        plt.xticks(rotation=45)
        plt.xticks(x_temp, x)
        plt.title('Competitiveness\n(' + company_name + ')', fontsize=18) if IS_ENGLISH else plt.title('競爭力\n(' + company_name + ')', fontsize=18)
        fig4.set_ylabel('%')
        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Competitiveness.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()
        
        
        # Break point
        if(stop_flag.is_set()):
            return None
        
        
        
        # Figure 5: Investment return
        fig5 = plt.subplot(111)
        fig5.yaxis.set_major_locator(MaxNLocator(10))
        #fig5.xaxis.set_major_locator(MaxNLocator(len(result.columns)))  # Max number of Labels in x axis
        plt.xticks(rotation=45)

        earning_per_share_basic = result.loc['Earning per share basic', :] if IS_ENGLISH else result.loc["基本每股盈餘", :]
        earning_per_share_diluted = result.loc['Earning per share diluted', :] if IS_ENGLISH else result.loc["稀釋每股盈餘", :]
        return_on_assets = result.loc['Return on assets (%)', :] if IS_ENGLISH else result.loc["資產報酬率 (%)", :]
        return_on_equity = result.loc['Return on equity (%)', :] if IS_ENGLISH else result.loc["股東權益報酬率 (%)", :]

        ln1 = plt.plot(x_temp,earning_per_share_basic,color='blue', marker='o',label='Earning per share\n(basic)' if IS_ENGLISH else "基本每股盈餘")
        ln2 = plt.plot(x_temp,earning_per_share_diluted,color='green', marker='o',label='Earning per share\n(diluted)' if IS_ENGLISH else "稀釋每股盈餘")


        # Double y axes
        fig5_1 = fig5.twinx()
        ln3 = fig5_1.plot(x_temp, return_on_assets, color='orange', marker='D',label='Return on assets' if IS_ENGLISH else "資產報酬率 (%)")
        ln4 = fig5_1.plot(x_temp, return_on_equity, color='brown', marker='D',label='Return on equity' if IS_ENGLISH else "股東權益報酬率 (%)")

        plt.xticks(x_temp, x)

        plt.title("Investment return\n(" + company_name + ")", fontsize=18) if IS_ENGLISH else plt.title("投資回報\n(" + company_name + ")", fontsize=18)




        fig5.set_ylabel('EPS (USD)')
        fig5_1.set_ylabel('Return (%)')

        #print(type(br1))

        #brs_lns = br1 + br2 + br3 + br4 + ln1
        #brs_lns = list(br1) + ln1
        lns = ln1 + ln2 + ln3 + ln4
        #labels = [bl.get_label() for bl in brs_lns]
        plt.legend(handles = lns, bbox_to_anchor=(1.2,0.7), loc='upper left', fontsize = "8")
        #plt.legend(bbox_to_anchor=(1.02,0.7), loc='upper left')

        plt.grid(axis='y')

        #plt.show()
        file_name = folder_name + "\\" + str(current_date) + re.sub(r'[\\\/:\*\?"<>\|\.]', '', company_name) + "_Investment return.png"
        plt.tight_layout()
        plt.subplots_adjust(left = 0.1, right = 0.6)
        plt.savefig(file_name)
        plt.close()
        
        
        # Break pointa
        if(stop_flag.is_set()):
            return None
        
        
        
        # Save the financial statements as .csv
        result.to_csv(folder_name + "\\" + "Financial Statements.csv", encoding = "utf-8")
        
        update_msg("Financial statements and their visualization are saved successfully!" if IS_ENGLISH else "財報圖表已成功儲存完畢！")
        #print("plot_data的folder_name:", folder_name)
        return (folder_name, company_name)
        
        
    else:
        update_msg("Unknown industry type" if IS_ENGLISH else "未知的產業類別？")
        return None
    




    # from ME_American_Stock_Analysis_v1_3 import SearchThread
# from ME_American_Stock_Analysis_v1_3 import get_source
# from ME_American_Stock_Analysis_v1_3 import extract_from_reports
# from ME_American_Stock_Analysis_v1_3 import check_industry_type
# from ME_American_Stock_Analysis_v1_3 import plot_data
# import threading
# from ME_American_Stock_Analysis_v1_3 import *

# 登入系統
# ety_user.insert("TEST")
# ety_pwd.insert("0000")
# login()

# from multiprocessing import Pool


# 測試需用時多久
start = datetime.now()
print("開始時間:", start)

test_list = all_type_pages["公用事業"]
stop_flag = threading.Event()
IS_ENGLISH = True

   
        
        
        
    
# def testt(a, b, c):
#     print(a,b,c)
#     time.sleep(1)

    
# Pool(3) 建立共3個processes -> 在Jupyter上似乎無法用multiprocessing!
# with Pool(2) as pool:
#     for abbr in test_list[590:600]: 
#         pool.apply_async(  # 將函數與參數加到queue中
#             testt,
#             (abbr, 8, "Majaja"),
#             {}
#         )
        
    
#     pool.close()  # 表示沒有資料要再加到queue中
#     print("Queue加入完成")
#     pool.join()  # 所有工作開始執行
#     print('執行開始')
    
#specific_test = ("IMKTA",)
count = 0
# browser = None
 

# 匯入找美股目標.xlsx
df_target = pd.read_excel("2023-08-31找美股目標__食品飲料.xlsx", index_col=0)  # , index_col=0
# print(df_target.info())
# print("??")

# 初步篩選: 低於MA20的值15%以上 + 股價高於20
df_target_filter = df_target[(df_target["Differenciate ratio(%)"] <= -15) & (df_target["Current Price"] >= 20)]
# print(df_target_filter)
list_to_be_process = df_target_filter.index.to_numpy()

def extract_abbr(x):
    return re.search(r"\(\w+\)", x).group()[1:-1]

extract_abbr_v = np.vectorize(extract_abbr)
array_to_be_process = extract_abbr_v(list_to_be_process)
print(len(array_to_be_process))

# print("開始取得目標清單之財報資料 ...")
# for abbr in array_to_be_process: 
#     try:
#         #target_stock = input("Please enter stock name: ")
#         #get_source(self.com_name, self.stop_flag):
#         temp_source = get_source(abbr, 8, stop_flag)
#         #count += 1
#         #print("第" + str(count) + "家")

#         if temp_source:
#             reports, company_name = temp_source
            
#             # Check industry type
#             industry_type = check_industry_type(reports[0][0])
#             #print(industry_type)

#             # Extract data and build dataframe
#             result = extract_from_reports(reports, industry_type, company_name, stop_flag)
#             #display(result)

#             # Extract data and visualize them. Fianlly save them as .png and .csv under a folder named by the search date and the company's name
#             folder_name, company_name = plot_data(result, industry_type, company_name, stop_flag)



#         else:
#             pass
#         #print("Step 1 completed!")
        


# #         target_stock = ""




#     except Exception as e:
#         #print("Stop the program ...")
#         #update_msg("Stop the program ...")
#         update_msg(str(e))
        
#         continue
        
#     finally:
#         count += 1
#         print("處理完", count, "筆資料")
    

    
# # 測試需用時多久
# end = datetime.now()
# print("結束時間:", end)
# print("處理了" + str(count) + "筆資料, 總共用時: ", end - start, ", 平均一筆資料處理時間: ", (end - start) / count)